%define ver @VERSION@
%define name @PACKAGE@

Summary: Gives users of the GNOME Desktop a user friendly way of keeping
in touch with their friends.
Name: %name
Version: %ver
Release: imendio.1
Source: %{name}-%{ver}.tar.gz
License: GPL
Group: Applications/System
BuildRoot: %{_tmppath}/%{name}-root

BuildRequires: gtk2-devel >= @GTK_REQUIRED@
BuildRequires: libglade2-devel >= @LIBGLADE_REQUIRED@
BuildRequires: desktop-file-utils >= @DESKTOP_FILE_UTILS_REQUIRED@
%description
Gossip is a Jabber instant messaging program.
%prep
%setup -q

%build
%configure
make

%install
rm -rf $RPM_BUILD_ROOT

export GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1
%makeinstall
unset GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL

desktop-file-install --vendor gnome --delete-original       \
  --dir $RPM_BUILD_ROOT%{_datadir}/applications             \
  --add-category X-Red-Hat-Extra                            \
  $RPM_BUILD_ROOT%{_datadir}/applications/*

%find_lang %{name}

%clean
rm -rf $RPM_BUILD_ROOT

%post
export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
gconftool-2 --makefile-install-rule %{_sysconfdir}/gconf/schemas/gossip.schemas > /dev/null

%files -f %{name}.lang
%defattr(-,root,root)

%doc AUTHORS COPYING ChangeLog NEWS README

%{_bindir}/*
%{_datadir}/applications
%{_datadir}/gossip/*
%{_sysconfdir}/gconf/schemas/*

%changelog
* Sat Jun 28 2003 Richard Hult <richard@imendio.com>
- Initial build.


