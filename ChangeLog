2006-02-11  Martyn Russell  <martyn@imendio.com>

	* protocols/jabber/gossip-jabber-vcard.c:
	* protocols/jabber/gossip-jabber.c: 
	- Fixed _get_vcard() to get own contact vcard if no GossipContact
	is supplied instead of failing miserably with no warning.

2006-02-11  Martyn Russell  <martyn@imendio.com>

	* protocols/jabber/gossip-jabber-ft.c: 
	* protocols/jabber/gossip-jabber-vcard.c:
	* protocols/jabber/gossip-jabber.[ch]: 
	- Fixed a bug from the work just committed where the vcard for
	every contact on a roster was requested.
	- Fixed the name used in chat from full name to fall back to names
	in this order: nickname, name, name part of JID.
	
	* src/gossip-new-account-window.c: 
	* ui/connect.glade:
	- Make the account id (JID) entry wider in the accounts dialog so
	it is more likely to fit with the resource id.

2006-02-11  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-protocol.[ch]:
	- Added support for _is_valid_username(), _get_example_username(),
	_get_default_server() and _get_default_port().

	* libgossip/gossip-session.[ch]:
	- Get own nickname from the protocol not just the first one in the
	list of protocols for the session.
	
	* libgossip/gossip-utils.[ch]:
	* src/gossip-accounts-dialog.c: 
	* src/gossip-add-contact-window.c:
	* ui/connect.glade:
	- Removed ALL notations of Jabber, specifically gossip_jid_get_()
	functions and port details.
	
	* protocols/jabber/gossip-jabber-chatrooms.c:
	* protocols/jabber/gossip-jabber-ft.c:
	- Fixed unnecessary warnings when cleaning up GossipJabber objects.
	
	* protocols/jabber/gossip-jabber-vcard.c:
	- Updated to use already available types in
	libgossip/gossip-async.[ch] instead of reinventing the wheel. 
	
	* protocols/jabber/gossip-jabber.c:
	- Cleaned up in places.
	- Implemented new functions in libgossip/gossip-protocol.[ch].
	- Added support for requesting new or unknown contact vcards for
	use chat windows, etc. 
	- Added support for requesting own vcard on every connect to use
	in chat windows. Fixes 131290 (Michal Janeczek).

	* protocols/jabber/gossip-jid.[ch]: 
	- Moved the gossip_jid_string_() functions in here from
	libgossip/gossip-utils.[ch].  

	* src/Makefile.am:
	* src/gossip-register.[ch]:
	- Removed src/gossip-register.[ch], they are no longer used.
	
	* src/gossip-account-button.[ch]: 
	- Fixed the broken tooltip so that it now displays (some would say
	it is still broken due to its uglyness *cough* Richard *cough*) :P 
	- Added API to get the account associated with this object.

	* src/gossip-app.c:
	- Fixed the GossipAccountButton toolbar so it now doesn't crash in
	conditions when it needs to rearrange the buttons.
	
	* src/gossip-chat-manager.[ch]:
	* src/gossip-chat-view.c:
	* src/gossip-chat.[ch]:
	* src/gossip-group-chat.c:
	* src/gossip-log.[ch]:
	* src/gossip-private-chat.[ch]: (gossip_private_chat_init),
	- Own contact is now passed when creating the private chat object,
	so we now have a real reference to ourselves for proper nicknames
	in chat windows (instead of being based on the Jabber ID).

	* src/gossip-new-account-window.[ch]:
	* ui/main.glade:
	- Added a page for the account name (as in the toolbar).
	- Added a page for progress when registering (instead of dialogs).
	- The server and port can now be set indepentantly of the account
	id which is now a FULL account id, for example,
	someone@somewhere.org/resource. Fixes #321569 (Brian Pepple).
	- Added a password entry so we don't prompt the user with another
	dialog for it when trying to register.

	* src/gossip-new-message-dialog.c:
	- Added a GossipAccountChooser for sending messages so it doesn't
	just pick the first one connected in GossipSession.

2006-01-25  Martyn Russell  <martyn@imendio.com>

	* src/gossip-account-button.[ch]:
	* src/gossip-app.c: 
	* ui/main.glade:
	- Updated the account buttons so they now are divided into two
	groups, the first group is enabled accounts which show the icon
	AND the text horizontally, the second group is disabled accounts
	which JUST show the icon. 
	- Use a separator to divide enabled/disabled accounts.
	- Fixed an implementation detail so that the items are not
	GtkButton's inside GtkToolItem's, they are now just
	GtkToggleToolButtons so now we get a drop down arrow button when
	accounts don't fit the width of the window, which is cool.  

2006-01-20  Johan Dahlin  <johan@gnome.org>

	* src/gossip-presence-chooser.c: (presence_chooser_add_item):
	Set ellipsize on the label in the menu aswell.
	
2006-01-18  Martyn Russell  <martyn@imendio.com>

	* protocols/jabber/gossip-jabber-chatrooms.c:
	- Fixed group chat join message handler to clean up properly and
	allow other message handlers to see presence messages.

2006-01-18  Martyn Russell  <martyn@imendio.com>

	* src/gossip-account-button.[ch]:
	- Fixed the button part so that it is a derived from a
	GtkToggleButton and remains toggled until the menu is hidden.
	This means the account button feels like the menu is part of it,
	not some side effect by some second rate coder :)

2006-01-18  Martyn Russell  <martyn@imendio.com>

	* libgossip/libgossip-marshal.list:
	* libgossip/gossip-chatroom-manager.[ch]:
	- Pass the session when creating a new object so we can add
	"protocol-connected" signal hooks for auto joining chat rooms. 
	- New signal "chatroom-auto-connected" created.
	
	* libgossip/gossip-chatroom-provider.[ch]:
	- Added some convience functions for i18n translations on
	GossipChatroomJoinResult. 

	* libgossip/gossip-chatroom.[ch]: 
	- Added properties and functions for the chat room status.
	
	* libgossip/gossip-session.c:
	- Fixed not accepting NULL for one or more parameters in
	gossip_session_count_accounts().
	
	* protocols/jabber/gossip-jabber.c:
	* protocols/jabber/gossip-jabber-chatrooms.[ch]:
	- Fixed a whole bunch of stuff here, making sure that the callback
	is called in every error condition so the caller gets some
	response and cleaning up properly.

	* src/Makefile.am:
	* src/gossip-chat-window.[ch]:
	- Added in favour of gossip-chatrooms-dialog.[ch]

	* src/gossip-chat-dialog.[ch]:
	- Removed.

	* src/gossip-app.c: 
	- Added code to handle auto-join signal from the chatroom manager.
	
	* src/gossip-account-button.c:
	* src/gossip-account-chooser.c:
	* src/gossip-accounts-dialog.c:
	* src/gossip-add-contact-window.c:
	* src/gossip-chat-view.c:
	* src/gossip-chat.c: 
	* src/gossip-chatrooms-dialog.c:
	* src/gossip-contact-info-dialog.c:
	* src/gossip-contact-list.c:
	* src/gossip-group-chat.c:
	* src/gossip-new-message-dialog.c:
	* src/gossip-presence-chooser.c:
	* src/gossip-private-chat.c:
	* src/gossip-ui-utils.[ch]:
	- Added function to get pixbuf from GossipChatroom state.
	- Changed the function stub to not include _ui_utils because
	functions were getting too long.

	* src/gossip-stock.[ch]:
	- Added GOSSIP_STOCK_GROUP_MESSAGE for the group chat icon, now
	also used in the join group chat window.
	
	* ui/group-chat.glade:
	- New and improved :) chat room window.
	- Fixes bug #325841 (Martyn, Ross Burton).

2006-01-14  Chao-Hsiung Liao  <j_h_liau@yahoo.com.tw>

	* configure.ac: Added "zh_HK" to ALL_LINGUAS.
	
2006-01-08  Martyn Russell  <martyn@imendio.com>

	* src/gossip-group-chat.c (group_chat_get_status_pixbuf): 
	- Fixed static gossip-group-message.png lookup and made it a stock
	item since it is used in a couple of places.

2006-01-08  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-chatroom-manager.c:
	(gossip_chatroom_manager_get_chatrooms):
	- Fixed variable initialisation error.

2006-01-08  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-account.c:
	* libgossip/gossip-chatroom-manager.[ch]:
	* libgossip/gossip-chatroom.[ch]:
	* libgossip/gossip-chatroom.dtd:
	* src/gossip-app.c: 
	* src/gossip-chatrooms-dialog.c:
	* ui/group-chat.glade:
	- Every chat room is now associated with an account instead of
	being available across ALL accounts. This is the first step
	towards auto connecting group chats on startup, next is a GUI
	update. 

2006-01-07  Martyn Russell  <martyn@imendio.com>

	* src/gossip-group-chat.c: (group_chat_finalize):
	- Make sure we clean up all signals.
	- Fixes bug #325740.

2006-01-02  Richard Hult  <richard@imendio.com>

	* src/gossip-chat.c: (gossip_chat_should_highlight_nick): Fix
	crash.

2005-12-31  Brian Pepple  <bdpepple@ameritech.net>

	* help/C/gossip.xml:
	- Updated help documentation to reflect the latest GUI changes.
	- Fixes bug #325378 (Brian Pepple).

2005-12-30  Martyn Russell  <martyn@imendio.com>

	* src/gossip-app.c:
	* ui/main.glade:
	- Made the show/hide contact list a toggle based check menu item
	in the notification area. 
	- Added the same check menu item into the main menu (Chat->Show
	Contact List) so it is configurable without the need of a
	notification area.
	- Fixes bug #308041 (Radomir Dopieralski).

2005-12-30  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-session.c: 
	- Only send "composing" notification from the account a contact is
	attached to instead of from every connected account.
	- Fixes bug #321801 (Ross Burton).

2005-12-30  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-presence.c: 
	- Return NULL resource instead of "" on error or if not set.
	
	* protocols/jabber/gossip-jabber-ft.c:
	- Make sure NULL resource is handled.

	* protocols/jabber/gossip-jabber.c:
	- When creating GossipContact's include the resource in the ID.

	* src/gossip-chat-manager.c:
	* src/gossip-group-chat.c:
	* src/gossip-private-chat.[ch]: 
	- Cleaned up the code and fixed some memory leaks along the way.
	- Handle private chats from group chat roster.
	- Fixes bug #319713 (Ross Burton).

2005-12-29  Martyn Russell  <martyn@imendio.com>

	* src/gossip-vcard-dialog.c: 
	- Make sure we look up the first vcard selected in the
	GossipAccountChooser. 
	- Fixes bug #325258 (Brian Pepple).

2005-12-29  Martyn Russell  <martyn@imendio.com>

	* src/gossip-contact-info-dialog.[ch]:
	* ui/main.glade:
	- Reworked the code here, no need for the contact info dialog to
	be a type in its own right as it was since nothing outside uses
	it.
	- Added resource states into the contact info dialog.
	- Fixes bug #141225 (jon@tgpsolutions.com).

	* src/gossip-chat-window.c:
	* src/gossip-contact-list.c
	- Updated API to call _show() instead of _new().

2005-12-29  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-chatroom-provider.[ch]:
	* protocols/jabber/gossip-jabber-chatrooms.[ch]:
	* protocols/jabber/gossip-jabber.c: 
	- Changed _set_title to _change_topic.
	* src/gossip-group-chat.c: 
	- Hook up the "/topic" command with the _change_topic function.

	* NEWS:
	- Added all the bugs fixes and all the major changes for the next
	release that we do.

2005-12-29  Martyn Russell  <martyn@imendio.com>

	* src/gossip-chat-view.c: 
	* src/gossip-chat.[ch]: 
	* src/gossip-group-chat.c: 
	* src/gossip-private-chat.c:
	- Made gossip_chat_should_play_sound() public so it can be used by
	private chat and group chat modules. 
	- Made gossip_chat_should_highlight_nick() public so it can be
	used from inside the gossip-chat-view.c and from the group chat
	module.
	- Play sound when our nick is mentioned in group chat
	conversations.

2005-12-18  Richard Hult  <richard@imendio.com>

	* Makefile.am:
	* omf.make: Fix build and distcheck.

2005-12-04  Martyn Russell  <martyn@imendio.com>

	* src/gossip-new-message-dialog.c
	- If there is only one contact after the filter, select it. 
	- Chat with contact on "row-activated" signal from treeview.

2005-12-04  Martyn Russell  <martyn@imendio.com>

	* src/Makefile.am:
	* src/gossip-app.c:
	* src/gossip-contact-list.c:
	* src/gossip-new-message-dialog.[ch]:
	* ui/main.glade:
	- Fixed a crasher when using the combo box in the new message
	dialog which was in GossipApp and has now been moved into
	gossip-new-message-dialog.[ch].
	- The new message dialog is a new implementation which lists all
	your contacts and filters based on the text you put into the entry
	box. This can be used to list everyone on "jabber.org" OR everyone
	with the name "Martyn".
	- Fixes bug #322775 (Brian Pepple).

	* src/gossip-app.c:
	* src/gossip-contact-list.c:
	- Cleaned up in places.	

2005-12-03  Martyn Russell  <martyn@imendio.com>

	* src/gossip-subscription-dialog.c:
	* ui/main.glade:
	- Allow the name and group to be customisable when receiving a
	subscription request from another contact instead of using the
	VCard name and no group.
	- Fixes bug #323099 (Maciej Katafiasz).

2005-12-01  Martyn Russell  <martyn@imendio.com>

	* src/gossip-chatrooms-dialog.c
	(chatrooms_dialog_chatrooms_setup): 
	- Remember to set the entry details when setting up the chatrooms
	for the first time.  This was broken meaning you would have to
	select a room before it would fill the details in.

	* src/gossip-galago.c (galago_contact_removed_cb): 
	- Added test to avoid unnecessary warnings.

	* protocols/jabber/gossip-jabber-ft.c:
	- Fixed using g_object_[un]ref on an LmConnection, this was
	causing GLib-GObject-CRITICAL messages on startup.

2005-11-29  Martyn Russell  <martyn@imendio.com>

	* src/gossip-transport-accounts-window.c:
	- Fixed translation bug, now ngettext is used.
	- Patch by Gabor Kelemen, fixes #305103 (Gabor Kelemen).

2005-11-29  Martyn Russell  <martyn@imendio.com>

	* configure.ac: 
	- Fixed build when including dbus and galago, patch by Brian
	Pepple, this fixes bug #322712 (Brian Pepple).

2005-11-29  Martyn Russell  <martyn@imendio.com>

	* src/gossip-account-chooser.[ch]: 
	- More specific about what we include (i.e. not all of GTK).  

2005-11-29  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-chatroom-manager.c:
	* libgossip/gossip-chatroom.c:
	* protocols/jabber/gossip-jabber-ft-utils.c:
	* protocols/jabber/gossip-jabber-ft.c:
	* protocols/jabber/gossip-jabber.c:
	* src/gossip-account-button.c:
	* src/gossip-contact-list.c:
	* src/gossip-ft-window.c:
	- Disabled debugging.

	* src/Makefile.am:
	* src/gossip-add-contact-window.c:
	* src/gossip-chatrooms-dialog.c:
	* src/gossip-vcard-dialog.c:
	* ui/group-chat.glade:
	* ui/main.glade:
	- Added GossipAccountChooser.
	- The GossipAccountChooser is used when adding contacts, changing
	personal information and when joining a chatroom, it is derived
	from a GtkComboBox but handles accounts connecting/disconnecting,
	name changes and being added or removed all dynamically.
	
	* src/gossip-galago.c:
	- Fixed some memory leaks.

	* libgossip/gossip-session.[ch]: 
	* src/gossip-app.c: 
	- Fixed gossip_session_count_accounts() API.

	* src/gossip-chatrooms-dialog.c: 
	- Don't show the separator when there is just the "Custom" entry.
	- Add the separator entry when you add the first chatroom.
	- Cleaned up some other minor usability issues.

	* libgossip/gossip-chatroom.dtd: 
	- Fixed so you can have NO chatrooms and it is valid.

2005-11-27  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-event.h:
	- Added File Transfer event type.
	
	* libgossip/Makefile.am:
	* libgossip/gossip-ft.[ch]:
	* libgossip/gossip-ft-provider.[ch]: 
	- Added.

	* libgossip/gossip-protocol.[ch]:
	* libgossip/gossip-session.[ch]:
	* libgossip/libgossip-marshal.list:
	- Added file transfer initiation API.

	* protocols/jabber/gossip-jabber-ft-utils.[ch]:
	* protocols/jabber/gossip-jabber-ft.[ch]:
	- Added.
	
	* protocols/jabber/gossip-jabber-private.h:
	* protocols/jabber/gossip-jabber.[ch]:
	- Added file transfer infrastructure (like the chatroom provider
	work).
	- Use the FULL JID instead of a JID without the resource.  We
	needed this in so many places (after using it for a while it
	didn't seem to break anything :). 

	* protocols/jabber/gossip-jabber-chatrooms.c
	- Now using a ref from own contact on the GossipJabber object
	instead of creating a new GossipContact.

	* src/gossip-contact-list.c:
	- Added context menu item for sending files (currently not visible
	since this is not available yet).
	
	* src/Makefile.am:
	* src/gossip-ft-window.[ch]: 
	- Added, this handles inbound requests so far and shows a dialog
	like the subscription dialog and so far you can only Deny requests.

	* src/gossip-app.c:
	* src/gossip-subscription-dialog.[ch]:
	- Added, this code has been moved out of gossip-app.

	* ui/Makefile.am:
	* ui/file-transfer.glade:
	* ui/file-transfer.gladep:
	- Added for file transfer windows/dialogs.
	
	* ui/main.glade:
	- Use "ID" instead of "Jabber ID" on the subscription dialog.
	- Removed the transport item on the main "Chat" menu.

	* ALL:
	- This adds very basic file transfer initiation support.  
	- That means that you will get a dialog pop up when someone tries
	to send you a file, and you have the chance to deny it ONLY.
	- At present, more work is needed to do the actual file transfer
	back end (SOCKS) work.  
	- You can follow the progress on this by watching bug #141569.  

2005-11-27  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-account.c: 
	* libgossip/gossip-chatroom.c:
	* libgossip/gossip-session.c:
	- Fixed account and chatroom code to use a unique ID for
	hash comparison since using "name" doesn't work because it can
	change and isn't unique.
	- Fixed bug where you connect, change an account name, then can't
	do anything with that account (like disconnect) because the name
	changed and the hash tables were not up to date.
	
	* src/gossip-accounts-dialog.c: 
	* src/gossip-add-contact-window.c:
	* src/gossip-app.c:
	* src/gossip-contact-list.c:
	* src/gossip-group-chat.c:
	* src/gossip-status-presets-dialog.c:
	* src/gossip-transport-accounts-window.c:
	* src/gossip-vcard-dialog.c:
	- Cleaned up my misuse of gtk_tree_model_get () and
	gtk_list/tree_store_set () API.  A lot of GObjects were being
	referenced as I used _set() and not being unreferenced every time
	I did _get().
	- Fixed some other memory leaks along the way, so if anything
	crashes, it is probably my fault :)
	
2005-11-26  Martyn Russell  <martyn@imendio.com>

	* src/gossip-chatrooms-dialog.c:
	* protocols/jabber/gossip-jabber-chatrooms.c:
	- Fixed a crasher by making sure things are properly referenced
	and the join a chatroom loudmouth handler is properly
	cleaned up. 
	
2005-11-24  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-account-manager.c:
	- Switched from hash tables to lists, this is because the hash
	table uses name which changes and cocks everything up (this is not
	finished, the hash table in GossipSession needs to be updated to
	work this way too).

	* libgossip/Makefile.am:
	* libgossip/gossip-chatroom-manager.[ch]:
	- Added.

	* libgossip/gossip-chatroom-provider.h:
	- Move the GossipChatroomId to the GossipChatroom module.

	* libgossip/Makefile.am:
	* libgossip/gossip-chatroom.[ch]:
	* libgossip/gossip-chatroom.dtd:
	- This replaces the old back end (gconf) with the same method we
	are using everywhere else (XML files). 
	- THIS DOES MEAN GROUP CHATS WILL NEED TO BE SET UP AGAIN!

	* src/gossip-app.[ch]:
	- Added chatroom manager object to the stack of other managers.

	* src/gossip-chatrooms-dialog.[ch]:
	- Use gossip_chatroom_() and gossip_chatroom_manager_() APIs.
	- Make the code more efficient to avoid unnecessary disk writes.
	- Fix some issues and probably created a whole load more :)

	* src/Makefile.am:
	* src/gossip-edit-favorite-dialog.[ch]:
	* src/gossip-favorite.[ch]:
	* src/gossip-join-dialog.[ch]:
	- Removed.
	
	* ui/group-chat.glade:
	- An expander is now used to hide the chatroom details unless you
	are configuring a custom room.

2005-11-23  Richard Hult  <richard@imendio.com>

	* src/Makefile.am:
	* src/gossip-theme-manager.[ch]: New files that handles theme
	switching. Just the hardcoded themes for now.

	* src/gossip-chat-view.c: Move the themes from here to the
	manager.

2005-11-22  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: 
	* src/gossip-app.h: Setup a gconf_client here and add a getter for it.
	
	* gossip.schemas.in:
	* src/gossip-chat-view.c:
	* src/gossip-chat-view.h: Add support for using different sets of
	tags in the text view, and clean up the text insertion code.
	
	* src/gossip-group-chat.c:
	* src/gossip-private-chat.c: Adapt to the changes in the chat
	view above.
	
	* src/gossip-main.c: (setup_default_window_icon): Set one default
	icon, not a list.
	(main): Don't setup the gconf client here.
	
	* src/gossip-about.c:
	* src/gossip-chat.c:
	* src/gossip-preferences.c:
	* src/gossip-sound.c:
	* src/gossip-ui-utils.c: Cleanup: use the gconf client in
	GossipApp instead of poking at an external one.

2005-11-22  Richard Hult  <richard@imendio.com>

	* protocols/jabber/gossip-jabber.c (jabber_set_proxy): Don't poke
	at the gconf_client from the app here, create our own.

	* ui/pixmaps/Makefile.am (imagedir): Don't install the smiley
	images now that we use the ones from the icon theme.

2005-11-18  Martyn Russell  <martyn@imendio.com>

	* po/POTFILES.in:
	* src/Makefile.am:
	* src/gossip-add-contact-window.[ch]:
	* src/gossip-add-contact.[ch]:
	- Renamed module to be consistent.

	* src/gossip-app.c:
	* src/gossip-accounts-dialog.[ch]:
	* src/gossip-add-contact-window.[ch]:
	* src/gossip-chat-window.c:
	* src/gossip-new-account-window.[ch]:
	* src/gossip-vcard-dialog.[ch]:
	* ui/main.glade:
	- Fixed usability so that transient parents are used and windows
	are positioned centered on their parents (patch by Christian Neumair).
	- Fixes bug 321538 (Christian Neumair, Martyn Russell).

2005-11-13  Martyn Russell  <martyn@imendio.com>

	* configure.ac: 
	- Added Scrollkeeper dependency since we need it to build the
	help (patch by Brian Pepple).

	* help/C/gossip.xml: 
	- Use entities for app name, etc. 
	- Fix some small errors (patch by Keywan Najafi Tonekaboni).

2005-11-12  Martyn Russell  <martyn@imendio.com>

	* Makefile.am:
	* configure.ac:
	* help/.cvsignore:
	* help/C/.cvsignore:
	* help/C/Makefile.am:
	* help/C/figures/gossip_first_start_window.png:
	* help/C/figures/gossip_roster.png:
	* help/C/gossip-C.omf:
	* help/C/gossip.xml:
	* help/C/legal.xml:
	* help/Makefile.am:
	* src/gossip-app.c:
	* ui/main.glade:
	* xmldocs.make:
	* omf.make:
	- Add Help section using Gnome Help (patch from Brian Pepple).
	- Fixes bug #155140 (Brian Pepple).

2005-11-05  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-session.[ch]:
	* src/gossip-account-button.c:
	* src/gossip-app.c:
	- Used a cleaner API to return the count of accounts enabled/disable
	and connected/disconnected.
	- Used cleaner signaling so instead of "protocol-connecting" with
	a TRUE or FALSE, now we have another signal "protocol-disconnecting". 

	* ui/group-chat.glade:
	- Made the treeview minimum width smaller since Richard said it
	was too big.  Need a better solution for this since for I can see
	1/2 the contact's names and for others it is fine depending on the
	font sizes, etc. 

2005-11-04  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.[ch]:  (gossip_app_net_down), (gossip_app_net_up):
	- Added to test new D-BUS API for pre-net-down and post-net-up.
	- Saves a list of online accounts when pre-net-down is received and 
	  restores them when post-net-up is received.
	* src/gossip-dbus.[ch]: (dbus_handle_pre_net_down),
	(dbus_handle_post_net_up), (dbus_message_func):
	- Added methods for signalling from outside that the net is about to
	  go down and that it's online again.

2005-11-03  Martyn Russell  <martyn@imendio.com>

	* src/gossip-chat-view.c: (chat_view_setup_tags):
	- Trying another variation of the chat colours.

2005-11-02  Martyn Russell  <martyn@imendio.com>

	* src/gossip-ui-utils.[ch]: 
	- Added gossip_ui_utils_get_pixbuf_from_smiley() to get the theme
	smileys instead of using our own packaged up smileys.
	* src/gossip-chat-view.[ch]:
	- Added a whole bunch of new smileys which we use from the
	installed theme, some of these include kiss, confused, angel,
	oooh, lookaway, blush, silly and sick.

	* ui/group-chat.glade:
	- Made the roster treeview a minimum width which works better.

2005-11-02  Ross Burton  <ross@openedhand.com>

	* configure.ac:
	Rename --enable-galago to --with-galago.

	* src/gossip-galago.c:
	Fix presence handling.

2005-11-01  Martyn Russell  <martyn@imendio.com>

	* ui/connect.glade:
	- Some tweaks to the accounts dialog sizing.

2005-11-01  Martyn Russell  <martyn@imendio.com>

	* src/gossip-app.c:
	- Fixed the widgets that are updated by connection so you can
	still do things to accounts that are not enabled but ARE online.
	We have still maintained the fact that the connect and disconnect
	menu items will only operate on enabled accounts.

	* src/gossip-galago.[ch]:
	- Updated init function so we pass GossipSession to it like we do
	the dbus module.
	
2005-11-01  Martyn Russell  <martyn@imendio.com>

	* configure.ac:
	* src/gossip-app.c:
	* src/gossip-galago.[ch]: 
	- Added support for Galago into Gossip (patch by Ross).
	- Tested with "libgalago/tests/get-presence jabber <contact>"
	- Fixes bug #316925 (Ross Burton).

	* libgossip/gossip-session.c:
	* src/gossip-account-button.c:
	* src/gossip-contact-list.c:
	* src/gossip-sound.c:
	- Disabled debugging.

2005-11-01  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-session.[ch]:
	- Added _get_connected_time () API.

	* src/gossip-accounts-dialog.c:
	- Don't include resource label in size group for connection
	labels, server and port.
	* src/gossip-app.c:
	* src/gossip-contact-list.c:
	* src/gossip-sound.[ch]:
	- Don't play online/offline sounds within 10 seconds of the
	account becoming connected.
	- Disable sound when showing/hiding offline contacts.
	- Fixes bug #314848.

2005-11-01  Martyn Russell  <martyn@imendio.com>

	* ui/connect.glade: 
	- Moved the SSL checkbutton to the "Connection" tab in the
	Accounts dialog.
	
	* ui/group-chat.glade: 
	- Removed old edit favourites dialog.

2005-11-01  Martyn Russell  <martyn@imendio.com>

	* libgossip/gossip-account-manager.c:
	* libgossip/gossip-account.[ch]:
	* libgossip/gossip-account.dtd:
	- Implemented "Enabled" property.
	- Added "account-enabled" signal to the manager.
	- Removed the "account-changed" signal from the manager.
	
	* libgossip/gossip-protocol.[ch]:
	* libgossip/gossip-session.[ch]:
	* libgossip/libgossip-marshal.list:
	- Include GossipAccount in protocol-error signal.
	- More powerfull search for accounts dis/connected and enabled.
	- Watch account manager for account_added|removed signals for updates.
	- Clean up logic for dis/connecting accounts.
	- Emit "protocol-connecting" signal (with FALSE) when we
	disconnect. 
	- Removed a lot of unnecessary GOSSIP_IS_PROTOCOL checks in
	GossipSession.
	
	* protocols/jabber/gossip-jabber.c:
	- Added a connect timeout to get around a Loudmouth bug.  If you
	try to connect to port 5222 using SSL, it fails but doesn't error
	it back up the stack.  
	- Don't error after we have requested to disconnect (say on a
	timeout).
	
	* src/Makefile.am:
	* src/gossip-account-info-dialog.[ch]:
	* src/gossip-accounts-window.[ch]:
	- Removed.

	* src/Makefile.am:
	* src/gossip-accounts-dialog.[ch]:
	- Added.

	* src/gossip-ui-utils.[ch]:
	* src/gossip-account-button.c:
	- Update tooltips and include connection state and last error so
	we no longer present the user with an error dialog. 
	- Show a "Stop Connecting" option when in a connecting state. 
	- For errors, compose the error stock image over the theme
	protocol image (in this case always Jabber).

	* src/gossip-app.c:
	- Update the dis/connected widgets on "account-enabled" signal.
	- Use the new gossip_session_count_accounts() API to only show
	connect when there are *enabled* accounts to connect and only show
	disconnect when there are *enabled* accounts to disconnect.
	- Disable the error dialog on "protocol-error" signals.

	* src/gossip-new-account-window.c: 
	- Don't allow the back button when on the first page.
	- Don't allow the back button when it is not a first time
	assistant (which would show the Welcome to Gossip page).
	- Set focus to the server GtkComboBoxEntry on "prepare" signal.

	* src/gossip-spell.c: 
	- Make sure we return a translated string in _get_language_name().

	* src/gossip-accounts-dialog.[ch]:
	* ui/connect.glade:
	- Reworked the accounts dialog to show a list and a notebook so it
	is all configurable from one place.

2005-10-31  Richard Hult  <richard@imendio.com>

	* src/gossip-presence-chooser.c:
	(gossip_presence_chooser_create_menu): Allow 5 presets per status.

	* src/gossip-status-presets.c: Save 15 presets each.

	* ui/main.glade: Make the checkbutton for saving status presets
	disabled by default again.

2005-10-18  Richard Hult  <richard@imendio.com>

	* ui/main.glade: Make "add to list" enabled by default.

2005-10-17  Richard Hult  <richard@imendio.com>

	* ui/connect.glade: Change hscroll policy back to never now that
	the columns aren't resizable.

	* ui/main.glade: Add "add to list" checkbutton for the status
	message dialog.

	* src/gossip-presence-chooser.c (presence_chooser_dialog_response_cb) 
	(presence_chooser_show_dialog): Only save if the user wants to.

2005-10-16  Pawan Chitrakar  <pchitrakar@gmail.com>

	* configure.ac: Added ne in ALL_LINGUAS

2005-10-15  Martyn Russell  <mr@gnome.org>

	* src/gossip-add-contact.c: 
	* src/gossip-join-dialog.c: 
	* src/gossip-vcard-dialog.c:
	* src/gossip-account-button.c:
	* src/gossip-accounts-window.c
	- Use gossip-ui-utils functions to get the IM theme Pixbuf instead
	of repeating the same code.

	* src/gossip-accounts-window.c
	- Sort names.
	- Remove clickable sortable columns, clutters the UI.

	* src/gossip-edit-groups-dialog.c:
	- Sort names.
	
	* ui/main.glade:
	* src/gossip-vcard-dialog.c (gossip_vcard_dialog_show): 
	- Added some polish so we inform the user when details are saved
	with multiple accounts.  
	- Use 'Close' instead of Cancel with multiple accounts.

	* src/gossip-ui-utils.[ch]:
	- Use new code Richard worked on in here.

	* ui/connect.glade:
	- Added correct spacing for new VButtonBox.

2005-10-15  Richard Hult  <richard@imendio.com>

	* ui/connect.glade: Make the hscroll policy automatic again.
	
	* src/gossip-accounts-window.c
	(accounts_window_model_add_columns): Don't make the columns
	resizable.

	* src/gossip-spell.c: Turn debugging off.

	* src/gossip-log.c (gossip_log_show, log_show, our_mkstemps): Make
	the logs have an .html extension to get the mime type detection
	working better and also make the UI look less locked-up while
	transforming.

	* ui/connect.glade:
	* src/gossip-accounts-window.c: Don't edit pixbufs returned from
	the icon theme, plug leak. Only saturate and pixelate when
	needed. Don't use the label contents to decide when to
	connect/disconnect. Add a column for the default property and
	remove the button for that. Make the account name ellipsized, use
	a button box for the buttons.

2005-10-15  Martyn Russell  <mr@gnome.org>

	* libgossip/gossip-session.c:
	- Added signals for "connecting" and "protocol-connecting".
	* src/gossip-account-button.c: (gossip_account_button_init),
	- Moved the code that was setting the status based on
	connected/disconnected signals to here.
	- Added visual effect of flashing when we receive the "connecting"
	signal.
	* ui/main.glade:
	* src/gossip-app.c:
	- Use the GTK stock images for connect/disconnect.
	- Only connect accounts which are set to autoconnect and NOT all
	accounts when clicking Chat->Connect.

2005-10-10  Martyn Russell  <mr@gnome.org>

	* libgossip/gossip-session.c:
	* protocols/jabber/gossip-jabber.c:
	* src/gossip-private-chat.c: 
	- Fixed composing being stuck, was passing GossipContact which is
	not needed by the GossipChat "composing" signal.
	- Turned off debugging.
	- Only signal "composing" if the contact is associated with the
	GossipPrivateChat.

2005-10-09  Martyn Russell  <mr@gnome.org>

	* libgossip/gossip-protocol.c: 
	* libgossip/gossip-session.c: 
	- Make sure composing event is traversed up/down the stack. 
	* protocols/jabber/gossip-jabber-utils.[ch]:
	(gossip_jabber_get_message_is_event),
	(gossip_jabber_get_message_is_composing):
	- Added to identify jabber event notifications.
	* protocols/jabber/gossip-jabber.c: 
	- Added composing feature back.
	- Don't send a new-message event on jabber x events.
	- Fixes bug #316172 (Ross Burton).
	* src/gossip-private-chat.c: 
	- Clean up composing code and removed unused functions.

2005-09-27  Martyn Russell  <mr@gnome.org>

	* src/gossip-app.c:
	* src/gossip-account-button.[ch]:
	* ui/main.glade:
	- Added new widget (based on GtkButton) to deal with accounts and
	their menus.
	- Use a GtkToolbar instead of that monstrosity GtkMenu I did on
	the w/e, I think it looks and works much better.
	- Simplified the code in gossip-app.
	* libgossip/gossip-account.[ch]: 
	- Removed gossip_account_compare() since it did the same as
	_equals(), plus fixed _equals() to return a boolean not a guint,
	this is why using it in hash tables was failing.
	

2005-09-25  Martyn Russell  <mr@gnome.org>

	* src/gossip-app.c:
	* src/gossip-contact-list.c:
	* src/gossip-group-chat.c:
	* src/gossip-presence-chooser.c:
	* src/gossip-private-chat.c: 
	* src/gossip-ui-utils.c:
	* src/gossip-ui-utils.h:
	* ui/main.glade:
	- Moved common code to get the protocol online/offline pixbuf into
	the ui-utils file.
	- Cleaned up the ui-utils API too.
	- Applied parts of a patch by Tommi Komulainen to use a menu for
	each connection shown at the top of the main window (reworked it
	to use a GtkMenu instead of popping up a menu from a normal
	button).  There is no longer a tooltip, so some work is still
	needed to be able to identify the account without using the menu.   
	- Fixes bug #317107 (Tommi Komulainen).

2005-09-24  Martyn Russell  <mr@gnome.org>

	* src/gossip-app.c (app_main_window_key_press_event_cb): 
	- Added shortcut (Escape) to hide main window.
	- Fixes bug #135472 (Edd Dumbill).

2005-09-24  Martyn Russell  <mr@gnome.org>

	* src/gossip-ui-utils.c: 
	- Removed the gossip_option_menu_ functions which are no longer
	used in Gossip. 
	- Fixed bug where double clicking on a contact on the roster would
	show a new chat window but would not present focus to the chat
	window.  This happens if there is already a window and the contact
	is a second, third, etc tab being added.
	- Fixes bug #316340 (Keywan Najafi Tonekaboni)

2005-09-23  Ross Burton  <ross@burtonini.com>

	* configure.ac:
	* src/Makefile.am:
	* src/gossip-chat-window.c:
	Re-apply urgency hint patch from the Gossip 0.8 branch.

2005-09-22  Ross Burton  <ross@burtonini.com>

	* libgossip/gossip-session.c:
	- Added "presence-changed" signal needed for Galago work.
	- Fixes bug #316917 (Ross Burton).

2005-09-18  Tommi Komulainen  <tommi.komulainen@iki.fi>

	* configure.ac:
	* libgossip/Makefile.am:
	* src/Makefile.am:
	- Use `pkg-config` instead of $(shell pkg-config ...) to stop
	autoreconf complaining.
	- Fixes bug #316625 (Tommi Komulainen).

2005-09-18  Martyn Russell  <mr@gnome.org>

	* src/gossip-accounts-window.c:
	* src/gossip-add-contact.c:
	* src/gossip-app.c:
	* src/gossip-join-dialog.c:
	* src/gossip-vcard-dialog.c:
	- As requested by Tommi Komulainen, improved on the
	pixelation/saturation for showing online/offline accounts in
	Gossip.  This was mainly to have a clearer distinction between the
	icons and now things look much better.
	- Fixes bug #316621 (Tommi Komulainen).

2005-09-12  Martyn Russell  <mr@gnome.org>

	* gossip.schemas.in: 
	- Added list of spell checker languages used.
	* src/gossip-chat.c:
	* src/gossip-spell.[ch]:
	- Use multiple languages instead of a singular language to check
	spelling when chatting.  
	* ui/main.glade:
	* src/gossip-preferences.c:
	- Updated to show a list of languages install on the machine which
	the user will choose to check against when chatting.

2005-09-11  Richard Hult  <richard@imendio.com>

	* src/gossip-transport-accounts-window.c:
	* src/gossip-transport-add-window.c:
	* ui/main.glade:
	* ui/transports.glade: Split out unused transport stuff to their
	own glade files so translators don't need to deal with them now.

2005-09-11  Richard Hult  <richard@imendio.com>

	* src/gossip-presence-chooser.c: (presence_chooser_show_dialog),
	(gossip_presence_chooser_create_menu): Get all presets for the
	completion entry, only the most recent 4 for the menu.
	
	* src/gossip-status-presets.c: (gossip_status_presets_get_all),
	(status_presets_file_parse), (status_presets_file_save),
	(gossip_status_presets_get), (gossip_status_presets_set_last):
	* src/gossip-status-presets.h: Add an argument for specifying how
	many presets to get, and allow saving 10 per type instead of 4.

2005-09-06  Martyn Russell  <mr@gnome.org>

	* src/gossip-app.c (app_setup): 
	- Added dbus init, removed this from libgossip.
	- Fixes bug #315181 (Brian Pepple).

2005-09-06  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_accounts_set_status): Unref the icon.

	* src/Makefile.am:
	* src/eggtreemodelfilter.c:
	* src/eggtreemodelfilter.h:
	* src/eel-ellipsizing-label.c:
	* src/eel-ellipsizing-label.h: Remove old unused files.

	* src/eggtrayicon.c:
	* src/eggtrayicon.h: Update from libegg.

	* src/gossip-app.c: (app_setup), (app_accounts_cb):
	* ui/main.glade: Remove the status presets dialog. We can add it
	back if needed, but it needs some work.

2005-09-02  Richard Hult  <richard@imendio.com>

	* src/Makefile.am: Add presence chooser.

	* src/gossip-app.c: Remove lots of code that handles the presence
	chooser button and put it into its own class. Clean up some long
	lines and similar.

	* src/gossip-status-presets.c: Rework a bit to better fit the new
	presence chooser. Remove dups, put the last used one at the top.

	* src/gossip-status-presets.dtd: Don't require statuses to be
	saved, don't use a name property.

	* ui/main.glade: Change to use the new presence chooser.

2005-09-01  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-window.c: (chat_window_invite_menu_setup): Get
	rid of critical warning.
	
	* src/gossip-chat-view.c: (gossip_chat_view_init): Wrap on words
	and chars, instead of just words.

	* src/gossip-chat.c: (gossip_chat_init): Likewise.
	
	* ui/group-chat.glade:
	* src/gossip-group-chat.c: (group_chat_create_gui),
	(group_chat_set_show_contacts): Try to improve the input entry and
	its interaction with the contact list. Now the window doesn't grow
	when you type a lot of text.
	- Fixes bug #153110 (Sven Salzwedel).
	(group_chat_get_tooltip): Use the name as temporary tooltip
	instead of a hardcoded English string.
	(group_chat_setup_tree): Don't use two columns, use one and pack
	the icon and text into it, makes things look better and use less
	space.
	
2005-08-29  Richard Hult  <richard@imendio.com>

	* libgossip/gossip-account-manager.c:
	* src/gossip-contact-groups.c:
	* src/gossip-status-presets.c:  Gah, use BAD_CAST.

2005-08-27  Richard Hult  <richard@imendio.com>

	* configure.ac: Set the libml requirement back to 2.6.16.
	
	* libgossip/gossip-account-manager.c: (account_manager_get_all),
	(account_manager_parse_account), (account_manager_file_parse): Use
	the regular DOM API instead of xmlReader to read the accounts
	XML. Simpplify a bit and do DTD validation and parsing at the same
	time.

	* src/gossip-contact-groups.c: (gossip_contact_groups_get_all),
	(contact_groups_file_parse): As above.
	
	* src/gossip-status-presets.c: (gossip_status_presets_get_all),
	(status_presets_file_parse): As above.

2005-08-27  Mikael Hallendal  <micke@imendio.com>

	* gossip.schemas.in:
	* src/gossip-chat-window.c: (gossip_chat_window_get_default):
	- Modified to give a new window or not depending on the new setting.
	* src/gossip-chat-window.h:
	* src/gossip-chat.c: (gossip_chat_present):
	* src/gossip-preferences.c: (preferences_setup_widgets),
	(gossip_preferences_show):
	* ui/main.glade:
	- Added setting on whether to always open chats in new window or not.

2005-08-24  Martyn Russell  <mr@gnome.org>

	* protocols/jabber/gossip-jabber-helper.[ch]:
	- Removed.

	* protocols/jabber/gossip-jabber-services.[ch]:
	* protocols/jabber/gossip-jabber-utils.[ch]:
	* protocols/jabber/gossip-jabber-vcard.[ch]:
	- Added.

	* libgossip/gossip-async.h:
	* libgossip/gossip-protocol.[ch]:
	* libgossip/gossip-session.c:
	* src/gossip-app.c:
	- Small updates to the API.
	
	* protocols/jabber/gossip-jabber.[ch]:
	* protocols/jabber/gossip-transport-accounts.c:
	- Cleaned up the code and things are grouped better .
	
2005-08-24  Martyn Russell  <mr@gnome.org>

	* libgossip/Makefile.am (EXTRA_DIST): 
	- Added dtd_DATA to EXTRA_DIST (Paul van Tilburg).

2005-08-24  Martyn Russell  <mr@gnome.org>

	* libgossip/gossip-session.[ch]: 
	- Added gossip_session_count_connected() and
	gossip_session_count_disconnected().

	* src/gossip-app.c (app_connection_items_update): 
	- Still show connect and disconnect menu items if there are
	accounts left to connect or disconnect.
	- Don't disconnect before we connect.

2005-08-24  Martyn Russell  <mr@gnome.org>

	* ui/main.glade:
	* src/gossip-new-account-window.c:
	* protocols/jabber/gossip-jabber.c: 
	- Added some SSL debugging.
	- Fixed not registering with SSL in Jabber back end.
	- Added use SSL / use proxy options into new account wizard (or
	welcome druid).
	- Fixes bug #165404 (Mikael).
	- Fixes bug #117856 (skadz@mindstorm.com).

	* libgossip/gossip-session.c: 
	- Added some checks before sending presence and messages to
	offline accounts, stops expected warnings.

2005-08-23  Martyn Russell  <mr@gnome.org>

	* ui/connect.glade:
	* src/gossip-accounts-window.c: 
	- You can now connect/disconnect individule accounts.
	- You can now edit the auto connect property in this window.
	- Account state is followed.

	* src/gossip-add-contact.c:
	* src/gossip-app.c:
	* src/gossip-join-dialog.c:
	* src/gossip-vcard-dialog.c:
	- Account state is reflected and you can not select offline
	accounts now.
	- Used bigger size icon (GTK_ICON_SIZE_BUTTON), instead of MENU.

	* libgossip/gossip-session.[ch]: 
	- gossip_session_connect() and gossip_session_disconnect() now
	take an account if you don't want to connect or disconnect ALL
	accounts. 

2005-08-23  Martyn Russell  <mr@gnome.org>

	* src/gossip-notebook.c (button_release_cb): 
	- Fixed drag to detach a tab, spotted by Richard.

2005-08-23  Martyn Russell  <mr@gnome.org>

	* src/gossip-app.c: 
	- Make use of gdk_pixbuf_saturate_and_pixelate() as suggested by
	Ross to show the account protocol image in black and white or colour. 
	- Clicking on the accounts now shows the accounts window.

	* src/gossip-accounts-window.c
	(accounts_window_model_add_columns): 
	- Removed some unused code.

2005-08-22  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_connection_items_setup): Fix runtime
	warning.

2005-08-22  Martyn Russell  <mr@gnome.org>

	* ui/main.glade:
	* src/gossip-app.c: 
	- If we have more than 2 accounts configured, show an
	online/offline status in the top righ of the window so we know
	which ones are connected.
	- Add/Remove accounts based on account-manager signals.
	
	* protocols/jabber/gossip-jabber.c: 
	* libgossip/gossip-session.[ch]: 
	* libgossip/gossip-protocol.[ch]: 
	- Return the GossipAccount with connected/disconnected signals.

	* libgossip/gossip-account.[ch]:
	* libgossip/gossip-account-manager.c (gossip_account_manager_get_default): 
	- Fixed getting the default account.
	* ui/connect.glade:
	- We can now set the default account (window doesn't update yet).

2005-08-22  Martyn Russell  <mr@gnome.org>

	* libgossip/Makefile.am:
	* libgossip/gossip-account.[ch]:
	* libgossip/gossip-account-manager.[ch]:
	* libgossip/gossip-session.[ch]:
	- Removed all the file parsing and multiple account handling out
	and put it into gossip-account-manager. 
	- Linked the account manager to the session.

	* src/gossip-account-info-dialog.c
	* src/gossip-accounts-window.c:
	* src/gossip-add-contact.c:
	* src/gossip-app.[ch]:
	* src/gossip-main.c:
	* src/gossip-new-account-window.c:
	* src/gossip-register.c:
	* src/gossip-ui-utils.c:
	- Changes to reflect account work.

	* ui/connect.glade:
	* ui/main.glade:
	- Cleaned up some duplicate mnemonics.
	- Made use of CAN_DEFAULT.
	- Added close button to accounts window.

2005-08-19  Martyn Russell  <mr@gnome.org>

	* protocols/jabber/gossip-jabber-helper.c
	(gossip_jabber_helper_get_vcard): 
	- Clean up loose reference.

	* src/gossip-app.c:
	* src/gossip-chat-window.c:
	* src/gossip-sound.c:
	* libgossip/gossip-session.[ch]: 
	- If GossipAccount is supplied, get connected status of that, if
	not get overall connected status based on connection logged in count.

	* src/gossip-vcard-dialog.c (vcard_dialog_setup_accounts): 
	- Set active first connected account.
	- Disable any disconnected accounts.

	* ui/connect.glade:
	- Better positioning for accounts window/dialog.

2005-08-19  Martyn Russell  <mr@gnome.org>

	* src/gossip-account-info-dialog.[ch]:
	* src/gossip-accounts-window.[ch]:
	- Added to handle multiple accounts.
	- Fixes bug #165519 (Martyn).

	* src/gossip-accounts-dialog.[ch]:
	* src/gossip-startup-druid.[ch]:
	- Removed.

	* src/gossip-new-account-window.[ch]:
	- Added to replace gossip-startup-druid since we use the same
	wizard when adding new accounts now (except we skip the	welcome
	page). 

	* ui/connect.glade:
	* ui/main.glade:
	- Reflect new files gossip-account-info-dialog and
	gossip-accounts-window.
	- Fixes bug #314140 (Adam Weinberger).
	
	* src/gossip-app.c:
	* src/gossip-main.c:
	* libgossip/gossip-session.c: 
	- Only start accounts on startup if they have the "auto_connect"
	flag is set. 

	* src/gossip-register.c:
	* src/gossip-ui-utils.c:
	* libgossip/gossip-account.[ch]: 
	- Improved API to be able to add/remove accounts.
	- Fixed xml parser to read in the auto_connect flag properly.

	* protocols/jabber/gossip-jabber-chatrooms.c: 
	- Added a lot of checks before dereferencing pointers.

	* protocols/jabber/gossip-jid.c (gossip_jid_get_part_name): 
	- Fixed crash when returning "" instead of g_strdup("") on error.

	* src/gossip-join-dialog.c:
	- Improved method for only showing one join dialog.
	
2005-08-18  Martyn Russell  <mr@gnome.org>

	* protocols/jabber/gossip-jid.c (gossip_jid_get_part_name): 
	- On error "" is returned and it is not allocated memory, g_free
	doesn't like this :)

2005-08-18  Martyn Russell  <mr@gnome.org>

	* libgossip/gossip-account.c:
	(gossip_accounts_get_default): 
	- Check name in this special case, prevents an expected warning.

	* src/gossip-chat-window.c:
	- Added some debugging.

	* src/gossip-app.c:
	- Fixed quitting from the menu when there are NO events pending.
	
	* src/gossip-contact-groups.c:
	* src/gossip-status-presets.c: 
	- Renamed files to include .xml
	- This has been done so there is a distinction between the old
	gconf config files and the new XML files and should mean Gossip
	0.9 and other versions can co-exist. 

2005-08-17  Martyn Russell  <mr@gnome.org>

	* src/gossip-app.c: 
	- Use OK/Cancel for quitting with unread events, makes more sence.
	- If quitting from the Chat->Quit menu use the same path as
	closing the window. 

2005-08-17  Martyn Russell  <mr@gnome.org>

	* configure.ac: 
	- Bumped requirement of libxml2 to 2.6.18 after Ross reported
	problems with 2.6.17 (Unimplemented block at xmlreader.c:1610).
	
	* src/gossip-app.c (app_main_window_destroy_cb): 
	- Ask user if they really want to quit when unread events are
	pending in the event manager. 
	- Partly fixes bug #155135 (Keywan Najafi Tonekaboni).

	* libgossip/gossip-event-manager.[ch]:
	* libgossip/gossip-event.c (gossip_event_get_event_type): 
	- Added implementation for gossip_event_manager_get_event_count()
	and gossip_event_manager_get_events().
	- Check object is an event before returning type.

2005-08-17  Martyn Russell  <mr@gnome.org>

	* src/gossip-notebook.c: 
	- Fixed up the gossip notebook so it would actually show the
	target you are going to drag to and ONLY commit when the button is
	released instead of immediately.
	- Fixes bug #142192 (Sjoerd Simons).

	* src/gossip-chat-window.c:
	- Added debugging definition d(x).

2005-08-17  Martyn Russell  <mr@gnome.org>

	* src/gossip-chat-window.c (chat_window_drag_data_received): 
	- Stop flashing when dragging a contact to a chat window.
	- Fixes bug #151859 (Paul van Tilburg).

2005-08-17  Martyn Russell  <mr@gnome.org>

	* src/gossip-vcard-dialog.c:
	* src/gossip-transport-add-window.c:
	* src/gossip-transport-accounts-window.c:
	* src/gossip-spell.c:
	* protocols/jabber/gossip-jabber-chatrooms.c:
	* protocols/jabber/gossip-jabber-helper.c:
	* protocols/jabber/gossip-transport-accounts.c:
	* protocols/jabber/gossip-transport-discover.c:
	* protocols/jabber/gossip-transport-protocol.c:
	* protocols/jabber/gossip-transport-register.c
	* libgossip/gossip-contact.c:
	* libgossip/gossip-account.c: 
	- Turned off debugging d(x) x

	* libgossip/gossip-session.c (session_protocol_logged_out): 
	- Fixed counting issue, caused unnecessary warnings.

	* ui/main.glade:
	* src/gossip-add-contact.c (gossip_add_contact_new): 
	- Set the next button to be default when pressing enter.
	- Fixes bug #160216 (bram@luon.net).
	- Fix adding contacts from chat windows with multiple acocunts.

	* ui/chat.glade:
	* src/gossip-chat-window.c:
	- Add ability to add contacts from a chat conversation window.
	- Fixes bug #141787 (Brad Taylor).

2005-08-17  Martyn Russell  <mr@gnome.org>

	* libgossip/gossip-account.c (ACCOUNTS_DTD_FILENAME): 
	- Was incorrect.

2005-08-16  Martyn Russell  <mr@gnome.org>

	* src/gossip-app.c (app_status_show_status_dialog): 
	- Added completion as well as a combo option for the last 5
	status'. 
	- Fixes bug #156285 (Martyn).

2005-08-16  Martyn Russell  <mr@gnome.org>

	* libgossip/gossip-account.dtd: 
	- Forgot to cvs add this file.
	
2005-08-16  Martyn Russell  <mr@gnome.org>

	* libgossip/gossip-account.[ch]:
	* libgossip/gossip-session.[ch]:
	- Added gossip_session_get_contacts_by_account().
	- Added gossip_account_equal()
	
	* src/Makefile.am:
	* src/gossip-chat-invite.[ch]: 
	* src/gossip-chat-window.[ch]:
	* src/gossip-chat.[ch]:
	* src/gossip-contact-list.[ch]:
	* src/gossip-private-chat.c:
	- Added to handle invite message dialog and invite menu generation
	instead of repeating the code in 3/4 different places. 
	- Added support to invite contact to a group chat from the chat
	window using a the menu bar.

	* src/gossip-main.c:
	- Only get accounts once.

2005-08-16  Martyn Russell  <mr@gnome.org>

	* ui/connect.glade:
	* ui/group-chat.glade:
	* ui/main.glade:
	* src/gossip-vcard-dialog.c:
	* src/gossip-ui-utils.c:
	* src/gossip-startup-druid.c:
	* src/gossip-register.c:
	* src/gossip-private-chat.c:
	* src/gossip-main.c:
	* src/gossip-join-dialog.c: 
	* src/gossip-group-chat.c: 
	* src/gossip-contact-list.c: 
	* src/gossip-contact-info.c: 
	* src/gossip-chat-view.[ch]:
	* src/gossip-app.c:
	* src/gossip-add-contact.c
	* protocols/jabber/gossip-jabber.c: 
	* protocols/jabber/gossip-jabber-chatrooms.c:
	- Repercussions of updates to libgossip.

	* libgossip/gossip-session.[ch]: 
	- Updated to work with n accounts instead of just ONE account.
	* libgossip/gossip-contact.[ch]: 
	- Added account property, to tie contacts to an account.
	* libgossip/gossip-account.[ch]: 
	- Reworked GossipAccount to make better use of GObject and to use
	an XML file which is DTD verified. 

	* libgossip/Makefile.am: 
	- Added DTD details for accounts XML work.
	* configure.ac: 
	- Added libxml dependency for libgossip.

	* src/gossip-status-presets.c:
	* src/gossip-main.c:
	* src/gossip-log.c:
	* src/gossip-contact-groups.c:
	* src/gossip-about.c:
	* protocols/jabber/gossip-transport-protocol.c:
	- Use PACKAGE_NAME instead of "Gossip".

2005-08-14  Martyn Russell  <mr@gnome.org>

	* src/gossip-join-dialog.c (gossip_join_dialog_show): 
	- Fixed a bug where the join group chat dialog crashes if you
	click Cancel after immediately loading it.  This is due to the
	weak reference to the dialog added at setup time.
	- Fixes bug #313486 (Brian Pepple).

2005-08-14  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-manager.c: (chat_manager_new_message_cb),
	(gossip_chat_manager_get_chat):
	* src/gossip-contact-list.c:
	* src/sounds/.cvsignore:
	- Turn of printouts.

2005-08-14  Mikael Hallendal  <micke@imendio.com>

	* Release 0.9

2005-08-14  Martyn Russell  <mr@gnome.org>

	* ui/main.glade: 
	- Last minute fix to disable transports since we are not using
	them at the moment.

2005-08-14  Mikael Hallendal  <micke@imendio.com>

	* acinclude.m4:
	* configure.ac:
	* libgossip/Makefile.am:
	* src/sounds/Makefile.am:
	- Dist check 

2005-08-14  Mikael Hallendal  <micke@imendio.com>

	* NEWS: Updated for 0.9.

2005-08-14  Richard Hult  <richard@imendio.com>

	* src/gossip-contact-list.c
	(contact_list_contact_presence_updated_cb):  
	- Only update pertinent information for contact, not the active
	status, this is done is	contact_list_contact_set_active() anyway.
	- Some servers send presence after sending available which meant
	the active state would be set to FALSE immediately after it was
	set TRUE and nothing appears to happen on the roster. 
	- Fixes bug #312906 (again).
	
2005-08-14  Mikael Hallendal  <micke@imendio.com>

	* configure.ac:
	- Bumped Loudmouth requirement to 1.0
	- Bumped version to 0.9
	* src/gossip-about.c: (button_press_event_cb):
	* ui/pixmaps/gossip-about.png:
	- Updated project URL.

2005-08-12  Martyn Russell  <mr@gnome.org>

	* src/gossip-contact-list.c
	(contact_list_contact_presence_updated_cb):  
	- Only update presence for contacts which are on our roster to
	stop receiving presence from people we don't want to see presence
	from. 
	- Fixes bug #312906 (Richard).

2005-08-12  Martyn Russell  <mr@gnome.org>

	* src/gossip-chat-window.c (gossip_chat_window_finalize): 
	- Disconnect the the "disconnected" function callback properly.
	- Fixes bug #306381 (again).

2005-08-11  Martyn Russell  <mr@gnome.org>

	* src/gossip-contact-list.c
	(contact_list_contact_presence_updated_cb):   
	- Earlier code change to ONLY highlight online/offline contacts on
	the roster was not working when showing offline contacts.  I have
	retested the code and it seems to work better.
	- Fixes bug #312407 (Richard).

2005-08-11  Martyn Russell  <mr@gnome.org>

	* src/gossip-chat-window.c (gossip_chat_window_init): 
	- Connect disconnected signal to session not app, so now we get
	the disconnected signal and update the chat window contact
	states.  This should really operate on a per protocol basis not a
	per session (since contacts are bound to accounts not the whole
	session which may have 3 accounts).
	- Fixes bug #306381 (Paul van Tilburg).

	* libgossip/gossip-session.c: 
	- Turn off debugging output.

2005-08-10  Martyn Russell  <mr@gnome.org>

	* src/gossip-chat-view.c (chat_view_copy_address_cb): 
	- "Copy Link Address" context menu now copies to both PRIMARY and
	CLIPBOARD.
	- Fixes bug #152479 (Christian Borup).

2005-08-10  Martyn Russell  <mr@gnome.org>

	* src/gossip-app.c (app_subscription_request_cb): 
	- Make use of the event manager for subscriptions (instead of just
	popping a dialog).
	- Fixes bug #120245 (Richard).

2005-08-02  Martyn Russell  <mr@gnome.org>

	* src/gossip-contact-list.c (contact_list_contact_presence_updated_cb): 
	- changed roster behaviour so we don't highlight the roster for
	simple presence changes, only online/offline changes. 

2005-08-01  Martyn Russell  <mr@gnome.org>

	* protocols/jabber/gossip-jabber-chatrooms.c
	(jabber_chatrooms_presence_handler): 
	- Removed warning about invalid chatroom ID since a lot of
	presence messages will NOT be for a chatroom.

	* protocols/jabber/gossip-jabber.c (jabber_setup): 
	- #ifdef'd out the transport initiation code since it serves no
	purpose at the moment and generates a lot of extra unnecessary
	traffic. 

2005-07-22  Martyn Russell  <mr@gnome.org>

	* src/gossip-account-dialog.c: 
	- Fixed register button not actually doing anything.

2005-07-21  Martyn Russell  <mr@gnome.org>

	* protocols/jabber/gossip-jabber-helper.c:
	- Fixed 2 instances of the compiler complaining about
	uninitialised variables.

2005-07-21  Martyn Russell  <mr@gnome.org>

	* src/gossip-status-presets.[ch]:
	* src/gossip-status-presets.dtd:
	- Added to handle XML file .gnome2/Gossip/StatusPresets
	* ui/main.glade: 
	* src/gossip-app.c (app_status_show_status_dialog): 
	- Changed the operation to use async callbacks with response
	signals, etc instead of using gtk_dialog_run.
	- Use a GtkComboBoxEntry now with 5 presets in the drop down.

2005-07-21  Martyn Russell  <mr@gnome.org>

	* libgossip/gossip-async.h: 
	* protocols/jabber/gossip-jabber.c: 
	* protocols/jabber/gossip-jabber-helper.c: 
	- Actually set the subscription type for a contact, this also
	fixes the subscription being NONE and every contact info dialog
	having the resubscribe text/buttons, etc.
	- Look at the errors returned for vcard/version lookups and
	provide that back to the async callback.
	* src/gossip-contact-list.c:
	* src/gossip-stock.[ch]:
	* ui/pixmaps/vcard_16.png:
	* ui/pixmaps/Makefile.am: 
	- Added vcard_16.png for contact information context menu.
	* src/gossip-contact-info.[ch]:
	- Added subscribe functionality back.
	* ui/chat.glade:
	* ui/connect.glade:
	* ui/group-chat.glade:
	* ui/main.glade:
	- Make sure dialogs/windows look consistent. 
	- Removed send_message_dialog and recv_message_dialog since they
	are no longer in use.
	- Improved the contact-info dialog.

2005-07-19  Mikael Hallendal  <micke@imendio.com>

	* protocols/jabber/gossip-jabber-chatrooms.c:
	(jabber_chattroms_join_cb): Initialize room.

2005-07-16  Martyn Russell  <mr@gnome.org>

	* src/gossip-contact-list.c: 
	- Added support to invite contacts to a chat room.
	- Updated the context menu so things are more logically grouped.
	- Edit Groups now uses the Edit stock item.
	* ui/chat.glade:
	* src/gossip-chat-window.c: 
	- Added the beginings of an Invite menu to the chat window.
	* protocols/jabber/gossip-jabber-chatrooms.c: 
	- Added backend support for get_rooms function.
	* libgossip/gossip-contact.h (gossip_contact_get_status): 
	- Cleaned up.

2005-07-15  Martyn Russell  <mr@gnome.org>

	* protocols/jabber/gossip-jabber-chatrooms.c:
	- Do nothing if there is no room, but actually work.
	- Make sure if we cancel the join that we clean up the message
	handlers associated with the join.

2005-07-15  Martyn Russell  <mr@gnome.org>

	* src/gossip-join-dialog.c:
	- Added support for most conditions (including NICK_IN_USE,
	NEED_PASSWORD, TIMED_OUT, UNKNOWN_HOST, UNKNOWN_ERROR,
	ALREADY_OPEN and OK). 
	- Fixed a crash reported by Paul van Tilburg, fixes bug #306382.
	- Fixed condition where some servers don't reply to joining group
	chat with the ID in the presence message they were sent with
	(reproducible with Paul van Tilburg's server).
	- When adding as a favourite, make it the_last_ favourite and
	select it in the combobox.
	- Cancel join process properly when closing the dialog during
	joining or when actually clicking cancel.
	- Cleaned up the code.
	* src/gossip-edit-favorite-dialog.c: 
	- Moved the 'delete' button for group chat favourites from this
	dialog to the main join dialog.
	* protocols/jabber/gossip-jabber.c: 
	- Cleaned the code up in places.
	- Changed all message handler priorities to NORMAL as ALL handlers
	were using HIGH.  
	* libgossip/gossip-chatroom-provider.[ch]: 
	- Added gossip_chatroom_provider_cancel (stops joining).
	- Return GossipChatroomId directly from _join.
	- Added a bunch of join result conditions including TIMED_OUT,
	UNKNOWN_HOST, UNKNOWN_ERROR, ALREADY_OPEN.
	* ui/group-chat.glade:
	- Improved the join group chat dialog.

2005-07-12  Martyn Russell  <mr@gnome.org>

	* protocols/jabber/gossip-jabber-chatrooms.c (gossip_jabber_chatrooms_join): 
	- Added checks for already open chat rooms before blindly opening
	a new room.  If one already exists, we just return _ALREADY_OPEN
	with the currently open room id. 

2005-07-11  Martyn Russell  <mr@gnome.org>

	* protocols/jabber/gossip-jabber.c (jabber_unknown_request): 
	- Added error code for legacy support.
	* protocols/jabber/gossip-jabber-chatrooms.c
	(gossip_jabber_chatrooms_invite_accept): 
	- Added to push the invite_id back to the backend so they know how
	to connect to it (e.g. if it is room@conference.jabber.org, then
	the jabber backend will know how to connect to it).
	- Use no <body> tag if there is no invite message.
	* src/gossip-chat-view.c (gossip_chat_view_append_chat_message): 
	- Added a bit more logic to show the invite id only if it is not
	in the message body.
	- Use a generic message in the recipients language if there is no
	invitiation message and support a custom message from the sender.
	* src/gossip-group-chat.c:
	- Added a message dialog to ask the user for the invite text when
	asking a contact to a join a group chat session.  

2005-07-09  Martyn Russell  <mr@gnome.org>

	* src/gossip-chat-view.[ch]: 
	* src/gossip-private-chat.c: 
	- Added basics to show a button for a conference invite, this
	still needs a bit of work and some checking in places.  Plus it is
	not completely abstract and needs to be.
	* src/gossip-group-view.[ch]: 
	- Added DND so you can drag someone off your roster into the
	contacts list in a group chat window and it will send an invite.
	- Cleaned up the code.
	* libgossip/gossip-chatroom-provider.[ch]: 
	- Provided _invite and _get_rooms functions.
	- Cleaned up the code.
	* libgossip/gossip-message.[ch]:
	- Added _get_invite and _set_invite.
	* protocols/jabber/gossip-jabber-helper.[ch]:
	- Added gossip_jabber_helper_get_conference_from_lm_message to get
	the jabber:x:conference part of a Jabber message.
	* protocols/jabber/gossip-jabber.c (jabber_unknown_request): 
	- Respond with error if we don't recognise the
	jabber:iq:... namespace. 
	- Fixes bug #128358.
	
2005-07-09  Martyn Russell  <mr@gnome.org>

	* src/gossip-contact-groups.c (contact_groups_file_save): 
	* src/gossip-contact-list.c (contact_list_drag_data_get): 
	- Fixed GCC4 Warnings since it is more pedantic now especially
	about signed and unsigned differences.

2005-06-26  Martyn Russell  <mr@gnome.org>

	* src/gossip-app.c:
	* libgossip/gossip-session.c:
	- Moved dbus initiation to session creation.
	* configure.ac:
	* src/gossip-dbus.c: 
	- Require dbus 0.34 when enabled.
	- Cleaned the code up in places and make sure it compiles with
	todays code since it didn't due to code reorgs. 
	- Fix build issues with the latest dbus API (based on a patch from
	Julien Puydt).
	- Fixes bug #303187.
	
2005-06-26  Martyn Russell  <mr@gnome.org>

	* src/gossip-contact-list.c (contact_list_drag_data_received): 
	- Respect the MOVE and COPY actions (was doing COPY every time before).

2005-06-26  Martyn Russell  <mr@gnome.org>

	* src/gossip-ui-utils.c: 
 	- Removed DINGUS for regex work as it is already defined in
	gossip-utils.c 
	* libgossip/gossip-protocol.[ch]: 
	- Added error handling with gossip_protocol_error() which emits
	the new "error" signal with a GError. 
	* libgossip/gossip-session.c:
	- Added "protocol-error" signal which is propagated by listening
	to protocol "error" signals.
	* protocols/jabber/gossip-jabber.c:
	- Added calls into gossip_protocol_error() where needed so that
	now we get all errors reflected up the code stack.
	- Cleaned up the code in places.
	* src/Makefile.am:
	* src/gossip-connect-dialog.c: 
	* ui/connect.glade:
	- Removed gossip-connect-dialog and all references to it; this has
	not been in use for some time now. 
	* src/gossip-app.[ch]: 
	- Removed the need for GossipAccount to be saved in the GossipApp
	priv.
	- Added handler for "protocol-error" signal so we can present
	dialogs for authentication failures and other connection errors.
	- Cleaned up the code in places.

2005-06-07  Frank Arnold  <frank@scirocco-5v-turbo.de>

	* ui/group-chat.glade.h:
	* ui/main.glade.h:
	* src/gossip-transport-add-window.c:
	- Fixed typos.
	- Fixes bug #305123.

2005-06-05  Martyn Russell  <mr@gnome.org>

	* src/gossip-join-dialog.c (join_dialog_timeout_cb): 
	- Added message dialog if joining a group chat times out after 20
	seconds. 
	- Fixes bug #306507.

2005-06-05  Martyn Russell  <mr@gnome.org>

	* src/Makefile.am (AM_CPPFLAGS): 
	- Include new files
	- Add DTDDIR definition.
	* src/gossip-contact-groups.[ch]:
	* src/gossip-contact-groups.dtd:
	- Added.
	* src/gossip-contact-list.c:
	- Hooked up new code to expand/collapse callbacks.
	- Fixes bug #305198.
	
2005-06-04  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_subscription_request_dialog_cb): Only use
	the vcard if there is one, otherwise use the ID as name. Don't
	unref the vcard if there is none.
	(app_subscription_vcard_cb): Likewise, only access the vcard if
	there is one.

2005-06-04  Martyn Russell  <mr@gnome.org>

	* src/gossip-app.c (app_set_away): 
	- Thought this bug was fixed, but not in all cases it would seem.
	As Paul van Tilburg pointed out, if you were in a busy state and
	waited to go into an auto away state, it would set you too
	Available instead. 
	- Fixes bug #306374.
	
2005-06-04  Martyn Russell  <mr@gnome.org>

	* src/gossip-app.c (app_status_show_status_dialog): 
	- Set presence status even if it is NULL since gossip-presence can
	now handle a NULL value.  Now setting presence to the default will
	actually change the status text.
	- Fixes bug #306367.

2005-06-03  Mikael Hallendal  <micke@imendio.com>

	* configure.ac: 
	- Make aspell configuration default to auto not, yes. Otherwise build
	  fails when aspell is not installed.

2005-05-30  Paul van Tilburg  <paul@luon.net>

	* src/gossip-app.c (app_idle_check_cb): 
	- Fixed a bug where starting xscreensaver would set your state to
	extended away and Gossip would presume to be in an Away state. The
	up shot of this was Gossip would send Available constantly every
	second or so.  Now the user goes into the correct Away state
	(reported by Sjoerd Simons & Paul van Tilburg).

2005-05-30  Martyn Russell  <mr@gnome.org>

	* src/gossip-join-dialog.c (gossip_join_dialog_show): 
	- Fixed crash when clicking properties on the separator.
	- Separator now not shown when there are no favorites.

2005-05-19  Martyn Russell  <mr@gnome.org>

	* src/gossip-preferences.c:
	* ui/main.glade:
	- Actually hide the "Enable Spell Checker" option when there is no
	spell checking available.
	* src/gossip-chat.c (chat_input_text_buffer_changed_cb): 
	- Added extra check to make sure there are errors on each key
	press when there is no spell backend.
	* configure.ac:
	- Based on a patch from Fryderyk Dziarmagowski, the ASpell feature
	can now be turned off.
	- I have not made it default to disable aspell as the bug reporter
	suggests.
	- Fixes bug #304301.

2005-05-19  Martyn Russell  <mr@gnome.org>

	* src/gossip-chat-view.c: 
	- Added support for backwards smileys.
	- Fixes bug #304096.

2005-05-19  Martyn Russell  <mr@gnome.org>

	* ui/main.glade:
	* src/gossip-status-presets-dialog.c: 
	- Reverted the changes so the dialog looks like it did.  After
	further talks with Micke usability wise, it is better the way it
	was. 

2005-05-18  Mikael Hallendal  <micke@imendio.com>

	* MAINTAINERS: Updated
	* libgossip/Makefile.am: Don't install libgossip

2005-05-17  Martyn Russell  <mr@gnome.org>

	* src/gossip-status-presets-dialog.c:
	- Forgot to cvs add the files lastnight.
	
2005-05-17  Martyn Russell  <mr@gnome.org>

	* src/Makefile.am: 
	- Added gossip-status-presets-dialog.[ch].
	* ui/main.glade:
	* src/gossip-app.c:
	* src/gossip-preferences.c:
	* src/gossip-status-presets-dialog.[ch]:
	- Moves the status presets out of the preferences module and into
	its own module. 
	- Updated the status presets dialog to be better looking and made
	use of the GtkCellRendererCombo for the list of presets when
	configuring the type of presence (the status message is also
	editable). 

2005-05-15  Martyn Russell  <mr@gnome.org>

	* po/POTFILES.in:
	* src/Makefile.am:
 	- Added new gossip-edit-favorite.
	* src/gossip-favorites-dialog.[ch]:
	- No longer used.
	* src/gossip-edit-favorite.[ch]:
	* src/gossip-favorite.c (gossip_favorite_find): 
	- Added.
	* src/gossip-group-chat.c (group_chat_widget_destroy_cb): 
	- Disconnect signal handlers when we destroy the chat object.
	Fixes a crash calling a disconnect handler when exiting.
	* ui/group-chat.glade:
	* src/gossip-join-dialog.c:
	- Reworked the group chat join dialog and its favourites. 
	- Show progressbar after 2 seconds if we are not successfully set up.
	- Fixes bug #141579.

2005-05-15  Richard Hult  <richard@imendio.com>

	* protocols/jabber/gossip-jabber.c: (jabber_login): Initialize the
	GError, fixes login crash when there's no network.

2005-05-14  Jonatan Magnusson  <jonatan@pnx.se>

	* src/gossip-contact-list.c (contact_list_contact_presence_updated_cb): 
	- Added sound triggers for online/offline.
	* src/gossip-sound.c:
	- Make use of gnome_trigger_do() instead of playing sounds
	directly with gnome_sound_play this way it is configurable in
	Gnome what sounds are played for which events.
	- Added debugging (off by default).
	* src/sounds/Makefile.am:
	* src/sounds/gossip.soundlist.in:
	- Added soundlist which is installed to $(sysconfig)/sound/events,
	unfortunately, from my investigation into this, when you change
	the preferences and install the sound file, you need to restart
	gdm for the changes to occur (on Gnome 2.8).
	- Fixes bug #171044.
	
2005-05-13  Martyn Russell  <mr@gnome.org>

	* src/gossip-contact-list.c (contact_list_setup_view): 
	- Removed use of MODEL_COL_IS_ACTIVE being associated with an
	attribute for the renderer.
	* src/gossip-app.c (app_subscription_request_dialog_cb): 
	- Don't depend on a Vcard here, if we do and we couldn't get it,
	then you can't do anything in the dialog - Doh!

2005-05-13  Martyn Russell  <mr@gnome.org>

	* src/gossip-cell-renderer-text.c:
	- Cleaned up the code a little and added the i18n header for glib
	that Richard forgot to add to this file.
	* src/gossip-contact-list.c:
	- Re-added and reimplemented in places the feature where contacts
	that change state or come online/offline are highlighted for 5
	seconds or so as an indication to the user. 

2005-05-12  Richard Hult  <richard@imendio.com>

	* libgossip/*:
	* src/*: Use the i18n headers from glib instead of libgnome.

	* src/gossip-main.c: Don't use the tarball package name as gettext
	domain, makes translations work again.

2005-05-12  Martyn Russell  <mr@gnome.org>

	* gossip.desktop.in.in:
	- Updated the name to reflect what type of application Gossip is.
	- Fixes bug #303602.

2005-05-08  Martyn Russell  <mr@gnome.org>

	* libgossip/gossip-account.[ch]: 
	- Added gossip_account_remove.
	- Don't set default account if already the default.
	* libgossip/gossip-protocol.[ch]: 
	* libgossip/gossip-session.[ch]: 
	* protocol/jabber/gossip-jabber.c: 
	- Added _setup() functions.  The init() functions used the
	default account before, now they use the account passed in
	_setup() but would be better passed on init().  Restarting Gossip
	after changing account details is no longer needed to use them. 
	* src/gossip-account-dialog.c: 
	- Updated the code and fixed a bug where changing an entry and
	clicking OK would not use the new value unless moving to another
	widget prior to that.
	* src/gossip-app.c: 
	- Added a message dialog when trying to connect with no IM acounts
	set up.  Added this instead of disabling the "connect" item
	because this connect is attempted after the startup druid
	finishes.
	- Fixes bug #172029.

2005-05-08  Martyn Russell  <mr@gnome.org>

	* MAINTAINERS:
	* AUTHORS:
	- Updated name.
	* protocols/jabber/gossip-jabber.c:
	* libgossip/gossip-protocol.[ch]:
	* libgossip/gossip-session.c:
	- Implemented the _find_contact functions for chat drag and drop.
	* src/gossip-contact-list.c: 
	* src/gossip-chat-window.c:
	- Added support for drag and drop to chat windows and to move
	contacts between groups on the roster (based on the patch from
	#300586). 
	- Fixes bug #300586.
	- Fixed bug #142521.

2005-05-07  Mikael Hallendal  <micke@imendio.com>

	* MAINTAINERS: Added a maintainers file with me and Martyn.
	* AUTHORS: Added Martyn.

2005-05-05  Mikael Hallendal  <micke@imendio.com>

	* protocols/jabber/gossip-transport-protocol.c:
	(transport_protocol_file_parse):
	- Fix some casts caught by gcc-4
	- Patch from Thomas Reynolds.

2005-05-05  Martyn Russell  <mr@gnome.org>

	* libgossip/gossip-protocol.[ch]:
	* libgossip/gossip-session.c:
	* protocols/jabber/gossip-jabber.c:
	* src/gossip-app.c:
	* ui/main.glade:
	- Readd subscription requests which has been disabled since large
	  rewrite earlier this year.
	- Reworked the subscription request dialog and the add contact
	  dialogs.
	- Fixes bug #162619

2005-05-05  Martyn Russell  <mr@gnome.org>

	* libgossip/gossip-contact.c:
	* libgossip/gossip-protocol.[ch]
	* libgossip/gossip-session.h:
	* protocols/jabber/gossip-jabber.c:
	* src/gossip-contact-list.[ch]
	* src/gossip-edit-groups-dialog.c: 
	* ui/main.glade:
	- Fixed group editing after code restructure and move to libgossip.
	- Fixes bug #155735

2005-05-05  Martyn Russell  <mr@gnome.org>

	* src/gossip-log.c: (gossip_log_message):
	- Fixes bug #163145
	- Don't set the same name for both contacts in logs.

2005-05-05  Mikael Hallendal  <micke@imendio.com>

	* libgossip/gossip-session.c: (gossip_session_init),
	(session_protocol_logged_in), (session_protocol_logged_out),
	(gossip_session_is_connected):
	* protocols/jabber/gossip-jabber.c: (jabber_logout):
	* src/gossip-group-chat.c: (gossip_group_chat_show),
	(group_chat_connected_cb), (group_chat_disconnected_cb):
	- Fixed the connect/disconnect for group chats
	- Also fixed some issues when disconnecting from the server.
	- Based on patch from Martyn with some changes.
	- Fixes bug #127464.

2005-05-01  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-accounts-dialog.[ch]: Unused, removed.

2005-05-01  Martyn Russell  <mr@gnome.org>

	* src/gossip-add-contact.c: (add_contact_last_page_finished),
	(gossip_add_contact_new):
	* ui/main.glade:
	- Remove the reason field from the add new contact wizard.
	- Fixes #157866

2005-05-01  Martyn Russell  <mr@gnome.org>

	* src/gossip-chat-view.c: (gossip_chat_view_init),
	(chat_view_populate_popup), (chat_view_buffer_changed_cb):
	- Set chat buffer to 500 lines.
	- Fixes #141292

2005-05-01  Mikael Hallendal  <micke@imendio.com>

	* libgossip/.cvsignore:
	* libgossip/Makefile.am:
	* libgossip/gossip-marshal-main.c:
	* libgossip/gossip-marshal.list:
	* libgossip/libgossip-marshal-main.c:
	* libgossip/libgossip-marshal.list:
	- Renamed to libgossip-marshal.*
	* protocols/jabber/gossip-jabber.c:
	- Remove include of gossip-marshal.h
	* src/Makefile.am:
	* src/gossip-marshal-main.c:
	* src/gossip-marshal.list:
	- Added this for the UI.

2005-04-30  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-log.c: (log_transform):
	- Fix for gcc 4.

2005-04-30  Mikael Hallendal  <micke@imendio.com>

	* configure.ac:
	- Added GOSSIP_JABBER check for the jabber module.
	* libgossip/Makefile.am:
	* libgossip/gossip-account.[ch]: 
	- Don't use GossipJID, it's now private in the jabber module.
	* libgossip/gossip-utils.[ch]: 
	- Finished the split of gossip-ui-utils and gossip-utils.
	* src/Makefile.am:
	* src/*.[ch]:
	- Removed code that has been move to libgossip/ and protocols/jabber.
	- Make all code use libgossip instead of using the files that has
	  been removed.
	- Temporarily disable the transports (again...)
	- Everything has now been brought up after the refactoring except 
	  transports which requires adding an interface in libgossip that 
	  can be implement by the Jabber backend (which will most likely be
	  the only backend ever implementing this interface).

2005-04-30  Mikael Hallendal  <micke@imendio.com>

	* Makefile.am:
	* configure.ac:
	* libgossip/Makefile.am:
	* libgossip/gossip-protocol.c: (gossip_protocol_get_contacts):
	* libgossip/gossip-protocol.h:
	* libgossip/gossip-session.c: (gossip_session_init),
	(gossip_session_get_nickname):
	- More work, on the refactoring out of libgossip. 
	- Now builds, next step will be to make the gossip app use this.
	* protocols/Makefile.am:
	* protocols/jabber/Makefile.am:
	* protocols/jabber/gossip-jabber-chatrooms.[ch]:
	* protocols/jabber/gossip-jabber-helper.[ch]:
	* protocols/jabber/gossip-jabber-private.h: added temporarily
	* protocols/jabber/gossip-jabber.[ch]:
	* protocols/jabber/gossip-jabber.h:
	* protocols/jabber/gossip-jid.c:
	* protocols/jabber/gossip-transport-accounts.c:
	* protocols/jabber/gossip-transport-discover.[ch]:
	* protocols/jabber/gossip-transport-protocol.c:
	* protocols/jabber/gossip-transport-register.c:
	- Fixed lots of include issues that shows when splitting out into own
	  directory.

2005-04-25  Mikael Hallendal  <micke@imendio.com>

	* configure.ac:
	- Added LIBGOSSIP pkg check
	* libgossip/Makefile.am:
	* libgossip/gossip-account.[ch]:
	- Don't use GossipJID.
	* libgossip/gossip-contact.[ch]:
	* libgossip/gossip-presence.[ch]:
	- Removed GUI dependency.
	* libgossip/gossip-utils.[ch]:
	- Added
	- The non-GUI parts from src/gossip-utils.[ch]
	* src/gossip-ui-utils.[ch]:
	- The GUI parts from gossip-utils.[ch]

2005-04-24  Mikael Hallendal  <micke@imendio.com>

	* configure.ac:
	* libgossip/Makefile.am:
	* libgossip/gossip-marshal-main.c:
	* libgossip/gossip-marshal.list:
	* protocols/jabber/Makefile.am:
	* src/Makefile.am:
	- Started working on second phase of my long-term Gossip code
	  restructuring. Thanks Anders with help on moving the files.
	- Splitting code into three different parts, the core in libgossip,
	  the ui in src and the jabber implementation in protocols/jabber.

2005-04-24  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-disco-register.c:
	* src/gossip-disco-register.h:
	* src/gossip-disco-servers.c:
	* src/gossip-disco-servers.h:
	* src/gossip-disco-window.c:
	* src/gossip-disco-window.h:
	* src/gossip-disco.c:
	* src/gossip-disco.h:
	- Removed, not used any more
	* src/gossip-favorite.c:
	* src/gossip-favorite.h:
	* src/gossip-idle.h:
	* src/gossip-jabber.c:
	- Removed unneccessary includes.

2005-04-24  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-window.c: (chat_window_drag_data_received):
	- Added a cast to make gcc 4 happy.

2005-04-22  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-add-contact.c: (add_contact_prepare_page_2),
	(add_contact_page_2_vcard_handler), (gossip_add_contact_new):
	* ui/main.glade:
	- Fixes bug #117554.
	- Have a retreiving information label when adding a contact and
	  requesting vcard.

2005-04-20  Mikael Hallendal  <micke@imendio.com>

	* autogen.sh: Use automake 1.9

2005-04-08  Martyn Russell  <mr@gnome.org>

	* src/gossip-cell-renderer-text.c:
	(cell_renderer_text_update_text):
	* src/gossip-chat-window.c: (gossip_chat_window_init),
	(chat_window_update_menu), (chat_window_conv_activate_cb),
	(chat_window_show_contacts_toggled_cb):
	* src/gossip-chat.c: (gossip_chat_get_show_contacts),
	(gossip_chat_set_show_contacts):
	* src/gossip-chat.h:
	* src/gossip-group-chat.c: (gossip_group_chat_class_init),
	(gossip_group_chat_init), (group_chat_create_gui),
	(group_chat_setup_tree), (group_chat_get_group_chat),
	(group_chat_get_show_contacts), (group_chat_set_show_contacts):
	* ui/chat.glade:
	* ui/group-chat.glade:
	- Make group chat contacts list width adjustable.
	- Make it possible to fully hide the contacts.
	- Fixes #130977.

2005-04-06  Richard Hult  <richard@imendio.com>

	* src/gossip-group-chat.c (group_chat_create_gui): Put the chat
	entry before the topic entry in the focus chain.

2005-04-05  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-window.c: (chat_window_create_label): Try an
	even smaller label for the tabs.

	* src/gossip-cell-renderer-text.c:
	(gossip_cell_renderer_text_init),
	(cell_renderer_text_update_text): Remove ellipsizing hack and use
	pango instead.
	
	* src/gossip-contact-list.c: (contact_list_add_contact): Only
	expand groups that are newly created (restores behavior from the
	0.8 branch).

	* src/gossip-notebook.c (button_release_cb): Always remove the
	grab if we have it, not only if the pointer grab is effective,
	since we don't always have that. Fixes stuck grab when dragging
	chats.
	(gossip_notebook_move_page): Remove the label from its old parent
	before reinserting it.

2005-04-04  Richard Hult  <richard@imendio.com>

	* src/gossip-main.c (main): Set application name, makes the window
	list look better when windows are grouped.

	* src/gossip-utils.c: (utils_window_get_is_on_current_workspace),
	(gossip_utils_window_get_is_visible),
	(gossip_utils_window_present): New functions to handle presenting
	a window.

	* src/gossip-app.c: (app_toggle_visibility),
	(app_tray_button_press_cb):
	* src/gossip-chat.c: (gossip_chat_present): Use common hide/show
	functionality from gossip-utils.c. Makes things work better with
	recent metacity.

	* src/gossip-chat-window.c: (chat_window_create_label),
	(chat_window_update_status), (chat_window_tab_added_cb),
	(chat_window_create_notebook): Tweak the tab look; ellipsize the
	labels, make the font a bit smaller and remove the close button to
	waste less space. Make the tabs expand so the labels use as much
	space as they need. The last part might need some additional
	tweaking in case it doesn't feel good.

2005-04-04  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chatroom-provider.[ch]:
	(gossip_chatroom_provider_get_room_name):
	- Get the room name
	* src/gossip-group-chat.c: 
	- Removed the nick private variable and added own_contact instead.
	- The user nick can now be retrieved from own contact name field.
	* src/gossip-jabber-chatrooms.[ch]:
	(gossip_jabber_chatrooms_get_room_name): Added.
	* src/gossip-jabber.c: (jabber_chatroom_get_room_name): Added

2005-04-04  Martyn Russell  <mr@gnome.org>

	* src/gossip-transport-accounts-window.c 
	(transport_accounts_window_destroy): 
	- Uncommented out code?? to disconnect the signal for
	  contact-removed on the GOSSIP_PROTOCOL when the window closes, was
	  calling back with a invalid pointer to an
	  GossipTransportAccountsWindow causing a crash on Quit.

2005-04-04  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-jabber-chatrooms.c:
	(jabber_chatrooms_presence_handler):
	- Handle joined correctly even if we have earlier received a backlog
	  from a contact.
	- Remove contact from list when contact leaves group chat.

2005-04-04  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_event_added_cb), (app_event_removed_cb):
	* src/gossip-group-chat.c: (group_chat_new_room_event_cb):
	* src/gossip-private-chat.c: (gossip_private_chat_init),
	(gossip_private_chat_append_message):
	- Hide a bunch of print outs.

2005-04-04  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-view.[ch]:
	(gossip_chat_view_append_event_message): Renamed to be more consistent
	* src/gossip-chatroom-provider.c: (chatroom_provider_base_init):
	- Added chatroom event signal
	* src/gossip-group-chat.c: 
	(group_chat_new_room_event_cb): Added to handle room events (like 
	  someone joining).
	* src/gossip-jabber-chatrooms.[ch]:
	- More work on adding own contact, more work on presences, emitting 
	  room events etc.
	- Fixes bug #166259.

2005-04-04  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.[ch]: 
	(app_create_status_menu), (app_tray_flash_timeout_func),
	(app_tray_flash_maybe_stop):
	- Refactored to use GossipPresence instead of GossipShow and strings
	  for statuses.
	- Use gossip_session_set_presence, instead of Loudmouth directly to
	  set presence.
	* src/gossip-contact.[ch]: (gossip_contact_get_status):
	- Return default status if presence doesn't have it set.
	* src/gossip-jabber-chatrooms.c:
	(jabber_chatrooms_message_handler):
	- Emit chatroom-title-changed.
	(jabber_chatrooms_get_contact):
	- Take an argument to see if the contact was just added
	(jabber_chatrooms_presence_handler):
	- Implemented, based on patch from Aurelien Naldi.
	- Added emitting of new contacts to the patch.
	* src/gossip-preferences.c:
	- Updated to not use GossipShow API.
	* src/gossip-presence.[ch]:
	(gossip_presence_get_status):
	- Return NULL if not set instead of default value.
	(gossip_presence_state_get_default_status):
	- Added, can be used to get default value if presence doesn't have
	  status set.
	(gossip_presence_state_get_pixbuf): 
	- Added, should be replaced by a function that returns stock id instead.
	* src/gossip-session.c: 
	(gossip_session_set_presence): Implemented by Aurelien Naldi
	* src/gossip-utils.[ch]:
	- DIE GossipShow, DIE!!!!!!!!!!!!!!!!!!
	- Did a lot of refactoring to remove some old cruft and make GossipApp
	  use more of the new code instead.
	* CONTRIBUTORS: Added Aurelien

2005-04-03  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-manager.c: (chat_manager_new_message_cb):
	- Only add a new event if one doesn't already exist. This solves the
	  issue where the notification doesn't go away event though you opened
	  the window.

2005-03-31  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-contact-list.c: (contact_list_contact_updated_cb):
	* src/gossip-contact.[ch]:
	* src/gossip-jabber-helper.c:
	(gossip_jabber_helper_async_get_version):
	* src/gossip-jabber.c: (jabber_presence_handler):
	- Added support for multiple connections to GossipContact so that
	  presence stuff works as intended in Jabber.
	* src/gossip-presence.[ch]: 
	(gossip_presence_resource_equal): Added
	(gossip_presence_priority_sort_func): Added

2005-03-31  Mikael Hallendal  <micke@imendio.com>

	* AUTHORS:
	* CONTRIBUTORS:
	* Makefile.am:
	- Added contributors file

2005-03-30  Bastien Nocera  <hadess@hadess.net>

	* src/gossip-app.c: (gossip_app_init): stop the startup notification
	ourselves if we won't be creating a main window

2005-03-30  Bastien Nocera  <hadess@hadess.net>

	* .cvsignore: upd

2005-03-29  Bastien Nocera  <hadess@hadess.net>

	* src/gossip-app.c: (app_main_window_destroy_cb): Fix warnings on exit
	when no connections or account exist

2005-03-29  Bastien Nocera  <hadess@hadess.net>

	* autogen.sh: Fix missing po/Makefile.in.in on first build

	* configure.ac: Fix XScreenSaver compile check, by adding the
	X11/Xlib.h header to the test

	* src/gossip-jabber.c: (gossip_jabber_init), (jabber_is_connected):
	Fix crash on startup, and some warnings when no accounts have ever
	been setup

2005-03-29  Mikael Hallendal  <micke@imendio.com>

	* acinclude.m4:
	* autogen.sh:
	* configure.ac:
	* configure.in:
	- Fixed configure check for XScreenSaver extensions.
	- Cleaned up the auto* files a bit.

2005-03-15  Richard Hult  <richard@imendio.com>

	* ui/pixmaps/gossip-group-message.png: Use slightly better icon
	for now.

	* src/gossip-jabber-chatrooms.c: Add debug define.

	* src/gossip-group-chat.c (group_chat_new_message_cb): Emit
	new-message so the window get notified and can change the icon.

	* src/gossip-chat-view.c (chat_view_is_scrolled_down): Remove hack
	that disabled this feature for GTK+ < 2.3.

2005-03-11  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-jabber.c: (gossip_jabber_init):
	- Set keep alive rate on Loudmouth connection, reported by Richard.

2005-01-27  Martyn Russell  <mr@gnome.org>

	* src/gossip-session.[ch]:
	* src/gossip-protocol.[ch]:
	- Change the parameters for registering to use a GossipAccount,
	this way each protocol can independently use whatever details that
	are required from that interface instead of trying to generically
	have a common interface here. 
	* src/gossip-register.c:
	- Fix bug where the data is not passed as user_data resulting in a
	NULL dereference in the async call back. 
	* src/gossip-jabber.c (jabber_register),
	(jabber_register_connection_open_cb),
	(jabber_register_error_to_str) (jabber_register_message_handler):
	- Added the capability to register new users.  This opens a new
	connection independent of any connection already open.

2005-01-21  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-contact-info.[ch]:
	- Objectified
	- Don't crash if closed before callbacks.
	* src/gossip-jabber-helper.c:
	(jabber_helper_async_get_version_cb):
	- GOSSIP_ASYNC_OK when actually ok.
	(gossip_jabber_helper_async_get_version):
	- Include resource when asking for version. 
	* src/gossip-jabber.c:
	- Support replying to version requests.
	* src/gossip-version-info.c: 
	- Fixed a bunch of issues.
	- Fixes bug #162620

2005-01-20  Mikael Hallendal  <micke@imendio.com>

	* src/*.[ch]: Updated Imendio HB -> Imendio AB.

2005-01-20  Martyn Russell  <mr@gnome.org>

	* src/gossip-spell-dialog.c:
	- Added to present a list of suggestions.
	* configure.in:
	- Added checks for aspell, Gossip does not depend on it.
	* src/gossip-spell.c:
	- Added code to call use aspell library and provide generic API
	  for the GossipChat object to use.
	* src/gossip-chat.c:
	- Added menu items to the context menu of the input textview to
	  list suggestions for misspelled words.
	* src/gossip-preferences.c:
	- Added ability to disable spell checking.
	- Fixes bug #127338

2005-01-20  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_complete_name_response_cb):
	- Create temporary contact if contact doesn't exist. 
	- Fixes a bunch of bugs regarding sending messages to contacts not in
	  list.
	* src/gossip-contact-info.c:
	- Fixed a crash.
	* src/gossip-jabber-helper.c: (jabber_helper_async_get_vcard_cb):
	- Support <email><userid/></email> for email in vcard.
	* src/gossip-vcard.c:
	- support unsetting values.
	* ui/main.glade: 
	- Make labels selectable in contact info
	- Fixes bug #156108

2005-01-19  Mikael Hallendal,,,  <micke@imendio.com>

	reviewed by: <delete if not using a buddy>

	* src/gossip-app.c: (app_new_message_presence_data_func),
	(app_complete_name_response_cb):
	* src/gossip-private-chat.c: (private_chat_get_status_pixbuf):

2005-01-19  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-jabber.c: (gossip_jabber_init), (jabber_logout),
	(jabber_disconnect_func):
	(jabber_signal_logged_out):
	- Refactor some and signal disconnect on disconnect message from 
	  loudmouth.
	* src/gossip-session.c: (session_protocol_logged_out):
	- Signal disconnected always on protocol disconnected for now, we 
	  only have support for one protocol at this point.

2005-01-19  Martyn Russell  <mr@gnome.org>

	* src/gossip-contact-list.c: 
	- Update the messaging to make it more consistent with other
	  modules (namely GossipSession). 
	* src/gossip-jabber.c (jabber_logout): 
	- Clean up roster when disconnected.
	- Signal logged out when we have called lm_connection_close.
	- Fixes bug #164255

2005-01-16  Martyn Russell  <mr@gnome.org>

	* src/gossip-cell-renderer-text.c (cell_renderer_text_update_text): 
	- Added some of the old code to show the roster with italic grey
	text for the status'.
	- Silently accept setting the Status or Name to NULL.
	* src/gossip-contact-list.c (contact_list_add_contact): 
	- Added groups support.
	- Updated the contact_find function to return a GList of iterators
	which can be used to remove contacts, etc if they are in more than
	one group.
	* src/gossip-jabber.c (jabber_update_contact), (jabber_iq_handler):  
	- Do not dup the strings before setting a contacts groups.
	- Set groups on roster setting.
	* src/gossip-contact.c (gossip_contact_set_groups): 
	- Implemented this function.

2005-01-11  Mikael Hallendal  <micke@imendio.com>

	* autogen.sh: Match correctly whether to run autoheader or not.

2005-01-08  Mikael Hallendal  <micke@imendio.com>

	* acinclude.m4:
	* autogen.sh:
	* configure.in:
	* src/Makefile.am:
	* src/gossip-about.c: (gossip_about_new):
	* src/gossip-main.c: (main):
	- Updated to automake 1.9
	- Patch from Julio M. Merino Vidal
	- Fixes bug #152241

2005-01-03  Martyn Russell  <mr@gnome.org>

	* src/gossip-transport-accounts.c: 
	- Updated to reflect the new GError pointer returned for disco
	items. 
	* src/gossip-transport-add-window.c: 
	- If we get a 404 Not Found when initiating service discovery, we
	now look to 3rd party servers for transport support instead of
	doing nothing.
	- JEP 0070 now allows registering without a "key" xml element,
	legacy services still require it so we use it when available. 
	* src/gossip-transport-discover.c: 
	- Add error checking, this is vital to know if the local server
	supports service discovery.

2005-01-03  Mikael Hallendal  <micke@imendio.com>

	* src/Makefile.am:
	* src/gossip-chat-view.c: (chat_view_maybe_append_timestamp),
	(gossip_chat_view_append_chat_message),
	(gossip_chat_view_append_event_msg):
	* src/gossip-chat-view.h:
	* src/gossip-jabber-chatrooms.c:
	(jabber_chatrooms_message_handler):
	* src/gossip-jabber-helper.c:
	(gossip_jabber_helper_get_timestamp_from_lm_message):
	* src/gossip-jabber-helper.h:
	* src/gossip-jabber.c: (jabber_message_handler):
	* src/gossip-log.c: (log_get_timestamp):
	* src/gossip-message.c: (message_class_init), (message_init),
	(gossip_message_get_timestamp), (gossip_message_set_timestamp):
	* src/gossip-message.h:
	* src/gossip-private-chat.c: (private_chat_send):
	* src/gossip-time.c: (time_set_tz_utc), (time_reset_tz),
	(gossip_time_from_tm), (gossip_time_to_tm),
	(gossip_time_get_current), (gossip_time_to_timestamp),
	(gossip_time_to_timestamp_full):
	* src/gossip-time.h:
	* src/gossip-utils.c:
	* src/gossip-utils.h:
	- Reshuffled code for time stamp handling
	- Added gossip-time.[ch] for utility functions regarding gossip times.
	- Readd timestamps to chats.
	- Fixes bug #162563

2005-01-02  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-jabber.c: (gossip_jabber_init):
	- Set own contact name
	* src/gossip-session.c: (gossip_session_get_nickname):
	- Get name from JID as we used to do.
	- Fixes bug #162564

2004-12-31  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-jabber.c: (jabber_presence_handler):
	- Handle contacts going offline correctly.

2004-12-31  Martyn Russell  <mr@gnome.org>

	* src/gossip-protocol.c: 
	- Added subscribe-request signal.
	* src/gossip-transport-register.c:
	- Added 'cancel' functions to stop registering, unregistering and
	requesting requirements for registering.
	* src/gossip-transport-add-window.c: 
	- Fixed the bug where the add transport window is closed before
	the requirements have returned, and the now invalid window is
	dereferenced.  
	* src/gossip-transport-discover.c: 
	- Made the disco timeout for the initial request 20 seconds
	instead of 30 seconds which seems too long. 
	* src/gossip-transport-accounts-window.c:
	- Moved subscription gui out of the GossipJabber module and into
	this module instead.

2004-12-31  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-contact-list.c: (contact_list_contact_added_cb),
	(contact_list_contact_presence_updated_cb),
	(contact_list_contact_removed_cb), (contact_list_add_contact),
	(contact_list_remove_contact):
	- Added support to hide/show offline contacts.

2004-12-31  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_new_message):
	- Updated for new GossipSession API.
	* src/gossip-contact-list.c:
	(gossip_contact_list_set_show_offline):
	- Started working on this.
	* src/gossip-session.[ch]: (gossip_session_get_contacts):
	- Returns a const list, also replaced internally with a list instead of 
	  a hash table for now.
	* src/gossip-transport-accounts.c:
	(gossip_transport_account_count_contacts),
	(gossip_transport_account_remove):
	- Updated for new GossipSession API.

2004-12-30  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-jabber.c: (gossip_jabber_init):
	- Work when JID-host isn't the same as connection server.

2004-12-30  Mikael Hallendal  <micke@imendio.com>

	* configure.in:
	* gossip.desktop.in: 
	- Removed again, had forgotten the patch from Christoffer Olsen 
	* src/gossip-jabber.c: (jabber_iq_handler):
	- Readded my patch to not reply to error messages. 

2004-12-30  Mikael Hallendal  <micke@imendio.com>

	* AUTHORS: Added Martyn
	* configure.in:
	* protocols/aim.protocol:
	* protocols/gossip-protocol.dtd:
	* protocols/icq.protocol:
	* protocols/msn.protocol:
	* protocols/yahoo.protocol:
	* src/Makefile.am:
	* src/gossip-account.c: 
	* src/gossip-add-contact.[ch]: 
	* src/gossip-app.[ch]: 
	* src/gossip-async.h: New file
	* src/gossip-cell-renderer-text.[ch]: New files
	* src/gossip-chat-manager.[ch]: New files
	* src/gossip-chat-view.c: 
	* src/gossip-chat-window.[ch]: 
	* src/gossip-chat.[ch]: 
	* src/gossip-chatroom-provider.[ch]: New files
	* src/gossip-contact-info.[ch]:
	* src/gossip-contact-list-iface.[ch]: New files
	* src/gossip-contact-list.[ch]:
	* src/gossip-contact.[ch]: 
	* src/gossip-disco-servers.[ch]:
	* src/gossip-disco-window.c: 
	* src/gossip-disco.[ch]:
	* src/gossip-edit-groups-dialog.[ch]:
	* src/gossip-event-manager.[ch]: New files
	* src/gossip-event.[ch]: New files
	* src/gossip-favorites-dialog.[ch]: 
	* src/gossip-group-chat.[ch]: 
	* src/gossip-jabber-chatrooms.[ch]: New files
	* src/gossip-jabber-helper.[ch]:
	* src/gossip-jabber.[ch]:
	* src/gossip-join-dialog.c: 
	* src/gossip-log.[ch]: 
	* src/gossip-message.[ch]: New files
	* src/gossip-presence.[ch]: 
	* src/gossip-private-chat.[ch]: 
	* src/gossip-protocol.[ch]: New files
	* src/gossip-register.c: 
	* src/gossip-session.[ch]: 
	* src/gossip-sound.c: 
	* src/gossip-stock.h:
	* src/gossip-transport-accounts-window.[ch]: New files
	* src/gossip-transport-accounts.[ch]: New files
	* src/gossip-transport-add-window.[ch]: New files
	* src/gossip-transport-discover.[ch]: New files
	* src/gossip-transport-protocol.[ch]: New files
	* src/gossip-transport-register.[ch]: New files
	* src/gossip-tray.[ch]: New files
	* src/gossip-utils.[ch]: New files
	* src/gossip-vcard-dialog.c: 
	* src/gossip-vcard.[ch]: New files
	* src/gossip-version-info.[ch]: New files
	* ui/main.glade:
	- Major branch of both gossip-session-rewrite and gossip-transports.
	- This code is still very young and a lot of know regressions and bugs
	  but we will focus on fixing these during the development phase of
	  Gossip 0.9.

2004-12-27  Mikael Hallendal  <micke@imendio.com>

	* Release 0.8
	
	* NEWS: Updated for 0.8
	* configure.in: Bumped to 0.8
	* ui/main.glade: Disable service discovery for release

2004-12-10  Alexander Shopov  <ash@contact.bg>

	* configure.in (ALL_LINGUAS): Added "bg" (Bulgarian

2004-11-25  Christoffer Olsen  <co@deworks.net>

	* configure.in: Added gossip.desktop.in.in to AC_OUTPUT
	* gossip.desktop.in: Moved to gossip.desktop.in.in
	* gossip.desktop.in.in: Added X-GNOME-Bugzilla-Version header
	* po/POTFILES.in: Now lists gossip.desktop.in.in instead

	- Added support for Bug Buddy version number autocompletion

2004-11-18  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_init), (app_show_offline_cb):
	- Use the correct gconf key

2004-11-16  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_iq_handler): Don't reply to error messages.

2004-09-28  Abel Cheung  <maddog@linuxhall.org>

	* configure.in: Added "tr" to ALL_LINGUAS.

2004-09-18  Martyn Russell  <mr@gnome.org>

	* src/gossip-disco.c:
	- Added a function to get the number of disco items in total.
	* src/gossip-disco-register.c: 
	- Fixed some memory leaks where things were not being cleaned up.
	- Improved the debugging.
	* src/gossip-disco-window.c: 
	- Fixed calculations with progress bar. 
	- Removed code that uses the jabber.org list for disco requests.
	- Fixed the server label under the expander so it has a value.
	- Added a limit to the number of servers used from the protocol
	files, currently this is 5.
	- Was calling the registration requirements function twice.
	- Re-worked the cell pixbuf function to use the gnome images for
	AIM, ICQ, MSN and Yahoo via the GtkIconTheme API.
	* src/gossip-stock.c: 
	- Removed AIM, ICQ, MSN, Yahoo stock definitions.
	* protocols/Makefile.am: 
	- Removed PNG files.
	* protocols/aim.protocol: 
	* protocols/icq.protocol: 
	* protocols/msn.protocol: 
	* protocols/yahoo.protocol: 
	- Changed the stock-icon to be the gnome theme icon filename. This
	is slightly redundent because we don't use stock-icon or icon for
	core protocols. It should be possible to overide this, but
	currently you can't. 
	
2004-09-18  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Add «nb» to ALL_LINGUAS.

2004-09-16  Martyn Russell  <mr@gnome.org>

	* protocols/Makefile.am (stock_DATA): 
	- Quick fix to stop the pixbuf loading warnings.  This occurs
	because the stock images are in a different location to the
	protocol stock images. 

2004-09-16  Martyn Russell  <ginxd@btopenworld.com>

	* src/gossip-group-chat.c 
	* src/gossip-chat-window.c:
	* src/gossip-chat.c:
	- Group chats and normal chats now appear in their own windows
	  instead of sometimes appearing together in separate tabs. 

2004-09-16  Martyn Russell  <ginxd@btopenworld.com>

	* Makefile.am (SUBDIRS): 
	- Added new protocols directory into the mix.
	* protocols/Makefile.am (image_DATA): 
	- Added AIM/ICQ/MSN/Yahoo images into the build.
	- Added the DTD from Paul van Tilburg (v0.4).
	* src/Makefile.am (INCLUDES): 
	- Added a PROTOCOLSDIR definition.
	* src/gossip-disco-servers.c:
	- Added these functions to deal with the XML protocol files which
	  will be installed into <prefix>/share/gossip/protocols or
	  <homedir>/.gnome2/Gossip/protocols.  These XML files are now used 
	  instead of the server list from jabber.org.
	* src/gossip-disco-window.c:
	- Added a message for when all discos have returned and there is
	  nothing more to do.
	- Added a progress bar for the user to have some feed back.
	* src/gossip-disco-window.c:
	- Changed the option buttons for the protocols to a list
	* src/gossip-stock.c: 
	- Added AIM/ICQ/MSN/Yahoo stock items.

2004-09-15  Mikael Hallendal  <micke@imendio.com>

	* gossip.desktop.in: Updated name
	* ui/main.glade: Changed window title

2004-09-11  Martyn Russell  <ginxd@btopenworld.com>

	* src/gossip-chat.c (gossip_chat_present): 
	- Use the ONE chat window already open if there is one.
	* src/gossip-chat-window.[ch] (gossip_chat_window_get_default): 
	- Added this function to return the default window if only one
 	  window is in the chat window list.  If there is more than one
	  window, there is no default.

2004-09-06  Geert-Jan Van den Bogaerde  <geertjan@gnome.org>

	* src/gossip-private-chat.c: Added
	* src/gossip-private-chat.h: Added
	* src/gossip-chat.c:
	* src/gossip-chat.h:
	* src/gossip-group-chat.c:
	* src/gossip-group-chat.h:
	* src/gossip-chat-window.c:
	* src/gossip-app.c:
	- Implemented tabbed group chat windows. GossipChat is now an abstract
 	base class for GossipPrivateChat and GossipGroupChat.

2004-09-04  Martyn Russell  <ginxd@btopenworld.com>

	* src/gossip-roster-view.c (roster_view_item_active_cb): 
	- Fixed bug #151737 which kept contacts highlighted when they go
	offline but only when the preference "showing offline contacts"
	was used. 

2004-09-02  Mikael Hallendal  <micke@imendio.com>

	* Release 0.7.8
	
	* configure.in: Bumped to 0.7.8
	* NEWS: Updated for 0.7.8

2004-09-02  Ross Burton  <ross@burtonini.com>
 
	* ui/connect.glade: Add a Use Proxy check button.
	* src/gossip-account.[ch]: Add a use_proxy field.
	* src/gossip-account-dialog.c: Set the use_proxy field in the account.
	* src/gossip-startup-druid.c: Default to not using the proxy.
	* src/gossip-app.c: Configure the proxy on reconnect, not once.

2004-08-31  Richard Hult  <richard@imendio.com>

	* ui/main.glade: Fix two typos.

2004-08-28  Mikael Hallendal  <micke@imendio.com>

	* src/eggtrayicon.[ch]: 
	- Synced with libegg.
	* src/gossip-disco.c: Some style tweaking.
	* ui/main.glade: Renabled transport item.

2004-08-27  Mikael Hallendal  <micke@imendio.com>

	* Release 0.7.7
	
	* src/gossip-app.c: (app_main_window_destroy_cb):
	- Compile fix for update in Loudmouth

2004-08-27  Mikael Hallendal  <micke@imendio.com>

	* NEWS: Updated for 0.7.7
	* configure.in: Bumped the version to 0.7.7
	* ui/main.glade:
	- Disable the unfinished transport support for the release.

2004-08-25  Mikael Hallendal  <micke@imendio.com>

	* configure.in: 
	- Removed 'ga' translation since the po-file was missed in commit.
	* src/gossip-app.c: (app_create_connection):
	- Set a keep alive rate of 30 seconds for the loudmouth connection.

2004-08-24 Alastair McKinstry <mckinstry@debian.org>

	* configure.in: Added 'ga' (Irish) to ALL_LINGUAS

2004-08-22  Martyn Russell  <ginxd@btopenworld.com>

	* src/gossip-roster-view.c (roster_view_pixbuf_cell_data_func),
	(roster_view_name_cell_data_func),  
	(roster_view_item_active_cb),
	(roster_view_item_presence_updated), (roster_view_connected_cb),
	(roster_view_show_active_users_cb),
	(roster_view_set_cell_background): 
 	- Added a background colour to contacts when they are in an
	"active" state (set by the gossip_roster_item_set_active
	function) to show what has changed on the roster for 5 seconds or
	so. 
	- Make sure the active user background is not done when we change
	between showing offline contacts and during the first 5 seconds
	(after the connection is successful).
	* src/gossip-roster.c (gossip_roster_item_set_flash_stock),
	(gossip_roster_item_get_flash_stock),
	- Added the ability to associate the flash stock icon used with a
	roster item. 

2004-08-19  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-dbus.c: (gossip_dbus_init):
	* src/gossip-dbus.h:
	- Patch from Sjoerd Simons to compile against D-BUS 0.22
	* configure.in: Bumped D-BUS requirement to be 0.22

2004-08-18  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-disco-register.c: (disco_register_new),
	(disco_register_request), (disco_register_message_handler),
	(disco_register_handle_response):
	* src/gossip-disco-window.c: (disco_window_check_others_1_cb),
	(disco_window_register), (disco_window_register_1_cb),
	(disco_window_register_2_cb), (disco_window_entry_details_changed):
	* src/gossip-disco.c: (disco_new), (gossip_disco_request),
	(disco_request_items), (disco_message_handler),
	(disco_request_info), (disco_handle_info),
	(gossip_disco_get_category), (gossip_disco_get_category_and_type),
	(gossip_disco_get_item), (gossip_disco_item_has_category),
	(gossip_disco_item_has_type), (gossip_disco_item_has_feature):
	- Style fixes

2004-08-18  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-disco-servers.c:
	(gossip_disco_servers_fetch): Don't need to call gnome_vfs_init here.
	(disco_servers_print_error), (disco_servers_parse):
	- Fixed style

2004-08-18  Martyn Russell  <ginxd@btopenworld.com>
 
	* src/gossip-disco.c:
	* src/gossip-disco-register.c:
 	- Added these modules to handle the back end of discovering
 	  services and registering them.
	* src/gossip-disco-servers.c:
 	- Added this module to handle the look up of the
 	  http://www.jabber.org/servers.xml and to parse it. It makes use of 
 	  GnomeVFS.
	* src/gossip-disco-window.c:
 	- Added for my test harness of the gossip-disco module.  This is a
   	  simple wizard that registers transports.
	(gossip_jid_is_service): 
 	- Added to check each roster item and see if it is a service or a
 	  contact.  We need this so we can test to see if we are registered
  	  or not with JID's on the roster.
	
2004-08-13  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-jid.c: (jid_free), (jid_locate_resource),
	(gossip_jid_new), (gossip_jid_set_without_resource),
	(gossip_jid_set_resource):
	- Fix some weirdness noticed by richard

2004-08-09  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (gossip_app_connect), (app_create_connection):
	- Updated to the lm_connection_set_jid API.

2004-08-08  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-jid.c: Fixed some bugs when resource wasn't set. 

2004-08-08  Mikael Hallendal  <micke@imendio.com>

	* configure.in: Bumped loudmouth requirement to 0.17
	* src/gossip-app.c: (gossip_app_connect), (app_create_connection):
	- Set the host to connect to.
	* src/gossip-jid.[ch]:
	(gossip_jid_get_part_host): Added
	- Allow connecting to another host than the host part of the jid.

2004-08-08  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_create_connection):
	* src/gossip-register.c: (gossip_register_account):
	- Set proxy if user has set HTTP proxy in GNOME.
	* src/gossip-utils.[ch]: (gossip_utils_set_proxy):
	- Added, reads GConf settings for desktop settings to see if user
	  specified a HTTP proxy.

2004-08-08  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-account-dialog.c:
	* src/gossip-account.[ch]: 
	* src/gossip-app.c:
	* src/gossip-chat.c: 
	* src/gossip-connect-dialog.c: 
	* src/gossip-jid.[ch]: 
	(gossip_jid_set_without_resource): Added
	(gossip_jid_set_resource): Added
	* src/gossip-log.c: 
	* src/gossip-register.c: 
	* src/gossip-startup-druid.c:
	* ui/connect.glade:
	- Started work to support having a different server set than the one
	  in the JID. Needed to be able to tunnel Gossip traffic through for
	  example an SSH tunnel and to be able to connect when the server part
	  of your jid isn't the same as the DNS name of that server.

2004-08-08  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-window.c: (chat_window_create_label):
	- Don't set static width on tabs.

2004-07-29  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat.c: (chat_input_key_press_event_cb):
	* src/gossip-group-chat.c: (group_chat_key_press_event_cb):
	- Fix the enter for input method.

2004-07-29  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat.c: (chat_input_key_press_event_cb):
	- Propagate enter to the input method, kinput2 uses it to submit 
	  letters.
	- See http://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=104299

2004-07-29  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-presence.c: (gossip_presence_get_pixbuf):
	- Modified to handle Offline preferences...

2004-07-29  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-presence.c: (gossip_presence_get_pixbuf):
	- Cleaned up and moved this function from gossip-utils.

2004-07-29  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-window.c:
	(gossip_chat_window_init),
	(chat_window_close_activate_cb)
	(chat_window_cut_activate_cb):
	- Added code to handle cut.
	* src/gossip-chat.c: (gossip_chat_cut):
	- Cut from the input area if text is selected.
	- Patch from Thomas Reynolds.
	- Fixes bug #145469

2004-07-28  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-roster-view.c:
	- Remove unused parent_class. Fixes bug #147360
	- Patch from Heikki Taurianinen.

2004-07-09  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-contact.c: (gossip_contact_get_name):
	- Set name to be the JID if name is not set. 
	- Should fix bug #145565

2004-07-07  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-about.c: (gossip_about_new):
	* src/gossip-app.c: (app_iq_handler):
	* ui/group-chat.glade:
	* ui/main.glade:
	- Some branding...

2004-07-03  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-utils.c: 
	- Include {} in url regexp. 
	- Patch from Johan Hammar.

2004-07-02  Mikael Hallendal  <micke@imendio.com>

	* src/Makefile.am:
	* src/disclosure-widget.c:
	* src/disclosure-widget.h:
	- Removed the unused disclosure widget.

2004-07-02  Geert-Jan Van den Bogaerde  <geertjan@gnome.org>

	* src/gossip-group-chat.c:
	* ui/group-chat.glade:
	- Make text input field in group chat the same as in regular
	  chat windows (no longer uses the disclosure widget)
	- Fixes bug #136830

2004-06-24  Mikael Hallendal  <micke@imendio.com>

	* Release 0.7.6
	
	* NEWS: Updated for 0.7.6
	* configure.in: Bumped to 0.7.6

2004-06-20  Arafat Medini  <lumina@silverpen.de>

	* ar.po: Added Arabic locale ar to ALL_LINGUAS.

2004-06-17  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-vcard-dialog.c:
	(vcard_dialog_get_vcard): Fixed two strings
	(vcard_dialog_set_vcard): 
	- Shouldn't send to attribute when requesting ones own vCard.
	- Fixed some style

2004-06-16  Martyn Russell  <ginxd@btopenworld.com>

	* src/gossip-vcard-dialog.c: 
	- Added the ability to set personal details (jep-0054)
	* src/Makefile.am (gossip_SOURCES):
	* src/gossip-app.c (app_personal_details_cb):
	- Added gossip-vcard-dialog.[ch]
	* src/gossip-contact-info.h: 
	- Fixed incorrect #ifdef name.

2004-06-16  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c:
	(app_new_message_presence_data_func): Added
	(app_new_message): 
	- Show presence icon in popup list in new message dialog.
	- Fixes bug #133194

2004-06-16  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_new_message): 
	- Use a GtkComboBoxEntry instead of deprecated GtkCombo
	* src/gossip-contact-info.c: 
	(contact_info_update_subscription_ui):
	* ui/main.glade:
	- Set the string from the glade file instead.

2004-06-16  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c:
	- Cleaned out some unused code.
	(app_new_message):
	- This was acidently broken in CVS.
	- Sort names alphabetically in list.
	(app_complete_name_response_cb): 
	- Don't try to start a chat if no contact is selected, prevents crash.
	(app_complete_name_activate_cb):
	* src/gossip-contact.[ch]: 
	(gossip_contact_compare): Make case insensitive
	(gossip_contact_name_compare), 
	(gossip_contact_name_case_compare),
	(gossip_contact_name_case_n_compare): Added
	* src/gossip-jid.[ch]: 
	(gossip_jid_case_compare): Added
	* src/gossip-utils.[ch]: 
	(gossip_utils_str_case_cmp),
	(gossip_utils_str_n_case_cmp): Added

2004-06-16  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_handle_subscription_request):
	- Fixed a string that was a bit jabberish.
	- Fixes bug #120790

2004-06-16  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-contact-info.c:
	- Implemented resubscription if you are not subscribed to the other
	  contact.
	- Patch from Ross Burton
	- Fixes bug #116403
	(contact_info_resubscribe_cb): Added
	(contact_info_update_subscription_ui): Added
	(contact_info_presence_updated_cb): Added
	(gossip_contact_info_new): Setup the new UI.
	* ui/main.glade: Update the UI to include resubscription button.

2004-06-16  Mikael Hallendal  <micke@imendio.com>

	* configure.in: Added dependency on GnomeVFS
	* src/gossip-log.c: (log_get_filename):
	- Store log files as lowercase jid
	- Fixes bug #142821 and bug #143035

2004-06-16  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat.c:
	- Hopefully fixes bug #143797 finally this time.

2004-06-15  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat.c:
	- Automatically resize window after input text view shrinks. 
	- Based on a patch from Lionel Henry
	- Fixes bug #143797

2004-06-15  Geert-Jan Van den Bogaerde  <geertjan@gnome.org>
 
	* src/gossip-chat-window.c: (chat_window_create_label):
 	- Make eventbox used for the toolip invisible.
 	- Fixes bug #143671

2004-06-12  Mikael Hallendal  <micke@imendio.com>

	* gossip.desktop.in: 
	- Added InstantMessaging to categories. 
	- Fixes bug #144299

2004-06-07  Mikael Hallendal  <micke@imendio.com>

	* configure.in: Added Esperanto translation from Brient Hess.

2004-06-05  Geert-Jan Van den Bogaerde  <geertjan@gnome.org>

	* ui/main.glade: 
	- Fix duplicate shortcut in subscription request dialog.
	- Fixes bug #143779.
	  
2004-05-20  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-view.[ch]: 
	(gossip_chat_view_get_selection_bounds): Added
	(gossip_chat_view_copy_clipboard): Added
	* src/gossip-chat-window.c: 
	(gossip_chat_window_init): Connect to copy&paste.
	(chat_window_copy_activate_cb): Added
	(chat_window_paste_activate_cb): Added
	* src/gossip-chat.[ch]: 
	(gossip_chat_copy): Added
	(gossip_chat_paste): Added
	* ui/chat.glade: Added Edit menu to chat windows.
	- Added support for Copy in chat windows.

2004-05-18  Mikael Hallendal  <micke@imendio.com>

	* autogen.sh: Hard code automake 1.7

2004-05-18  Mikael Hallendal  <micke@imendio.com>

	* configure.in: Added ukrainian translation.

2004-05-18  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-jid.c: (gossip_jid_string_is_valid_jid):
	- Allow IP-numbers as JID's
	- Patch from Fabio Bonelli.
	- Fixes bug #135614

2004-05-18  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-window.c:
	(chat_window_create_label),
	(chat_window_update_tooltip):
	- Have tooltip both on label and presence icon in chat window.
	- Append Typing a message to tooltip when the other person is replying.
	- Based on a patch from Fabio Bonelli.
	- Fixes bug #120284

2004-05-18  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-roster-view.c: (gossip_roster_view_flash_contact):
	- Fix a crash

2004-05-11  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-window.c: (chat_window_update_title):
	- Show the new message icon as window icon on chat window when 
	  new message has arrived. Patch from Sergey Dolgopolov.

2004-05-03  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-window.c:
	(gossip_chat_window_init): Setup drag & drop
	(chat_window_drag_data_received): Added.
	* src/gossip-roster-view.c:
	(roster_view_setup_tree): Setup drag & drop
	(roster_view_drag_begin): Added
	(roster_view_drag_data_get): Added
	(roster_view_drag_end): Added
	- Support dragging contacts to chat windows to open chat with them
	- Fixes bug #133864

2004-05-02  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-roster.c (roster_item_update): 
	- Update GossipContact with new name.

2004-05-02  Mikael Hallendal  <micke@imendio.com>

	* configure.in: Require GLib/GTK+ 2.4

2004-05-02  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat.c: 
	* src/gossip-group-chat.c: 
	- First cut at emitting contact_* signals from group chat.
	- Nick name when private chatting with someone in group chat works 
	  again. (Been broken for a long time). Fixes bug #141565

2004-05-02  Mikael Hallendal  <micke@imendio.com>

	* src/Makefile.am:
	- Added gossip-contact-list.[ch]
	* src/gossip-app.c: 
	* src/gossip-chat-window.c: 
	* src/gossip-chat.c: 
	* src/gossip-contact-list.c: 
	* src/gossip-contact.c: 
	* src/gossip-group-chat.c: 
	* src/gossip-presence.c: 
	* src/gossip-roster-view.c:
	* src/gossip-roster.c:
	* src/gossip-utils.c:
	- Start using the new GossipContact/GossipPresence API imported from
	  mp-branch. This will make it much easier to get the group chat stuff 
	  working.
	* src/gossip-jabber.[ch]:
	- Removed left overs
	* src/gossip-session.[ch]:
	- Removed left overs

2004-05-01  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-group-chat.[ch]:
	- Objectified.
	* src/gossip-roster.c: (gossip_roster_item_get_name):
	- Default name to name-part of jid if nickname not set or "".

2004-04-28  Adam Weinberger  <adamw@gnome.org>

	* configure.in: Added en_CA to ALL_LINGUAS.

2004-04-28  Mikael Hallendal  <micke@imendio.com>

	* Released 0.7.5
	
	* NEWS: Updated for 0.7.5

2004-04-28  Mikael Hallendal  <micke@imendio.com>

	* Makefile.am:
	* configure.in: Bumped version number to 0.7.5
	* gossip.spec.in: Removed the spec-file from here.

2004-04-28  Ross Burton  <ross@burtonini.com>

	* src/gossip-register.c:
	- Use SSL when registering if we need to. Closes bug #141273.

2004-04-27  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-register.c: (register_connection_open_cb):
	- Patch from Sjoerd Simons to fix issue when registering against 
	  jabberd2. Fixes bug #141001

2004-04-21  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c (app_new_message): 
	- Don't make dialog text selectable, fixes bug #121056

	* src/gossip-group-chat.c (group_chat_key_press_event_cb):
	- Fix case bug in group chat nick completion. Fixes bug #120876
	  
	* src/gossip-group-chat.c (group_chat_row_activated_cb):
	- Re-enabled support for bringing up private chat with another person
	  in a group chat. Fixes bug #130978
	  
	* src/gossip-chat-view.c (chat_view_check_nick_highlight): Added
	* src/gossip-chat-view.c (gossip_chat_view_append_chat_message):
	- More sophisticated nick highlighting code. 
	- Fixes bug #132634
	  
2004-04-14  Richard Hult  <richard@imendio.com>

	* src/gossip-log.c (gossip_log_message): Handle no or empty
	body. Fixes bug #138443.

2004-04-11  Gareth Owen  <gowen72@yahoo.com>

	* configure.in: Added en_GB to ALL_LINGUAS

2004-04-04  Žygimantas Beručka  <uid0@akl.lt>

	* configure.in: Added "lt" (Lithuanian) to ALL_LINGUAS.

2004-03-30  Gustavo Maciel Dias Vieira  <gdvieira@zaz.com.br>

	* configure.in: Added pt_BR to ALL_LINGUAS.

2004-03-19  Richard Hult  <richard@imendio.com>

	* Release 0.7.4.

	* configure.in: Bump version.

	* src/gossip-about.c: Gah, fix stupid bug.

2004-03-18  Richard Hult  <richard@imendio.com>

	* Release 0.7.3.

2004-03-09  Richard Hult  <richard@imendio.com>

	* src/gossip-log.c (log_transform): Plug leak.

2004-03-04  Richard Hult  <richard@imendio.com>

	* src/gossip-chat.c (gossip_chat_init): Use _connect_object so we
	get disconnected when the data object dies. Fixes a rare crash on
	exit.

2004-03-02  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_idle_check_cb): Fix bug #135944, don't do
	anything if we're not connected.
	(app_disconnect): Stop flashing the status when disconnected.

2004-03-02  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_new_message), (app_new_message_cb),
	(app_popup_new_message_cb):
	- Only make new message dialog transient if activated from roster 
	  window.

2004-03-01  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_authentication_cb): Fix string.
	(app_idle_check_cb): Remove the delay before starting to flash,
	since it was more annoying than helpful.
	(gossip_app_connect): Make this build with debug output enabled.
	(app_status_clear_away): Stop the flashing here.
	(app_tray_flash_timeout_func): ifdef out debug code.
	
	* src/gossip-roster-view.c: (gossip_roster_view_flash_item): Use
	the same timeout as app.

2004-02-27  Martyn Russell  <ginxd@btopenworld.com>
 
 	* src/gossip-join-dialog.c (join_dialog_response_cb): 
 	- Added fix that sends your status when connecting instead of just
 	available.
 
 	* src/gossip-app.c (app_update_show): 
 	- Added fix for bug #128362.  Group Chat now gets status updates.
	
2004-02-26  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_authentication_cb): Show dialog when
	authentication fails. Based on patch from Martyn Russell.
	(app_tray_destroy_cb, app_tray_create): Use the correct signal to
	catch when the tray is removed. Based on patch from Qball Cow.

2004-02-10  Richard Hult  <richard@imendio.com>

	* configure.in: Gah, revert the exslt change and really release.

	* Release 0.7.2.

	* configure.in: Bump version to 0.7.2, add libexslt to pkgconfig
	checks.

	* NEWS: Updated for 0.7.1 and 0.7.2.

2004-02-09  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: Remove debugging defines for leave/back times.

2004-02-07  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_new_message): Grab focus on the entry.
	(app_client_disconnected_cb): Revert the no separator flag since
	you can't set that on message dialogs.

	* src/gossip-chat-view.c (chat_view_is_scrolled_down): Fix version
	check.

	* src/gossip-app.c: Flash the notification area when going to and
	from away. Don't make the status popup transient when invoked from
	the notification icon, fixes bug #133486.

2004-02-07  Richard Hult  <richard@imendio.com>

	* src/gossip-roster-view.c (roster_view_ellipsize_item_string):
	Limit the length of the status text where trying to
	ellipsize. People using a string of 1688 (!) chars made this really 
	slow :).

2004-02-02  Richard Hult  <richard@imendio.com>

	* src/gossip-chat.c: Disable debug spew.

2004-02-02  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat.c: (chat_update_locked_resource),
	(chat_message_handler), (gossip_chat_get_for_item),
	(gossip_chat_get_for_group_chat):
	- Fix so that private chats through group chats works a bit better, 
	  free FOSDEM beer, HERE I COME!!

2004-02-01  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (gossip_app_set_presence): 
	* src/gossip-dbus.c (handle_set_presence): More stuff in the dbus
	interface.

2004-01-31  Richard Hult  <richard@imendio.com>

	* configure.in:
	* src/Makefile.am:
	* src/gossip-app.c: (app_init), (gossip_app_set_away):
	* src/gossip-dbus.c: Add some experimental, optional dbus stuff.

2004-01-30  Richard Hult  <richard@imendio.com>

	* src/gossip-preferences.c (gossip_preferences_show_status_editor): 
	* src/gossip-app.c: (app_client_disconnected_cb): Don't set
	transient, doesn't work since they can both be shown when the
	contact list is on another workspace.
	(app_init): Revert fix for now, see bug #132632.

	* src/gossip-join-dialog.c:
	* src/gossip-preferences.c:
	* ui/main.glade: Add status submenu to the notification area icon
	popup menu, create the menu with glade instead of with code, add a
	few icons, clean up a bit while at it (remove cruft from the pre
	0.3 days).

2004-01-29  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-view.c (chat_view_finalize)
	(gossip_chat_view_append_chat_message): 
	* src/gossip-app.c (app_tray_push_message): Plug leaks.

2004-01-28  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (add_status_image_menu_item): 
	* src/gossip-log.c (log_get_filename): Plug leaks.

2004-01-27  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-window.c (chat_window_tab_detached_cb): When
	detaching a tab, put the new window at the pointer.

	* src/gossip-log.c (log_urlify): Escape the href value.

	* src/gossip-log.xsl: Disable output escaping for the href
	value.

2004-01-26  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_authentication_cb):
	(app_setup_conn_dependent_menu_items): Handle the sensitivity of
	the status button automatically instead.

2004-01-26  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_finalize),
	(app_idle_check_cb),
	(app_update_show), (app_status_clear_away),
	(app_status_flash_timeout_func), (app_status_flash_start),
	(app_status_flash_stop), (gossip_app_status_force_nonaway),
	(app_status_available_activate_cb), (app_status_busy_activate_cb),
	(app_status_away_activate_cb), (app_status_show_status_dialog):
	Make the status icon flash when going from and to away state, and
	add some slack so we don't go immediately to available status on
	activity.
	(app_tray_destroy_event_cb): Only show the window if the tray was
	removed.

	* src/gossip-app.c: (app_update_show): Set the label for the
	status button to Offline when we're offline.
	
	* src/gossip-idle.c: (gossip_idle_get_seconds),
	(gossip_idle_reset): Sanitize, and make it possible to read out
	non-idletime as well.

	* configure.in: Bail out if XSS isn't found, we are really
	depending on it, things don't work at all without it.

2004-01-25  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_authentication_cb): Only make the status
	button sensitive when auth succeeds.

2004-01-24  Richard Hult  <richard@imendio.com>

	* src/gossip-chat.c (chat_input_key_press_event_cb): Do nothing on
	ctrl-enter, insert newline for shift-enter, and send on enter.

	* src/gossip-app.c (app_init): 
	* src/gossip-idle.c (gossip_idle_get_seconds): Lower the autoback
	time to 15 seconds.

	* src/gossip-app.c (app_toggle_visibility, app_is_visible)
	(app_tray_button_press_cb): Show the contact list if it's visible
	but on another workspace. Fixes bug #127208.

	* src/gossip-chat-view.c (chat_view_size_allocate): Scroll down
	the window if it was scrolled down before we resized. Fixes bug
	#128011.
	(chat_view_finalize): Chain up.
	
	* src/gossip-utils.c: (gossip_utils_url_regex_match): Move here
	from chat view.

	* src/gossip-log.xsl:
	* src/gossip-chat-view.c: (gossip_chat_view_append_chat_message):
	* src/gossip-log.c: (log_urlify), (gossip_log_message): And use it
	here, make links clickable. Fixes bug #127156.

2004-01-23  Richard Hult  <richard@imendio.com>

	* ui/main.glade: Don't expand the buttons, fixes bug #132310.

	* src/gossip-chat-window.c (chat_window_tab_added_cb): Scroll the
	textview all the way down.

	* src/gossip-chat.c (gossip_chat_scroll_down): Add.

	* src/gossip-chat-view.c (gossip_chat_view_scroll_down): Refactor.
	(gossip_chat_view_append_chat_message) 
	(gossip_chat_view_append_event_msg): Use the above.

	* src/gossip-main.c (setup_default_window_icon): 
	* ui/chat.glade: Use the logo instead. Fixes bug #125663.

	* src/gossip-app.c (app_init, app_have_tray): Only hide window if
	there is a notification area.
	(app_init): Don't let the window be too narrow.

	* gossip.schemas.in: Add short/long description to
	preset_messages, get rid of warning.

2004-01-22  Richard Hult  <richard@imendio.com>

	* Release 0.7.1.

	* gossip.schemas.in: Remove unused schemas, remove duplicate
	entry, fix y position entry, add preset status messages.

	* configure.in: AC_SUBST the libxml and libxslt version
	requirement variables.

	* src/gossip-app.c (app_idle_check_cb): Reset away message when we
	get auto-back.

2004-01-21  Richard Hult  <richard@imendio.com>

	* Release 0.7.

2004-01-21  Richard Hult  <richard@imendio.com>

	* NEWS: Add updated translations.
	Update some more.

2004-01-21  Mikael Hallendal  <micke@imendio.com>

	* NEWS:
	- Updated for 0.7
	* configure.in:
	- Bumped version to 0.7
	- Updated Loudmouth deps to 0.15

2004-01-21  Richard Hult  <richard@imendio.com>

	* gossip.spec.in (BuildRequires): Add missing file.

	* ui/main.glade: Resave with an older glade so we don't get
	warnings when running with an older gtk+.

	* src/gossip-app.c: 
	* ui/main.glade: Use dialog instead of weird entry for setting
	status.

2004-01-20  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_status_popup_show): Make the popup as wide
	as the button.

	* src/gossip-edit-groups-dialog.c (edit_groups_set):.
	* src/gossip-roster-view.c (roster_view_group_menu_rename_cb):
	(roster_view_add_item):
	* src/gossip-roster.c: (gossip_roster_rename_item),
	(gossip_roster_rename_group):
	* src/gossip-contact-info.c (gossip_contact_info_new): Escape the
	name. Fixes bug #131960.

2004-01-19  Richard Hult  <richard@imendio.com>

	* src/gossip-edit-groups-dialog.c (gossip_edit_groups_new): Escape
	the name.

	* src/gossip-app.c: (gossip_app_status_force_nonaway),
	(app_status_available_activate_cb), (app_status_busy_activate_cb):
	Fix silly bug when going from away manually.
	(app_status_button_clicked_cb): Popup on clicked as well to get
	keyboard nav working.

2004-01-19  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (gossip_app_status_force_nonaway):
	* src/gossip-chat.c: (chat_send):
	* src/gossip-group-chat.c: (group_chat_send): Return from away
	status when we send something.

	* src/gossip-preferences.c: Fix style.
	* ui/main.glade: Tweak.

2004-01-19  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-window.c (chat_window_update_tooltip): Remove
	the "Status:" from the tooltip.

	* src/gossip-app.c: (app_authentication_cb),
	(app_client_disconnected_cb): Make the presence button sensitive
	only when we're connected.

	(app_status_entry_timeout_cb),
	(app_status_show_status_entry), (app_status_hide_status_entry),
	(app_status_entry_set_from_entry), (app_status_entry_activate_cb),
	(app_status_entry_key_press_event_cb): Hide the entry if it's not
	touched.
	
	* src/gossip-preferences.c: (status_add_clicked_cb),
	(status_entry_changed_cb), (status_entry_activate_cb),
	(gossip_preferences_show_status_editor):
	* ui/main.glade: Tweak the editor some more.

2004-01-19  Richard Hult  <richard@imendio.com>

	* src/gossip-preferences.c: (status_add_clicked_cb),
	(status_entry_changed_cb), (status_entry_activate_cb),
	(gossip_preferences_show_status_editor):
	* ui/main.glade: Tweak the presence editor.

2004-01-19  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c:
	* src/gossip-idle.c:
	* src/gossip-preferences.c:
	* src/gossip-utils.c:
	* ui/main.glade: Lots of changes. Implement editing of the new
	status strings, support them in the popup, fix explicit away, and
	fix a few bugs when entering custom messages.

2004-01-18  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: Implement the new presence stuff.

	* src/gossip-chat-window.c: (chat_window_update_tooltip): Fix.

	* src/gossip-utils.c: (gossip_utils_get_stock_from_show): Add.
	(gossip_utils_get_pixbuf_from_show): Use the above.

	* ui/main.glade: Tweak the presence entry.

2004-01-18  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_init),
	(app_status_available_activate_cb):
	* src/gossip-utils.c: (gossip_option_image_menu_setup):
	* src/gossip-utils.h:
	* ui/main.glade: Prepare to implement the new presence design.
	
	* src/gossip-chat-window.c: (gossip_chat_window_init),
	(chat_window_create_label), (chat_window_presence_updated_cb),
	(chat_window_update_tooltip):
	* src/gossip-chat.c: (chat_create_gui): Add a tooltip on the name
	label with the jid and status.

2004-01-17  Richard Hult  <richard@imendio.com>

	* src/gossip-roster-view.c (roster_view_add_item): Expand groups
	by default, fixes bug #130979.

	* src/gossip-edit-groups-dialog.c: Clean up, namespace functions,
	remove unecessary casts, don't set treeview properties with
	code. Add support for applying and reverting changes. Don't
	display both the name AND jid if they are the same. Don't mark
	markup as translatable. Make the add entry activate the add
	button.

	* src/gossip-roster.c: (roster_group_remove): Remove empty groups.

	* ui/main.glade: Add apply and cancel buttons to the group edit
	dialog since it's not instant apply.

2004-01-17  Richard Hult  <richard@imendio.com>

	* src/gossip-idle.c: (gossip_idle_get_seconds),
	(gossip_idle_reset):
	* src/gossip-idle.h:
	* src/gossip-app.c: (app_init), (app_idle_check_cb),
	(app_status_available_activate_cb): Don't return from away until
	30 seconds of non-idleness. Make it possible to return manually
	quicker.
	
	* ui/main.glade: 
	* src/gossip-edit-groups-dialog.c: (groups_setup),
	(groups_populate_columns), (groups_save), (groups_add_groups),
	(groups_find_name_foreach), (groups_find_selected_foreach),
	(groups_cell_toggled), (add_entry_changed), (add_button_clicked):
	Tweak style.

	* src/gossip-roster-view.c: (roster_view_item_updated): Stop
	looping if there are no more items.

2004-01-15  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-account-dialog.c:
	* src/gossip-app.c: 
	- updated for new SSL API in Loudmouth

2004-01-14  Richard Hult  <richard@imendio.com>

	* src/gossip-edit-groups-dialog.c (groups_add_groups): Compare
	with the translated unsorted string.

2004-01-13  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_about_cb): 
	- Added an Artwork by line with Daniel Taylor.

2004-01-13  Mikael Hallendal  <micke@imendio.com>

	* ui/main.glade: Ctrl-N for sending new messages from main menu. Also
	  changed the message text.

2004-01-13  Martyn Russell  <ginxd@btopenworld.com>

	* src/gossip-edit-groups-dialog.c: 
	- New module for editing groups.

2004-01-12  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_about_cb): Updated gossip page url.

2004-01-11  Richard Hult  <richard@imendio.com>

	* src/gossip-roster-view.c: (roster_view_item_added),
	(roster_view_item_updated), (roster_view_item_presence_updated),
	(roster_view_item_removed), (roster_view_group_added),
	(roster_view_pixbuf_cell_data_func), (roster_view_add_item),
	(roster_view_remove_item_with_iter), (roster_view_remove_item),
	(gossip_roster_view_new): Don't show empty groups.

2004-01-09  Richard Hult  <richard@imendio.com>

	* ui/pixmaps: Add large gossip logo.

	* src/gossip-app.c (app_about_cb): Spiffy about box.

	* src/gossip-chat.c (chat_message_handler): Move sound handling here...

	* src/gossip-chat-window.c (chat_window_new_message_cb): ...from
	here. Fixes #130991.

2004-01-08  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_status_custom_available_activate_cb)
	(app_status_custom_busy_activate_cb): Set the status message to
	the current string. Patch from Krzysztof Luks and Thomas
	Reynolds. Fixes bug #129264.

	* src/gossip-log.c (gossip_log_message): Do log messages from
	contacts not in the roster.

	* ui/main.glade: Don't ploink and schwosh (don't show the window
	until we've set the checkbuttons, gets rid of some sound events
	for Ralph).

	* src/gossip-chat.c (gossip_chat_get_for_item): Add create bool
	and only create chat if specified.
	(gossip_chat_get_history): Add.

	* src/gossip-app.c: Adapt to the above change.
	
2004-01-07  Richard Hult  <richard@imendio.com>

	* src/gossip-chat.c: (gossip_chat_finalize): Remove composing
	timeout. We never finalize the windows, but theoretically nice.
	(chat_disconnected_cb): Reset the composing event sending
	variables when we get disconnected.
	(chat_handle_composing_event): Rename from chat_event_handler to
	better reflect its function. Only enable composing events if the
	sending party is online. Should fix bug #127592
	(chat_message_handler): Update for name change.

2004-01-06  Richard Hult  <richard@imendio.com>

	* src/gossip-chat.c (chat_input_key_press_event_cb): Page up/down
	scrolls. Fixes bug #127595.

2004-01-06  Geert-Jan Van den Bogaerde  <gvdbogaerde@pandora.be>

	* src/gossip-chat.c:
	(chat_item_added): Added
	(chat_connected_cb): Added
	(chat_disconnected_cb): Added
	(gossip_chat_init)
	* src/gossip-chat-window.c:
	(chat_window_disconnected_cb): Added
	(gossip_chat_window_init), (gossip_chat_window_finalize),
	(chat_window_get_status_pixbuf):
	- Fixed bug #128010.
	- Show "(Dis)connected" event message in chat view.
	- Show contacts in open chat windows as offline when 
	  disconnected.

2004-01-06  Geert-Jan Van den Bogaerde  <gvdbogaerde@pandora.be>

	* src/gossip-chat-window.c:
	(chat_window_presence_changed_cb): Removed
	(chat_window_presence_updated_cb): Added
	(chat_window_tab_added_cb), (chat_window_tab_removed_cb):
	* src/gossip-chat.c:
	(gossip_chat_class_init), (gossip_chat_init),
	(chat_presence_handler):
	* src/gossip-chat.h:
	- Get rid of PRESENCE_UPDATED signal on GossipChat.

2003-12-28  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (gossip_app_connect):
	- Use the fixed SSL API in Loudmouth

2003-12-21  Mikael Hallendal  <micke@imendio.com>

	* ui/main.glade: 
	- Use stock icons for add and remove in status editor.
	- Patch from Thomas Reynolds
	- Fixes bug #129765

2003-12-20  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-view.c (chat_view_is_scrolled_down): If we've
	scrolled up just a tiny bit (half a page), treat that as if we've
	scrolled down. This makes the scrolling behave nicer with the
	expanding text entry.

2003-12-20  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-view.c:
	(gossip_chat_view_append_chat_message):
	- Don't set highligh if to is NULL (private chat)
	* src/gossip-chat.c:
	(chat_message_handler):
	- Send NULL as 'to', it's obvious that it's to yourself.
	- Fixed bug #126189

2003-12-20  Mike Gratton  <mike@vee.net>

	* src/gossip-preferences.c: 
	(status_busy_dnd_row_deleted_cb): Added
	(status_away_dnd_row_deleted_cb): Added
	(gossip_preferences_show_status_editor): connect to row-deleted 
	  functions
	* ui/main.glade: Set reordable
	- Adds drag-n-drop to the status message lists. 
	- Fixes bug #127206

2003-12-20  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-window.c: 
	(chat_window_create_label): set data on chat, not hbox
	(chat_window_name_changed_cb): Added
	(chat_window_tab_added_cb): Connect to name-changed
	(chat_window_tab_removed_cb): Disconnect from name-changed
	* src/gossip-chat.c:
	(gossip_chat_class_init): Added name-changed signal
	(gossip_chat_init): Listen to item-updated and item-removed
	(chat_item_updated): Added
	(chat_item_removed): Added, not implemented
	- Fixed bug #121254

2003-12-20  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_main_window_destroy_cb):
	- exit instead of quitting main loop

2003-12-19  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_main_window_destroy_cb):
	- Cancel connection if it's in progress.

2003-12-19  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: 
	(app_name_complete_cmp_func): Added, does case insensitive completion.
	(app_send_chat_message): 
	- Use names instead of jid's in the completion and drop down.
	* src/gossip-roster.[ch]: 
	(gossip_roster_find_item): Added, tries to match the string as a JID if
	  it's a valid JID, otherwise does a comparison on the items names.
	- Fixes bug #116786

2003-12-17  Mikael Hallendal  <micke@imendio.com>

	* gossip.schemas.in:
	- Added main_window_hidden, and x,y position of main-window.
	- moved main window width/height keys.
	- Based on patch from Kim Andersen.
	  
	* src/gossip-app.c: 
	(app_init), (app_toggle_visibility), (configure_event_idle_cb):
	- Store the visability state of the main window so that we can start 
	  without showing the roster. Useful when starting from session.
	- Store location of main window and open it in the same place when 
	  restarted.
	- Based on patch from Kim Andersen
	- Fixes bug #121120

2003-12-15  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c:
	(app_connection_ssl_func),
	(gossip_app_connect), 
	(app_create_connection): Updated to compile with the new SSL-API in 
	Loudmouth, please report any problems with the SSL parts.

2003-12-15  Mikael Hallendal  <micke@imendio.com>

	* gossip.desktop.in:  
	* ui/pixmaps/Makefile.am: 
	* ui/pixmaps/gossip.png:
	* ui/svg/gossip.svg: Added new application icon from Dan Taylor.

2003-12-13  Martyn Russell  <ginxd@btopenworld.com>

	* src/gossip-chat.c (chat_input_key_press_event_cb): 
	- Fixes event->state && GDK_CONTROL_MASK to one &.

2003-12-13  Jonatan Magnusson  <barfota@samvetet.lu.se>

	* src/gossip-chat-view.c: 
	(chat_view_url_regex_match): 
	(gossip_chat_view_append_chat_message):
	- Match correctly when two URL's are separated by space. 
	- Fixes bug #126730

2003-12-13  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-view.c: 
	(chat_view_populate_popup),
	(chat_view_clear_view_cb), (gossip_chat_view_clear):
	* src/gossip-chat-view.h:
	* src/gossip-chat-window.c: (gossip_chat_window_init),
	(chat_window_clear_activate_cb), (chat_window_log_activate_cb),
	(chat_window_info_activate_cb):
	* src/gossip-chat.c: (chat_send), (gossip_chat_clear):
	* src/gossip-chat.h:
	* ui/chat.glade:
	- Added a Clear to right click menu in chat windows
	- Added a Conversation->Clear menu item aswell
	- Based on a patch from Jonatan Magnusson
	- Fixes bug #127383

2003-12-13  Martyn Russell  <ginxd@btopenworld.com>
 
	* src/gossip-app.c (app_complete_jid_response_cb): 
	- Handle when the JID is not in the roster
	- Fixes bug 127462 reported by Ralph Meijer.
 
2003-12-13  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_subscription_request_dialog_response_cb):
	- Don't send reply if user chose to ignore it for now
	- Based on patch from Martyn Russel
	- Fixes bug #127461

2003-12-13  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-window.c:
	(gossip_chat_window_init),
	(chat_window_conv_activate_cb): 
	* ui/chat.glade: 
	- moved view log and show contact information to conversation menu and 
	  removed the view menu. 
	- Based on patch from Thomas Reynolds
	- Fixes bug #127569

2003-12-12  Geert-Jan Van den Bogaerde  <gvdbogaerde@pandora.be>

	* src/gossip-chat-window.h:
	* src/gossip-chat-window.c:
	- Remove some declarations left over from when we had both
	tabs and treeview layout.
	- Correct cast in GOSSIP_CHAT_WINDOW_GET_CLASS.

2003-12-12  Geert-Jan Van den Bogaerde  <gvdbogaerde@pandora.be>

	* src/gossip-chat.c: (chat_input_key_press_event_cb):
	- Don't handle ctrl-enter.
	
2003-12-11  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat.c: 
	(chat_create_gui),
	(chat_input_text_view_send), (chat_input_key_press_event_cb):
	* ui/chat.glade:
	- Removed the send button, not needed.

2003-12-11  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat.c: 
	(chat_create_gui), (chat_send_clicked_cb),
	(chat_input_key_press_event_cb),
	(chat_input_text_buffer_changed_cb),
	(chat_text_view_focus_in_event_cb), (gossip_chat_present):
	- Removed the disclosure widget and always use an expanding text view.
	- Fixes bug #127596
	* ui/chat.glade:
	- Removed the entry and disclosure widget.

2003-12-11  Andreas Lööw  <aginor@ludd.luth.se>

	* src/gossip-app.c: (app_tray_button_press_cb):
	- Don't handle double clicks and tripple clicks. 
	- Fixes bug #128730

2003-12-11  Thomas Reynolds  <thomasr@infograph.com>

	* src/gossip-app.c: (app_init), (app_show_offline_key_changed_cb):
	- Listen to show_offline gconf key. Fixes bug #127985

2003-12-11  Iñaki Larrañaga  <dooteo@euskalgnu.org>

	* configure.in: Added "eu" (Basque) to ALL_LINGUAS.

2003-12-10  Richard Hult  <richard@imendio.com>

	* src/gossip-log.c (gossip_log_message): Fix namespace, thanks
	Edd. Fixes bug #128280.

2003-12-08  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_idle_check_cb), (app_update_show),
	(app_leave_flash_stop), (app_cancel_pending_leave): Fix bug that
	appeared with the new idle checking.

2003-12-06  Sjoerd Simons  <sjoerd@luon.net>

	* src/gossip-app.c: (app_idle_check_cb),
	(app_cancel_pending_leave):
	* src/gossip-idle.c: (gossip_idle_get_seconds):
        Let gossip detect how long you have been active, sortof. It
	reports the time in which you have not been idle 3 or more
	seconds.

2003-11-29  Hasbullah Bin Pit <sebol@ikhlas.com>
        
	* configure.in: Added 'ms' (Malay) to ALL_LINGUAS. 

2003-11-24  Mikael Hallendal  <micke@imendio.com>

	* ui/pixmaps/gossip-offline.png:
	* ui/svg/gossip-offline.svg: Updated with new icons from Daniel Taylor.

2003-11-23  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-view.c (chat_view_open_address): Only prepend
	http:// if there is no protocol specified at all. Fixes bug
	#127571.
	(gossip_chat_view_append_chat_message): Try enabling the
	don't-scroll-down thing for recent gtk+ versions.
	(gossip_chat_view_append_event_msg): Add it here too.

	* src/gossip-chat-window.c (chat_window_accel_cb)
	(gossip_chat_window_init): Add Alt-num accels for switching tabs,
	fixes bug #127157.

2003-11-20  Ross Burton  <ross@burtonini.com>

	* src/gossip-chat.c (chat_error_dialog): Don't get the dialog of a
	NULL window.

	* src/gossip-chat-window.c (gossip_chat_window_get_dialog): Sanity
	check the parameter.

2003-11-20  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-group-chat.c: (group_chat_priv_chat_new):
	- build fix for #127350, reported and fixed by Adrian Bunk

2003-11-18  Richard Hult  <richard@imendio.com>

	* Release 0.6.

	* NEWS: Update.

	* configure.in: Bump version, lower requirement of libxml.

	* src/gossip-chat-window.c (chat_window_tab_removed_cb): Update
	sensitivity when removing a tab too.

2003-11-18  Geert-Jan Van den Bogaerde <gvdbogaerde@pandora.be>

	* src/gossip-chat-window.c: (gossip_chat_window_init),
	(chat_window_tabs_reordered_cb): Update menu item sensitivity
	on tabs_reordered.

2003-11-17  Richard Hult  <richard@imendio.com>

	* ui/svg/gossip-busy.svg:
	* ui/svg/gossip-offline.svg: Update to the version we're using
	now.

2003-11-17  Richard Hult  <richard@imendio.com>

	* src/gossip-chat.c: (chat_update_locked_resource), (chat_send),
	(chat_composing_send_start_event), (chat_message_handler),
	(chat_event_handler): Don't relock on error messages, don't send
	typing notification to offline contacts, and don't request typing
	notification from them either. Also handle when we don't get a
	resource, it seems to happen with some transports(?).

2003-11-17  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-window.c: (tab_notebook_size_request_cb),
	(tab_label_size_request_cb), (chat_window_create_label): Set
	minimum size for tab labels, and add some experimental commented
	code for resizing the labels when the window is resized.

	(chat_window_create_notebook): Set scrollable to TRUE.

2003-11-17  Richard Hult  <richard@imendio.com>

	* configure.in: Set Loudmouth requirement to 0.14.1.

	* ui/main.glade: Use a border width of 2 pixels for the main
	window.
	
	* ui/chat.glade:
	* ui/group-chat.glade: Set window icons.
	
	* ui/pixmaps/Makefile.am (image_DATA): Add group chat icon from
	Michael Gratton <mike@vee.net>.

2003-11-17  Frederic Crozat  <fcrozat@mandrakesoft.com>

	* autogen.sh: Handle GNOME2_DIR for aclocal path.

2003-11-17  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-roster-view.c: (gossip_roster_view_flash_item):
	- Always remove from inbox if flash = FALSE.

2003-11-17  Richard Hult  <richard@imendio.com>

	* src/gossip-contact-info.c (gossip_contact_info_new): Don't make
	this one transient.

	* src/gossip-roster-view.c (roster_view_item_menu_remove_cb): Make
	the remove dialog transient.

	* ui/main.glade: Make status editor resizable.
	
	* src/gossip-chat-window.c: (gossip_chat_window_init),
	(chat_window_update_menu),
	(chat_window_view_activate_cb),
	(chat_window_tab_left_activate_cb),
	(chat_window_tab_right_activate_cb),
	(chat_window_create_notebook): Fix tab navigation and menu
	sensitivization. Set log item sensitivity each time we open the
	menu since there might be a log or it might be removed since the
	last time.

	* ui/pixmaps/gossip-offline.png: Update from Dan.

2003-11-17  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-window.c (gossip_chat_window_init): Connect
	after so the switch is actually done when weget the callback.

	* src/gossip-roster-view.c (roster_view_name_cell_data_func):
	Reset attributes for inbox items.

2003-11-16  Mikael Hallendal  <micke@imendio.com>

        * Fixes #126981
	* src/gossip-chat-window.c: (chat_window_update_menu):
	- Make View->Log unsensitive if no log exists.
	* src/gossip-roster-view.c: (roster_view_button_press_event_cb):
	- Make Right click->View Log unsensitive when no log exists.

2003-11-16  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-window.c: 
	(gossip_chat_window_add_chat): ref the chat
	(gossip_chat_window_remove_chat): unref the chat
	* src/gossip-chat.[ch]: 
	(gossip_chat_get_for_group_chat): updated some for the new roster
	  item stuff.
	* src/gossip-group-chat.c:
	- did some work to fix private chats in a group chat but decided
	  that we need to look over this code some in the future instead.

2003-11-16  Richard Hult  <richard@imendio.com>

	* src/gossip-roster-view.c (roster_view_ellipsize_item_string):
	Take smaller size in consideration.

2003-11-16  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-roster-view.c: (roster_view_name_cell_data_func):
	- Turned on smaller font for status string.

2003-11-16  Geert-Jan Van den Bogaerde <gvdbogaerde@pandora.be>

	* src/Makefile.am:
	* src/gossip-chat-window.c:
	* src/gossip-chat.c:
	* ui/chat.glade: Use notebook tabs instead of a list to manage
	multiple chats in one window.

2003-11-15  Richard Hult  <richard@imendio.com>

	* src/gossip-roster-view.c (roster_view_name_cell_data_func): Use
	text_aa in normal state instead of text in insensitive, seems to
	work better with some themes. Fix problem with multibyte char
	names.
	(roster_view_setup_tree): Try a tiny bit less vertical padding.

2003-11-14  Richard Hult  <richard@imendio.com>

	* src/gossip-roster-view.c (roster_view_name_cell_data_func): Get
	the real width of menu sized stock icons instead of hardcoding it
	to 16. Don't include the tree indentation when ellipsizing "inbox"
	items.

	* gossip.schemas.in: Fix typo.

2003-11-14  Mikael Hallendal  <micke@imendio.com>

	* ui/main.glade: Make Ctrl-O toggle Show Offline contacts.

2003-11-14  Richard Hult  <richard@imendio.com>

	* gossip.schemas.in: Remove open_in_list. Don't translate
	away_messages and busy_messages, the user can do that with the
	status editor if needed. This can never be perfect, unless we all
	start speaking Esperanto.

2003-11-14  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat.c: (gossip_chat_get_for_item):
	- Initialize is_online correctly. Fixes #126760 
	* src/gossip-preferences.c:
	(preferences_setup_widgets),
	(gossip_preferences_show): 
	* ui/main.glade: Removed show new chats in list option.

2003-11-14  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-roster-view.c: (roster_view_button_press_event_cb):
	- Don't popup items right-click menu on empty groups. 
	- Fixes #126556

2003-11-14  Vincent Untz  <vincent@vuntz.net>

	* src/gossip-preferences.c: (status_add_away_clicked_cb): 
	- don't try to add a new away message in gconf if the user did 
	  not type a message.

2003-11-14  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-window.c: (chat_window_delete_event_cb):
	* src/gossip-chat.c: (gossip_chat_finalize), (chat_create_gui),
	(chat_update_locked_resource), (chat_get_jid_with_resource),
	(chat_send), (chat_composing_send_start_event),
	(chat_composing_send_stop_event), (chat_message_handler),
	(chat_item_presence_updated), (chat_event_handler),
	(gossip_chat_present): Always send messages to a specific
	resource. Lock the resource to the last received message, change
	resource when the resource has changed in the roster. Don't send
	composing events to a resource that didn't request any.
	
	* src/gossip-roster-view.c: (roster_view_name_cell_data_func):
	Move a comment.

	* src/gossip-roster.c: (roster_item_sort_connections): Sort
	according to show as well.

2003-11-14  Mikael Hallendal  <micke@imendio.com>
        
        * Fixes, #120997, #125434, #126954

	* src/gossip-app.c:
	* src/gossip-chat.c: 
	* src/gossip-roster-view.c:
	- Handle messages from contacts not in the roster
	- Send the RosterItem around more instead of converting to and 
	  from jid.
	* src/gossip-log.c: (gossip_log_message):
	- Don't log from people not on the list.
	* src/gossip-roster.c: 
	(gossip_roster_item_compare),
	(gossip_roster_item_new): Added, need when message arrives from 
	  someone who is not in your roster.

2003-11-14  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat.c:
	(gossip_chat_init): Listen to new presence_updated signal
	(chat_item_presence_updated): renamed from _item_updated
	* src/gossip-roster-view.c: 
	(roster_view_iter_compare_func): 
	- Sort items before groups (for inbox functionality).
	(roster_view_pixbuf_cell_data_func):
	- Always show message bubble for inbox items.
	(roster_view_ellipsize_item_string):
	- Splitted out of _ellipsize_item_strings.
	(roster_view_name_cell_data_func):
	- Don't print status on inbox items.
	(roster_view_find_item): 
	(roster_view_add_item):
	- Support group == NULL for messages in inbox (above the groups
	  in the roster)
	(gossip_roster_view_flash_item):
	- Add the item to the inbox.

2003-11-14  Richard Hult  <richard@imendio.com>

	* autogen.sh: Define CONFIGURE.

	* src/gossip-app.c: (app_idle_check_cb),
	(app_cancel_pending_leave), (app_status_available_activate_cb):
	Fix bug where autoaway got stuck. Check idleness a bit more often.

	* src/gossip-roster-view.c: (roster_view_setup_tree),
	(roster_view_name_cell_data_func): Tweak padding for the presence
	icon and use theme friendly colors for the status text.

	* ui/main.glade: Add missing mnemonics.

2003-11-13  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_show_offline_cb): Get the actual value
	from the menu item, and store it in gconf.
	(app_init): Connect to the toggled signal instead of activate for
	the show offline check menu item. Set the initial state from
	gconf.

	* gossip.schemas.in: Add show_offline key.

	* src/gossip-app.c (app_init): Don't set status text here.

2003-11-14  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-roster-view.c:
	- Do the offline/online-filter myself. Probably fixes #126472
	* src/gossip-roster.c:
	- Removed group_item_added/group_item_removed signals
	- Added "item-presence-updated" signal
	* src/Makefile.am: Don't compile eggtreemodelfilter

2003-11-13  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-roster-view.c: fixed asserts.
	* src/gossip-roster.c: 
	(gossip_roster_item_get_subscription): added
	(gossip_roster_item_get_ask): added

2003-11-12  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-roster-view.c:
	(roster_view_group_item_added): return if we can't find group.
	(roster_view_group_item_removed): same.
	* src/gossip-roster.c: removed unused variable

2003-11-12  Ross Burton  <ross@burtonini.com>

	* src/gossip-app.c: (app_init), (app_show_offline_cb):
	* src/gossip-roster-view.c: (roster_view_init),
	(roster_view_filter_visible_func),
	(gossip_roster_view_set_show_offline),
	(gossip_roster_view_get_show_offline): Implement showing/hiding
	offline contacts.

2003-11-12  Richard Hult  <richard@imendio.com>

	* src/gossip-preferences.c
	(gossip_preferences_show_status_editor): Set transient, just for
	Ross.

	* src/gossip-sound.c (gossip_sound_play): Use silent_busy
	preference.

	* src/gossip-app.c (app_init): Deconfuse some more (send chat
	message -> send message).

	* ui/main.glade: Fix #121000 and #125566, unnecessary space and
	confusing menu item.

2003-11-12  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-window.c: Include config.h, fixes #126569.

	* src/gossip-roster-view.c (roster_view_name_cell_data_func):
	Replace any occurances \n, \r and \t in name and status with
	space, fixes #126767.

	* src/gossip-app.c: (app_status_messages_cb), (app_idle_check_cb),
	(app_update_show), (app_cancel_pending_leave),
	(app_status_available_activate_cb),
	(app_status_custom_leave_activate_cb),
	(add_status_image_menu_item), (show_popup):

	* src/gossip-preferences.c: (hookup_entry),
	(preferences_setup_widgets), (gossip_preferences_show),
	(get_new_message), (status_destroy_cb),
	(status_add_busy_clicked_cb), (status_add_away_clicked_cb),
	(status_remove_busy_clicked_cb), (status_remove_away_clicked_cb),
	(status_response_cb), (status_busy_selection_changed_cb),
	(status_away_selection_changed_cb),
	(gossip_preferences_show_status_editor): Add status messages
	editing and split the "silent away" option into silent away and
	silent busy.
	
	* src/gossip-utils.c: (gossip_utils_get_busy_messages),
	(gossip_utils_get_away_messages): Add a small workaround for an
	intltool bug (#121330).
	
	* ui/main.glade: Add status message editor and remove the notebook
	in the preferences dialog.

	* ui/pixmaps/gossip-busy.png: Yellowify.

2003-11-11  Richard Hult  <richard@imendio.com>

	* gossip.schemas.in: Add silent_busy key.

	* src/gossip-app.c (app_idle_check_cb): Don't interrupt the
	leaving mode if there's activity. Revert debug code that set the
	leaving time to a very small number.

2003-11-11  Abel Cheung  <maddog@linux.org.hk>

	* configure.in: Added "hr" to ALL_LINGUAS.

2003-11-11  Ross Burton  <ross@burtonini.com>

	* gossip-contact-info.c:
	* gossip-join-dialog.c:
	* gossip-roster-view.c:
	Everyone loves transient dialogs! Yet more calls to
	set_transient_for! Yay!

2003-11-11  Johan Hammar <johan.hammar@swipnet.se>

	* src/gossip-roster-view.c: 
	(roster_view_item_menu_info_cb): Added Show Log.
	(roster_view_item_menu_log_cb): 
        - Added, shows the log for selected particular contact

2003-11-11  Ross Burton  <ross@burtonini.com>

	* src/gossip-account-dialog.c:
	* src/gossip-connect-dialog.c:
	* src/gossip-preferences.c:
	Add yet more set_transient_for() calls.

2003-11-11  Ross Burton  <ross@burtonini.com>

	* src/gossip-roster.c: (roster_iq_handler):
	- Don't return on duplicate items. Fixes problem when not all contacts
	  show up in the roster.

2003-11-10  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-view.c:
	* src/gossip-preferences.c:
	* ui/main.glade:
	- 7364f311ecb3e091649d3f45375d25bd
	- Fixes #126650

2003-11-10  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-window.c: 
	(gossip_chat_window_add_chat):
	- Use gossip_chat_set_window instead of object property.
	(gossip_chat_window_remove_chat): same
	* src/gossip-chat.[ch]:
	- Added Geert-Jan to copyright.
	- Removed the rest of the properties.
	(gossip_chat_handle_message): Make sure hashtables are initiated.
	(gossip_chat_set_window): added, use instead of object property.
	* src/gossip-roster.c: (roster_item_update_presence):
	- Set status to NULL if none where sent.

2003-11-10  Ross Burton  <ross@burtonini.com>

	* src/gossip-app.c:
	Add calls to gtk_window_set_transient_for().

2003-11-10  Mikael Hallendal  <micke@imendio.com>

	reviewed by: <delete if not using a buddy>

	* src/gossip-chat-window.c: (gossip_chat_window_add_chat),
	(gossip_chat_window_remove_chat):
	* src/gossip-chat-window.h:
	* src/gossip-chat.c: (gossip_chat_class_init),
	(gossip_chat_set_window):
	* src/gossip-chat.h:

2003-11-10  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c:
	- Use GossipRosterItem to do things with GossipChat.
	* src/gossip-chat-window.c:
	- Changed so that it uses functions instead of object properties on 
	  GossipChat. 
	- Use chat_get_item and get stuff of the item instead of duplicating 
	  the API in GossipChat.
	* src/gossip-chat.c:
	- Connect on item_updated on the roster instead of handling the
	  presence message with own presence callback.
	- Fixed issue where chat window had wrong icon after someone sent 
	  'composing' event.
	- Don't override object constructor, do the stuff in _init and in 
	  get_for_item functions.
	- Removed JID and PRIV_GROUP_CHAT properties.
	- External API's use RosterItem instead of JID.
	* src/gossip-jid.[ch] (gossip_jid_equal), (gossip_jid_hash): 
	- Added, to be used in hash tables to be able to use JID's as keys.
	* src/gossip-roster-view.c (roster_view_group_item_added): 
	- Fixed a compile error reported by Edwin Mons, thanks!
	* src/gossip-roster.c:
	- Use JID's as keys in item hashtable.
	- Fixes a problem where jid wheren't case insensitive reported by 
	  Paul van Tilburg
	* src/gossip-utils.c:
	(gossip_utils_show_to_string),(gossip_utils_show_from_string):
	- Fixed the names of two functions.

2003-11-10  Richard Hult  <richard@imendio.com>

	* src/gossip-roster-view.c (roster_view_name_cell_data_func):
	Escape name and status strings properly.

	* src/gossip-app.c: (configure_event_idle_cb),
	(app_window_configure_event_cb): Tweak the window size saving code
	a bit, don't save until we've stopped resizing.
	(app_init): Set the size request, part of roster item ellipsizing
	hack.

	* src/gossip-roster-view.c: (roster_view_setup_tree),
	(ellipsize_string), (ellipsize_roster_item_strings),
	(roster_view_name_cell_data_func): Weird hack to ellipsize the
	name and status strings in the roster. Needs a bit more work.

	* ui/main.glade: Add placeholder and menu item for status message
	editor.

2003-11-09  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_update_show),
	(app_status_custom_leave_activate_cb),
	(app_status_custom_busy_activate_cb),
	(app_status_custom_available_activate_cb),
	(add_status_image_menu_item), (show_popup):
	* ui/main.glade: Add support for custom available message and
	remove some dead test code.

	* src/gossip-app.c (app_update_show): Send status message even
	when available. We need to decide on how to handle this later.

	* src/gossip-roster-view.c: (roster_view_name_cell_data_func):
	Don't try to print a NULL status string.

2003-11-09  Richard Hult  <richard@imendio.com>

	* src/gossip-chat.c (gossip_chat_present): Grab focus on the
	entry.

	* src/gossip-chat-window.c (chat_window_focus_in_event_cb): Event
	handlers must return a boolean, fixes the weird focus problems.

2003-11-07  Mikael Hallendal  <micke@imendio.com>

        * src/gossip-roster.c (roster_clear_foreach_item):
	- Signal item removed, not added. Wonder how this worked.

2003-11-07  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-roster.c (roster_item_update): 
	- Don't crash on empty groups. Patch from Sjoerd Simons. Fixes #126436

2003-11-07  Richard Hult  <richard@imendio.com>

	* configure.in: Add missing -I to the X includes when checking for
	Xss. Fixes autoaway.

2003-11-07  Mikael Hallendal  <micke@imendio.com>

        * Merged with roster-rewrite branch
	- Fixes #121265, #116412, #119919, #116396, #125536

	* src/Makefile.am:
	- Added gossip-roster-view.[ch]
	- Added eggtreemodelfilter.[ch]
	* src/eggtreemodelfilter.[ch]: Added, used in the new roster view.
	* src/gossip-add-contact.c:
	(add_contact_prepare_page_2): Use the new roster to get groups.
	* src/gossip-app.[ch]: 
	- Updated to work with the new roster.
	- Moved the hard coded status strings (used in the option menu) to 
	  gossip-utils.[ch].
	- Moved GossipShow to gossip-utils.h
	* src/gossip-chat-view.c:
	* src/gossip-chat.c:
	- Updated for new roster, still needs a lot of work.
	* src/gossip-chat-window.c: (chat_window_get_status_pixbuf),
	- updated for new roster, still needs a lot of work. uses JID's when 
	  it should use roster item and so.
	(chat_window_get_name): 
	- renamed from _get_nick and updated to use roster item.
	* src/gossip-contact-info.[ch]:
	(gossip_contact_info_new): 
	- removed the GossipApp argument, pretty useless.
	* src/gossip-log.c: 
	(gossip_log_message): Use GossipRosterItem to get name of contact.
	* src/gossip-marshal.list: Added VOID:POINTER,POINTER
	* src/gossip-roster-view.[ch]:
	- This is the new Roster View. 
	- Currently listens to signals from GossipRoster to update the tree.
	- It uses a GtkTreeStore put in a EggTreeModelFilter to filter out 
	  offline contacts.
	- Currently shows the status messages on one row under the name. 
	  Will have a preference for this.
	- Still need some work but I think most of the work is otherwise to
	  get the rest of the code to work with the new roster backend.
	* src/gossip-roster.[ch]:
	- Implemented now
	- The GossipRoster object holds a hash table for all items and one for
	  all groups. It is responsible for parsing incoming presence messages 
	  aswell as roster pushes.
	- Other code should probably listen on "item_updated" rather than 
	  implementing there own presence message handler.
	- Adds a GossipRosterItem and a GossipRosterGroup to represent a 
	  contact and the various groups.
	- This implementation handles when your contacts have logged in 
	  multiple times. This wasn't handled in the other roster.
	- Contacts can now be in multiple groups (you can't set them to be so 
	  in the the view/or a group editor at this point. This can however be 
	  useful for users that normally use other clients to setup groups.
	* src/gossip-utils.[ch]: 
	(gossip_utils_get_pixbuf_from_stock): moved here from old roster.
	(gossip_utils_get_pixbuf_offline): added
	(gossip_utils_get_pixbuf_from_show): moved here from old roster.
	(gossip_utils_get_default_status): 
	- added, needed by GossipApp and GossipRosterView
	* ui/main.glade: added a check menu option for showing/hiding offline 
	  contacts. Not implemented yet though.

2003-11-06  Richard Hult  <richard@imendio.com>

	* configure.in: Add libxml/libxslt dependencies.
	* gossip.spec.in: Add libxslt requirement.

	* src/Makefile.am: 
	* src/gossip-chat-window.c: (gossip_chat_window_init),
	(chat_window_update_menu), (chat_window_log_activate_cb):
	* src/gossip-chat.c: (chat_send), (chat_message_handler):
	* src/gossip-log.c: (log_ensure_dir), (log_get_filename),
	(log_get_timestamp), (gossip_log_message), (log_transform),
	(gossip_log_exists), (gossip_log_show):
	* ui/chat.glade: More logging stuff and rearrange the menu
	slightly.

2003-11-06  Ross Burton  <ross@burtonini.com>

	* ui/main.glade: (contact_information):
	Make the JID selectable, forgot this.

2003-11-06  Ross Burton  <ross@burtonini.com>

	* ui/main.glade: (contact_information): Add a label for the JID,
	and make the Description area fill and expand.

	* src/gossip-contact-info.c: Set the JID in the Contact
	Information dialogue.

	* configure.in: Fix setting of CFLAGS.

2003-11-04  Abel Cheung  <maddog@linux.org.hk>

	* configure.in: Added "zh_TW" to ALL_LINGUAS.

2003-11-04  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-window.c: (gossip_chat_window_init):
	* src/gossip-chat.c: (chat_create_gui), (chat_composing_cb):
	* ui/chat.glade: Fix paddings etc and remove the info button, move
	the composing icon.

2003-11-04  Mikael Hallendal  <micke@imendio.com>
        
        * Tabbed window patch from Geert-Jan Van den Bogaerde, you rock!

	* gossip.schemas.in: open_in_list gconf-key.
	* src/Makefile.am: Added new files gossip-chat-window.[ch]
	* src/gossip-app.c: Updated to work with tabbed chat windows.
	* src/gossip-chat.[ch]: Made into an object  
	- This is now an object.
	- Represenents a single chat. 
	* src/gossip-group-chat.c: Updated for tabbed chat windows.
	* src/gossip-preferences.c: Added setting for tabbed chat windows.
	* src/gossip-chat-window.[ch]: added
	* ui/chat.glade: tabbed window support
	* ui/main.glade: added tabbed chat window setting to pref dialog

2003-11-04  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_tray_destroy_event_cb),
	(app_tray_create): Try a bit harder not to crash when the
	notification area disappears.

2003-11-03  Richard Hult  <richard@imendio.com>

	* src/Makefile.am: Add gossip-log.[ch]
	* src/gossip-chat-view.c: (chat_view_maybe_append_timestamp),
	(gossip_chat_view_append_event_msg):
	* src/gossip-chat.c: (chat_send), (chat_message_handler):
	* src/gossip-utils.c: (gossip_utils_get_timestamp):
	* src/gossip-utils.h: Refactor timestamp code and add logging
	stuff from Johan Wallenborg. Need to implement viewing of logs and
	finalize the format.

	* src/gossip-app.c: (app_status_leave_activate_cb), (show_popup):
	Tweak more. Don't treat away/leave the same as busy.

2003-11-02  Richard Hult  <richard@imendio.com>

	* gossip.schemas.in:
	* src/gossip-app.c: (app_init),
	(app_update_show), (app_cancel_pending_leave),
	(app_leave_flash_timeout_func), (app_leave_flash_start),
	(app_status_available_activate_cb), (app_status_busy_activate_cb),
	(app_status_leave_activate_cb),
	(app_status_custom_leave_activate_cb),
	(app_status_custom_busy_activate_cb), (add_status_image_menu_item),
	(show_popup), (app_status_button_clicked_cb):
	* ui/main.glade: Tweak status setting, we're hopefully getting
	closer to the final thing.

2003-10-30  Richard Hult  <richard@imendio.com>

	* src/gossip-chat-view.c: Include sys/types.h for FreeBSD and
	others. Reported by Edwin Mons <e@ik.nu>.

2003-10-30  Mikael Hallendal  <micke@imendio.com>

        * gossip.desktop.in: 
	- Changed the GenericName suggested by Thomas Reynolds.

2003-10-28  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_cancel_pending_leave),
	(app_idle_check_cb), (app_status_activate_cb),
	(status_entry_activate_cb): Cancel leave if the status is changed.
	(app_leaving_cb): Remove some unused text buffer code.

2003-10-28  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_idle_check_cb), (app_update_show):
	Implement simple "leaving timeout".
	
	* src/gossip-preferences.c: (set_string_from_gconf),
	(entry_value_changed_cb), (string_notify_func), (hookup_entry),
	(preferences_setup_widgets), (gossip_preferences_show): Add
	support for string/entry widget and hookup status messages.

2003-10-28  Richard Hult  <richard@imendio.com>

	* gossip.schemas.in: Clean up some old obsolete schemas.

	* src/gossip-app.c (app_update_show): Use away message when away.
	(app_idle_check_cb): Remove stale autoaway preferences code, it's
	all hardcoded now.

	* ui/main.glade: Set hscroll automatic for the roster tree, to
	stop the window from growing horizontally and get stuck very wide.
	Also add a very simple (for now) leave dialog. Move around
	preferences and add some experimental status message preferences.
	
2003-10-27  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_init), (app_status_edit_cb),
	(app_status_align_menu), (app_status_entry_grab_cb),
	(app_status_custom_activate_cb), (app_status_activate_cb),
	(ellipsize_string), (add_status_image_menu_item), (show_popup),
	(status_button_clicked_cb), (status_entry_activate_cb),
	(status_entry_key_press_event_cb),
	(status_entry_focus_out_event_cb), (status_busy_toggled_cb):
	* ui/main.glade: Try another variation of status handling.
	
	* src/gossip-app.c (configure_event_idle_cb)
	(app_window_configure_event_cb, app_init): Remember the size of
	the roster window.

	* gossip.schemas.in: Add width/height and messages for away,
	available, busy and "leaving".

2003-10-27  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-view.[ch]:
	(gossip_chat_view_append_event_msg): 
	- Added 'timestamp' argument to specify if the message should be 
	  timestamped.

2003-10-27  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_update_show): 
	- Set priority depending on your show value. Patch from Sjoerd Simons.
	- Fixes #121002

2003-10-27  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-view.c:
	(chat_view_finalize): Unref the buffer
	(chat_view_maybe_append_datestamp): 
	- Don't append timestamp on event messages.
	(gossip_chat_view_append_event_msg): Append timestamps.

2003-10-26  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat.c: (chat_presence_handler):
	- Don't append online/offline messages if chat window is hidden.

	* src/gossip-chat-view.c:
	- Added the buffer to priv, use priv->buffer instead of getting from 
	  the view all the time.
	(chat_view_init): Set wrap mode, this also solves the center
	  justification on the event-tag. Sounds like a bug.
	(chat_view_setup_tags):  (chat_view_populate_popup),
	(chat_view_get_timestamp): renamed from _get_stamp
	(chat_view_maybe_append_timestamp): 
	- renamed from _view_append_timestamp
	- use append_event_msg to display timestamps.
	(chat_view_maybe_append_datestamp):
	- added to date stamping when chat goes on over midnight.
	- Fixes #124069
	(gossip_chat_view_append_chat_message):
	- maybe append datestamp.
	(gossip_chat_view_append_event_msg): 
	- outputs text centered in dark gray.
	* src/gossip-chat.c: 
	(chat_create_gui): keep track on if user is offline or not
	(chat_presence_handler):
	- output offline/online noticed in chat window.
	* src/gossip-roster-old.c:
	(gossip_roster_old_get_is_offline): 
	- added, used when creating a gossip-chat window.

2003-10-26  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat-view.[ch]: Missed adding these

	* Long time planned cleanup. Now the chat text views are of the class
	* GossipChatView which is a sub class of GtkTextView. All functions
	* used from GossipChat and GossipGroupChat was put in gossip-utils. 

	* src/Makefile.am: 
	- Added gossip-chat-view.[ch]
	- Removed gossip-message.[ch]
	  
	* src/gossip-chat.c:
	* src/gossip-group-chat.c:
	- Use GossipChatView instead of a GtkTextView directly.
	  
	* src/gossip-message.[ch]: Removed 
	
	* src/gossip-utils.c: 
	(gossip_utils_substring): Made external, used to be static for use only
	  within the text view functions. Might become handy in other places 
	  and is now used in GossipChatView.

	* ui/chat.glade: 
	- Removed the message dialogs (unused, old and ugly)
	- Removed the chat text view, created from C now
	* ui/group-chat.glade:
	- Removed the chat text view, created from C now

2003-10-25  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-utils.c: (gossip_text_view_setup_tags):
	- missed to update tag names

	* gossip.schemas.in: 
	- Changed timestamp all messages to default to false
	  
	* src/gossip-chat.c:
	* src/gossip-group-chat.c:
	* src/gossip-utils.c:
	- Added last_timestamp to keep track of last timestamp.
	- ichat-like timestamps, half fixes #121004
	- group-chat and chat now keep track on when the last timestamp was 
	  added.

2003-10-25  Richard Hult  <richard@imendio.com>

	* src/gossip-utils.c: (open_address), (open_address_cb),
	(copy_address_cb), (utils_url_event_cb),
	(utils_text_view_populate_popup), (gossip_text_view_setup_tags):
	Add open and copy link items to the text view's context menu,
	based on patch from Ross Burton.

	Also fix a small bug that made protocol-less links not to work.
	
	* src/gossip-utils.c (utils_url_event_cb): Don't show the url if
	it's just being selected.

	* ui/main.glade: Remove padding on Ross' orders.

2003-10-16  Richard Hult  <richard@imendio.com>

	* acinclude.m4: Remove -sign-promo since that's not usable for C.

2003-10-15  Mikael Hallendal  <micke@imendio.com>

	* ui/svg/emoticon-face1.svg:
	* ui/svg/emoticon-face10.svg:
	* ui/svg/emoticon-face11.svg:
	* ui/svg/emoticon-face12.svg:
	* ui/svg/emoticon-face2.svg:
	* ui/svg/emoticon-face3.svg:
	* ui/svg/emoticon-face4.svg:
	* ui/svg/emoticon-face5.svg:
	* ui/svg/emoticon-face6.svg:
	* ui/svg/emoticon-face7.svg:
	* ui/svg/emoticon-face8.svg:
	* ui/svg/emoticon-face9.svg:
	* ui/svg/face-template.svg:
	* ui/svg/gossip-away.svg:
	* ui/svg/gossip-busy.svg:
	* ui/svg/gossip-extended-away.svg:
	* ui/svg/gossip-offline.svg:
	* ui/svg/gossip-online.svg:
	* ui/svg/id.svg:
	* ui/svg/license:
	* ui/svg/message.svg:
	- More art work from Daniel Taylor. Here are the SVG's. 

	* ui/pixmaps/gossip-available.png:
	* ui/pixmaps/gossip-away.png:
	* ui/pixmaps/gossip-busy.png:
	* ui/pixmaps/gossip-extended-away.png:
	* ui/pixmaps/gossip-offline.png:
	- Added great new icons by Daniel Taylor. 
	  Rock on dude! Let's attack the emoticons next ;)

2003-10-14  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-chat.c: (chat_message_handler): Don't resend compose
	  request. 

	* autogen.sh: Added LIBTOOL, couldn't autogen.
	
	* configure.in: Require CVS Loudmouth
	
	* src/gossip-chat.c: 
	(chat_input_activate_cb): 
	- don't send end-of-compose-event when clearing text entry.
	(chat_send_multi_clicked_cb): same
	(chat_message_handler): request compose events.
	(chat_request_composing): Don't invent message id's here.

2003-10-13  Mikael Hallendal  <micke@imendio.com>

	* autogen.sh: Added patch from Edwin Mons to make it easier to use
	  various versions of auto* tools.

2003-10-07  Mikael Hallendal  <micke@imendio.com>

	* src/Makefile.am: Fixed build problem reported by Jonathan Taylor.

2003-10-03  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-roster.c: 
	- More work done. Starting to get there, soon I'll be able to start 
	  hacking on the GUI parts.
	* src/gossip-utils.[ch] (gossip_show_from_string): Added

2003-09-09  Jordi Mallach  <jordi@sindominio.net>

	* ui/main.glade: Add mnemonics to the Edit menu items and Prefs
	dialog.

2003-09-03  Mikael Hallendal  <micke@imendio.com>

        * src/gossip-app.c (app_update_show): Send that we are away and 
	  extended away to the server, don't just update the local icon :)
	
2003-09-03  Martyn Russell  <ginxd@btopenworld.com>

	* src/gossip-add-contact.c:
	(add_contact_prepare_page_2),
	(add_contact_page_2_vcard_handler), 
	(gossip_add_contact_new): 
	* ui/main.glade: 
	- Show a label to tell the user that we have requested information.
	- Fixes bug #120606

2003-09-01  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_idle_check_cb): Make compile

2003-09-01  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_idle_check_cb): Don't use the
	preferences.

	* src/gossip-roster-old.c (roster_presence_handler): Fix bug that
	was introduced with the new status stuff.

	* src/gossip-utils.c: Remove dead code.
	
2003-09-01  Metin Amiroff  <metin@karegen.com>

	configure.in: Added "az" in ALL_LINGUAS.

2003-08-30  Richard Hult  <richard@imendio.com>

	* src/gossip-chat.c (chat_create_gui): Use stock icon for typing
	notification.

	* src/gossip-main.c: (setup_default_window_icon):
	* ui/main.glade: Fix stale references to old image. Thanks boyens!

2003-08-30  Christophe Merlet  <redfox@redfoxcenter.org>

	* configure.in: Added "fr" to ALL_LINGUAS.

2003-08-30  Wang Jian  <lark@linux.net.cn>

	* configure.in: Added "zh_CN" to ALL_LINGUAS.

2003-08-30  Richard Hult  <richard@imendio.com>

	* src/gossip-add-contact.c (add_contact_prepare_page_2): Reset
	name, email and country labels when we don't have the info. Patch
	from Martyn Russell.

	* src/Makefile.am:
	* src/eel-ellipsizing-label.h:
	* src/eel-ellipsizing-label.c: Add.

	* src/gossip-app.c:
	* ui/main.glade: Use an ellipsizing label for the status string.
	
2003-08-29  Martyn Russell <ginxd@btopenworld.com>
	
	* src/gossip-app.c (app_subscription_request_dialog_response_cb):
	Only add a user if we accept their request.

2003-08-29  Richard Hult  <richard@imendio.com>

	* src/gossip-utils.c (gossip_hig_dialog_new): Add.

	* src/gossip-app.c: (gossip_app_connect): Use if here for the
	error message mentioned below.
	
2003-08-29  Martyn Russell <ginxd@btopenworld.com>

	* src/gossip-app.c: (gossip_app_connect): Display an error message
	if we can't connect.

2003-08-29  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_subscription_request_dialog_response_cb):
	Remove markup from translations. Don't try to add contact if the
	user deferred.

	* src/gossip-stock.[ch]:
	* src/Makefile.am: Add gossip-stock.

	* src/gossip-add-contact.c: (add_contact_prepare_page_3),
	(add_contact_prepare_page_last): Remove unnecessary markup.

	* src/gossip-app.c: Clean up status handling and separate the
	jabber-speak "show" from online/offline handling. Implement the
	design for setting status that was discussed on the list. It's not
	completed yet, but a good start to work from.

	* src/gossip-chat.c: (chat_create_gui), (chat_presence_handler):
	* src/gossip-group-chat.c: (group_chat_presence_handler),
	(set_status_foreach), (gossip_group_chat_set_show): Use stock icons.

	* src/gossip-main.c: (main): Register stock icons.

	* src/gossip-preferences.c: (hookup_spin_button),
	(preferences_setup_widgets), (gossip_preferences_show): Remove
	autoaway preferences.
	
	* src/gossip-roster-old.c: Add plenty of ugly hacks to work with
	the new status handling and stock icons. No use to do it nicely
	since Mikael is working on a new roster anyway.

	* src/gossip-sound.c: (gossip_sound_play): Make this work with the
	new status handling.

	* src/gossip-utils.c: (tagify_bold_labels), (get_glade_file):
	Experiment a bit with getting less markup in translated strings.

	* ui/main.glade: Remove some old crap that we don't use, to get
	less strings to translate. Also try out the tagify stuff on a few
	strings.

	* ui/connect.glade: Tweak padding a bit and remove hidden
	widgets. Make the connect button default button and make the entry
	active the default.

	* ui/pixmaps/*: Rename images and play around with some new ones
	for status icons. Needs tweaking or replacing but still better
	than the old ones, in that the different statuses are easier to
	tell apart.

2003-08-29  Richard Hult  <richard@imendio.com>

	* src/gossip-utils.c (tagify_bold_labels): Try this out. May work
	pretty well.

	* ui/main.glade: Try tagifying with a few dialogs.
	
	* gossip.schemas.in: Change default autoaway times to 5 and 30
	minutes.

        * ui/main.glade: Don't mark test string as translatable.

2003-08-29  Richard Hult  <richard@imendio.com>

        * ui/group-chat.glade: Fix a few border widths (4 to 0 or 6).

2003-08-29  Mikael Hallendal  <micke@imendio.com>

        * ui/*.glade: Higification (some, not full done...). Based on
	patch from Martyn Russell <ginxd@btopenworld.com>.

2003-08-27  Ole Laursen  <olau@hardworking.dk>

	* configure.in: Added "da" (Danish) to ALL_LINGUAS.

2003-08-24  Abel Cheung  <maddog@linux.org.hk>

	* src/gossip-roster-old.c: Add translator comment.

2003-08-23  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Added "no" to ALL_LINGUAS.

2003-08-20  Richard Hult  <richard@imendio.com>

	* configure.in: Add de.

2003-08-19  Richard Hult  <richard@imendio.com>

	* src/gossip-account-dialog.c: 
	* src/gossip-account.c: 
	* src/gossip-app.c:
	* src/gossip-join-dialog.c:
	* src/gossip-main.c:
	* src/gossip-startup-druid.c: Finish up the new account dialog and
	do some cleaning that was made possible now that we only have one
	account visible in the interface. It's still a bit crufty.

	* src/gossip-connect-dialog.c: Use the specified resource.

	* src/gossip-chat.c (chat_presence_handler): Update tooltip on
	presence change (resource might be different).

	* src/gossip-app.c (app_set_status_indicator): Don't set the
	window icon depending on the status.

2003-08-19  Richard Hult  <richard@imendio.com>

	* ui/connect.glade: Hide priority and edit buttons for now.

	* src/gossip-utils.c (utils_url_event_cb): Remove unecessary
	string. Check that we got the right tag, fixes bug #118601.

	* src/gossip-startup-druid.c (startup_druid_prepare_page_last):
	Remove markup from two strings.

	* ui/chat.glade: 
	* ui/main.glade: Remove a string and tweak padding to get rid of
	uneccesary spaces from a strings.

2003-08-18  Richard Hult  <richard@imendio.com>

	* src/Makefile.am: Clean up a bit.

	* src/gossip-account.c: (gossip_account_get_default),
	(gossip_account_store), (gossip_account_set_default):
	* src/gossip-account.h: Always return a default account, fix
	syncing after changing accounts.
	
	* src/gossip-app.c: (app_preferences_cb): Simplify.
	(app_account_information_cb): Implement.
	
	* src/gossip-connect-dialog.c: (account_dialog_destroy_cb),
	(connect_dialog_destroy_cb), (connect_dialog_response_cb),
	(gossip_connect_dialog_show): Implement.

	* src/gossip-startup-druid.c: (startup_druid_get_account_info):
	Change default name.
	
	* src/gossip-utils.c: (gossip_glade_setup_size_group): Add, sets
	up a size group for a number of named widgets.
	(gossip_glade_connect): Just skip missing widgets, makes debugging
	easier.
	
	* ui/connect.glade: 
	* ui/main.glade: Add menu item and dialog for editing account
	information. Simplify the connect dialog.

2003-08-18  Artur Flinta  <aflinta@cvs.gnome.org>

	* configure.in: Added "pl" to ALL_LINGUAS.

2003-08-16  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_message_handler):
        - handle headline messages like any other for now.
          
	* src/gossip-roster.c: (gossip_roster_get_type),
	(roster_class_init), (roster_init), (roster_finalize):
	* src/gossip-roster.h: WIP

2003-08-15  Mikael Hallendal  <micke@imendio.com>

	* src/Makefile.am:
	* src/gossip-add-contact.c: 
	* src/gossip-app.c:
	* src/gossip-app.h:
	* src/gossip-chat.c:
	* src/gossip-message.c: 
	* src/gossip-roster-old.c:
	* src/gossip-roster-old.h: 
        - Moved gossip-roster.[ch] to gossip-roster-old.[ch] to make place for
          hacking on the new implementation.

2003-08-15  Richard Hult  <richard@imendio.com>

	* configure.in: Bump version to 0.5, require loudmouth 0.13.2

	Release 0.5

2003-08-13  Richard Hult  <richard@imendio.com>

	* src/gossip-roster.c (roster_menu_rename_cb): Set the group child
	node if we have a group. Fixes bug #119629.

	* src/gossip-chat.c: (chat_dialog_notify_visible_cb): Send stop
	composing event when the window is closed.
	
	(chat_create_gui), (chat_input_key_press_event_cb),
	(chat_input_entry_changed_cb),
	(chat_input_text_buffer_changed_cb): Don't send composing events
	for key presses, but when the text changes.

	(chat_send), (chat_presence_handler),
	(chat_composing_send_start_event), (chat_composing_start),
	(chat_composing_send_stop_event), (chat_composing_stop),
	(chat_composing_remove_timeout), (chat_composing_stop_timeout_cb):
	Refactor a bit so we can send a stop event from other places.
	
2003-08-11  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_pop_message): Compare JID without
	resource, should fix the stuck flashing icon.

2003-08-11  Richard Hult  <richard@imendio.se>

	* src/gossip-chat.c: Tweak the composing event code a bit.

	* ui/chat.glade: Hide composing icon initially.

	* ui/pixmaps/message.png: Use another icon.

2003-08-11  Mikael Hallendal  <micke@imendio.com>

	* gossip.spec.in: 
	- Fixed the description line. Thanks to JR Boyens for spotting.

2003-08-08  Danilo Šegan  <dsegan@gmx.net>

	* configure.in: Added "sr" and "sr@Latn" to ALL_LINGUAS.

2003-08-06  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_set_status): 
	* src/gossip-group-chat.c: (gossip_group_chat_set_status):
	- Don't set the show value if it's "normal". We were setting it to
	  <show/> in that case which is wrong.

2003-08-05  Richard Hult  <richard@imendio.com>

	* ui/main.glade: Add icon for Add Contact... item, patch from
	Thomas Reynolds <thomasr@infograph.com>.

2003-08-05  Mikael Hallendal  <micke@imendio.com>

	* ui/chat.glade: Added compose_image to the glade-file. Otherwise you 
	  can't open a window, might not be what Richard had in mind...

2003-08-05  Richard Hult  <richard@imendio.com>

	* src/gossip-chat.c: (destroy_notify_cb),
	(chat_dialog_notify_visible_cb), (chat_init), (chat_get_for_jid),
	(chat_create_gui), (chat_input_key_press_event_cb),
	(chat_key_press_event_cb), (chat_send), (chat_message_handler),
	(chat_presence_handler), (gossip_chat_get_dialog),
	(chat_request_composing), (chat_event_handler),
	(chat_composing_start), (chat_composing_stop),
	(chat_composing_timeout), (chat_set_compose_icon): Typing
	notification based on patch from Nicolas Peninguy. It's disabled
	for now, since it's not completely finished yet.

	* ui/chat.glade:
	* ui/pixmaps/Makefile.am:
	* ui/pixmaps/typing.png: Add typing image.

2003-08-04  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_iq_handler): Don't use PACKAGE for the
	client name, "Gossip" looks nicer than "gossip".

2003-08-05  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-app.c: (app_push_message): compare without resouce.

        * configure.in: Bumped loudmouth version to 0.13

	* src/gossip-app.c:
	(app_message_handler): Removed bogus sub type check.
	(app_push_message): Don't push blink if this user is already blinking.
	* src/gossip-chat.c:
	(chat_dialog_delete_event_cb): added
	(chat_get_for_jid): initialize as not hidden.
	(chat_create_gui): connect to delete_event.
	(chat_key_press_event_cb): hide chat instead of destroying it.
	(chat_message_handler): if hidden, allow more handlers.
	(chat_hide): Added, hides the chat dialog
	(gossip_chat_append_message): Don't append if message is hidden.

	* src/gossip-app.c: (app_about_cb):
	- Commited patch from Thomas Reynolds to add link to project page in
	  about dialog. Fixes bug #117730

2003-08-03  Richard Hult  <richard@imendio.com>

	* src/gossip-accounts-dialog.c
	(accounts_dialog_get_current_account)
	(accounts_dialog_use_ssl_toggled)
	(accounts_dialog_remove_account_cb)
	(accounts_dialog_register_account_cb)
	(accounts_dialog_update_account_cb): Don't do anything if there is
	no selected account. Fixes bug #117863 and some more.
	(accounts_dialog_update_account_cb): Actually get the iter before
	trying to set the name.

	* src/gossip-roster.c (gossip_roster_flash_jid)
	(roster_jid_updated): Finish up the flashing code from last night.

2003-08-02  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_pop_message): Do case insensitive compare.

	* src/gossip-favorites-dialog.c
	(favorites_dialog_remove_favorite_cb)
	(favorites_dialog_update_favorite_cb): Don't try to do anything if
	no favorite is selected. Fixes a crash.

2003-08-02  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_message_handler), (app_user_activated_cb),
	(app_complete_jid_response_cb), (app_tray_icon_button_press_cb),
	(app_push_message), (app_pop_message):
	* src/gossip-roster.c: (roster_create_pixbufs),
	(roster_update_user), (roster_pixbuf_cell_data_func),
	(roster_item_free), (gossip_roster_get_status_pixbuf_for_jid),
	(gossip_roster_get_selected_jid), (flash_timeout_func),
	(gossip_roster_flash_jid): Flash icons in the roster as well.

2003-08-02  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_user_activated_cb):
	(app_complete_jid_response_cb): Present the window instead of just
	showing it.

2003-08-01  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_init), (app_show_hide_activate_cb),
	(app_send_chat_message), (app_send_chat_message_cb),
	(app_popup_send_chat_message_cb), (app_complete_jid_response_cb),
	(app_toggle_visibility), (app_tray_icon_destroy_cb),
	(app_tray_icon_button_press_cb), (app_create_tray_icon),
	(app_tray_icon_set_status), (app_tray_icon_push_message),
	(app_tray_icon_pop_message), (app_tray_icon_update_tooltip): Add
	tooltip for new messages, lower the flash rate, add context menu
	for the icon.

	* src/gossip-roster.c: (get_jids_foreach),
	(gossip_roster_get_jids), (gossip_roster_free_jid_list): Ref and
	unref the jids.

	* src/gossip-chat.c (chat_send): Don't send empty messages.

2003-08-01  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_init), (app_authentication_cb),
	(app_message_handler), (app_user_activated_cb), (app_set_status),
	(app_tray_icon_button_press_cb),
	(app_complete_jid_response_cb), (gossip_app_get_status),
	(flash_timeout_func), (app_tray_icon_push_message),
	(app_tray_icon_pop_message):
	* src/gossip-chat.c: (chat_get_for_jid), (chat_create_gui):
	* ui/pixmaps/Makefile.am:
	* ui/pixmaps/message.png: Don't popup messages, just blink the
	notification area. Needs a bit more work like maybe a preference,
	and making subscription request windows behave the same.

2003-08-01  Richard Hult  <richard@imendio.com>

	Clean up a bit:

	* src/*.[ch]: Don't pass around app since it can always be
	accessed through gossip_app_get ().
	
	* src/gossip-app.c: Remove handling of chat and group chat windows
	from here. Don't set "Online" as status.

	* src/gossip-chat.c: Move handling of chat windows here.

	* src/gossip-group-chat.c: Move handling of group chat windows
	here. Fix nick completion to not lowercase the result. Make priv
	chats display the right nick in the chat dialog. Make priv chat
	dialogs insensitive if their group chat parent is closed.

	* src/gossip-utils.c (utils_url_event_cb): Add the start of an
	error dialog for when an URL can't be shown.

2003-07-30  Richard Hult  <richard@imendio.com>

	* ui/chat.glade: Don't set the size of the text view and make the
	default dialog size a bit smaller.

2003-07-30  Duarte Loreto <happyguy_pt@hotmail.com>

        * configure.in: Added Portuguese (pt) to ALL_LINGUAS.

2003-07-27  Richard Hult  <richard@imendio.com>

	* ui/group-chat.glade: 
	* ui/chat.glade: Enable word wrap for the input text view. Spotted
	by Johan.

	* gossip.spec.in (Summary): Fix description, thanks Johan.

2003-07-22  Dafydd Harries  <daf@parnassus.ath.cx>

	* src/gossip-chat.c: Marked chat window title strings
	translatable.

2003-07-18  Richard Hult  <richard@imendio.com>

	* src/gossip-chat.c (chat_dialog_info_clicked_cb): Use the nick,
	not the jid. Fixes #117739 patch from thomasr@infograph.com
	(Thomas Reynolds).

	* Release 0.4.
	
	* gossip.spec.in: Install the schema.
	
2003-07-17  Mikael Hallendal  <micke@imendio.com>

	* src/Makefile.am: removed unused XSS_LIBS

2003-07-17  Mikael Hallendal  <micke@imendio.com>
  
        * configure.in: Bumped to 0.4

	* NEWS: Added with information for 0.4

2003-07-17  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-add-contact.c:
	- Cancel pending operation when dialog is destroyed.

	* configure.in: Bumped loudmouth-dep to 0.12

2003-07-17  Richard Hult  <richard@imendio.com>

	* configure.in: Remove --enable-autoaway, just check that we have
	it and fetch the right libraries.

	* src/gossip-contact-info.c (gossip_contact_info_new): Set up a
	size group to align the labels in the two different tables.
	(contact_info_vcard_reply_cb): Make the hrefs not expand and put
	them inside alignments to line them up.

	* ui/main.glade: Set default size, add padding for the close
	button, make the boxes and tables not expand, enable word wrap for
	the text view.

2003-07-17  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-contact-info.c:
	(contact_info_vcard_reply_cb),
	(contact_info_version_reply_cb):
	(gossip_contact_info_new):
	* ui/main.glade: More work on the contact information dialog.

2003-07-17  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-contact-info.c: (gossip_contact_info_new):
	* ui/main.glade: Remove additional information and address fields.

2003-07-17  Richard Hult  <richard@imendio.com>

	* src/gossip-preferences.c (preferences_setup_widgets): Patch from
	thomasr@infograph.com (Thomas Reynolds). Fixes bug #117696.

	* src/gossip-app.c (app_iq_handler): Just use OS name, and not the
	version or arch.

	* src/gossip-contact-info.c (contact_info_version_reply_cb): Fix a
	string.

2003-07-17  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-favorites-dialog.c: (favorites_dialog_update_favorite_cb): 
	- Strip nickname before saving. 
	* src/gossip-join-dialog.c: (join_dialog_response_cb): 
	- Strip nickname before connecting. Fixes bug #116990

	* src/gossip-contact-info.c: Added support for cancelling requested
	  information if user closes the window before the reply to vCard and
	  version has been received.

	* src/gossip-account.c: 
	* src/gossip-account.h:
	* src/gossip-accounts-dialog.c:
	* src/gossip-app.c: 
	* src/gossip-startup-druid.c: 
	* ui/connect.glade: Added support for SSL. Fixes bug #116421. 

2003-07-17  Richard Hult  <richard@imendio.com>

	* ui/main.glade: Make labels selectable in add contact
	dialog. Fixes bug #116991.

2003-07-17  Richard Hult  <richard@imendio.com>

	* ui/chat.glade: 
	* src/gossip-chat.c (chat_create, chat_dialog_info_clicked_cb):
	Add a small button that brings up contact info for the user. Based
	on patch from Dafydd Harries and fixes bug #116982.

	Also don't show the full JID in the dialog, just the nickname or
	username, and add a tooltip with the full JID.

2003-07-17  Richard Hult  <richard@imendio.com>

 	* src/gossip-chat.c (chat_dialog_focus_in_event_cb)
	(chat_message_handler, chat_update_title, gossip_chat_new): Prefix
	window title with an asterisk when new messages has arrived and
	the window is not focused. Fixes bug #117663.

	* configure.in: Test for XScreenSaver extension by default.
	(ALL_LINGUAS): Add ru.

	* gossip.schemas.in: Add some entries and rearrange the old ones
	to get a hierarchy instead of a flat structure.

	* gossip.desktop.in (X-GNOME-Bugzilla-Component): Add bugzilla
	info, patch from thomasr@infograph.com (Thomas Reynolds). Fixes
	bug #117646.

	* src/gossip-utils.c: Remove jid functions that are moved to
	gossip-jid.c.
	(gossip_text_view_append_chat_message): Only use timestamps if
	enabled.

	* src/gossip-preferences.c: Implement preferences dialog and
	handling.

	* src/gossip-sound.c (gossip_sound_play): Use gconf values.

	* src/gossip-app.c (app_set_status): Don't enable/disable sound
	here.

	* src/gossip-utils.c (gossip_password_dialog_run): Set a border on
	the checkbutton to align it with the rest of the widgets.

2003-07-16  Richard Hult  <richard@imendio.com>

	* src/gossip-roster.c (roster_menu_rename_cb): 
	* ui/group-chat.glade: s/nick/nickname/. Patch from
	daf@parnassus.ath.cx, fixes bug #117314.

2003-07-16  Dafydd Harries  <daf@parnassus.ath.cx>

	* configure.in: Added "cy" (Welsh) to ALL_LINGUAS.

2003-07-16  Thomas Reynolds  <thomasr@infograph.com>

	* src/gossip-app.c: 
	(app_connection_open_cb): 
	* src/gossip-register.c: 
	(gossip_register_account):
	* src/gossip-utils.c: 
	(gossip_password_dialog_run):
	* src/gossip-utils.h:
	* ui/connect.glade: 
	- Added a "remember password"-checkbutton to the password dialog.

2003-07-12  Richard Hult  <richard@imendio.com>

	* src/gossip-roster.c (roster_iq_handler): Remove user from the
	tree store when we get "remove" subscription.
	(roster_presence_handler): Don't do anything if we don't have the
	user in the list.
	(roster_menu_remove_cb): Remove item from roster.

2003-07-11  Richard Hult  <richard@imendio.com>

	* src/gossip-roster.c (roster_menu_rename_cb): Popup dialog for
	entering new name. Send rename message.

	* src/gossip-utils.c (password_dialog_activate_cb): Fix prototype.

2003-07-11  Jordi Mallach  <jordi@sindominio.net>

	* gossip.schemas.in: Try to improve some strings removing redundant
	words.

2003-07-10  Richard Hult  <richard@imendio.com>

	* Makefile.am: 
	* gossip.schemas.in: 
	* gossip.spec.in: Add schemas.

	* src/gossip-app.c (app_idle_check_cb): Only use autoaway if
	enabled, and get time preferences from gconf.

	* src/gossip-utils.c (utils_insert_with_emoticons): Don't convert
	smileys unless enabled.

	* src/gossip-group-chat.c (group_chat_presence_handler): Fix
	string, suggested by Jordi.

	* src/gossip-app.c (app_client_disconnected_cb): Clean up the code
	a bit. Try to fix bug #117134.

	Add the start of auto-away feature, based on a patch from Kevin
	Dougherty <gossip@kdough.net>.
	
	* src/Makefile.am: Add gossip-idle.[ch].
	
	* src/gossip-app.c (app_init): Start idle checker.
	* src/gossip-idle.c (gossip_idle_get_seconds): Add.

	* configure.in: Add XScreenSaver test. Default to disabled for
	now.

2003-07-10  Richard Hult  <richard@imendio.com>

	* configure.in: Add es.

2003-07-09  Richard Hult  <richard@imendio.com>

	* src/gossip-group-chat.c (gossip_group_chat_new): Don't show the
	window until we know things went OK.
	(group_chat_presence_handler): Remove message after handling it,
	fix bug in sub type checking code, handle errors. Show window if
	it's the first presence message.
	(group_chat_message_handler): Same fixes as above.
	(group_chat_iter_compare_func): Do case insensitive compare.
	
	* src/gossip-chat.c (chat_message_handler): Check that the message
	is for the chat before checking for errors. Plug leak.
	(chat_create): Set margin before showing the window.
	
	* src/gossip-utils.c: Add a few more smiley patterns.
	(gossip_text_view_set_margin): Make this work when the theme
	changes and if set before a widget is shown.

2003-07-08  Richard Hult  <richard@imendio.com>

	* src/gossip-contact-info.c (gossip_contact_info_new): Add window
	title.

	* src/gossip-add-contact.c (add_contact_cancel)
	(add_contact_last_page_finished): Hide the window instead of
	destroying, workaround until we implement cancelling of reply
	messages.

	* src/gossip-chat.c (chat_dialog_send): Send messages to the full
	JID, don't strip out the resource.

2003-07-08  Miloslav Trmac  <mitr@volny.cz>

	* configure.in: Added cs (Czech) to ALL_LINGUAS.

2003-07-07  Richard Hult  <richard@imendio.com>

	* configure.in: Add nl to ALL_LINGUAS.

	* Release 0.3.

2003-07-07  Mikael Hallendal  <micke@imendio.com>

	* configure.in: 
	- Bumped to 0.3
	- Updated loudmouth dep

2003-07-07  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-utils.c: Include sys/types.h, fixes build on FreeBSD.

2003-07-07  Mikael Hallendal  <micke@imendio.com>
  
        * configure.in: Added italian translation.
	
2003-07-06  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: Rework the nick completion dialog to be
	modeless, fixes bug #116785 for real.

	* ui/connect-chat.c: Add missing mnemonics. Fixes #116784.

	* src/gossip-chat.c (chat_dialog_key_press_event_cb, chat_create):
	Fix bug #112463.

	* src/gossip-app.c (app_send_chat_message_cb): Remove grab_focus,
	since it's not needed and also screwed up focus. Fixes bug
	#116785 reported by Jordi Mallach.
	
	* src/gossip-chat.c (chat_message_handler): It doesn't matter how
	many <b> you strip out of strings, they will always find something
	else to complain about! ;)

	* src/gossip-app.c (app_message_handler): Treat normal messages
	like chat messages for now, so we don't just drop them.

	* src/gossip-register.c (register_connection_open_cb): Use the
	real password.
	(gossip_register_account): Ask for a password if we don't have
	one.

2003-07-05  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c (app_connection_open_cb): Move password dialog
	from here...

	* src/gossip-utils.c (gossip_password_dialog_run): ...and move
	here.

	* src/gossip-accounts-dialog.c
	(accounts_dialog_update_account_cb): Plug leak and fix crash when
	no account was selected..
	(accounts_dialog_register_account_cb): Add.

	* src/gossip-startup-druid.c (startup_druid_get_account_info):
	Tweak a string.
	(startup_druid_register_account): Remove registration code from
	here...

	* src/gossip-register.c: ...and put it here.

2003-07-05  Richard Hult  <richard@imendio.com>

	* src/gossip-startup-druid.c: (startup_druid_get_account_info),
	(startup_druid_prepare_page_last), (gossip_startup_druid_run): Put
	the list of servers in the code instead of in the glade file and
	use the selected one.

	* ui/main.glade: Remove a double vbox, make spacing consistent and
	fix a string.
	
	* src/gossip-chat.c (chat_message_handler): Handle errors by
	displaying them in a dialog.

	* src/gossip-app.c (app_send_chat_message_cb): Open a chat
	window for the selected JID.

2003-07-05  Richard Hult  <richard@imendio.com>

	* src/gossip-app.c: (app_send_chat_message_cb),
	(app_complete_jid_idle), (app_complete_jid_insert_text_cb),
	(app_complete_jid_key_press_event_cb),
	(app_complete_jid_to_string): 
	Implement a dialog for entering the JID of the person to start a
	chat with. Autocompletes on JID, may change this to include nicks
	as well.
	
	* src/gossip-roster.c: (get_jids_foreach),
	(gossip_roster_get_jids), (gossip_roster_get_selected_jid):
	* src/gossip-roster.h: Implement get_selected_jid and
	get_jids, which is used for the above.

	* src/gossip-add-contact.c (add_contact_prepare_page_2): Don't
	pass NULL to g_completion_add_items.

2003-07-04  Richard Hult  <richard@imendio.com>

	* src/gossip-add-contact.c (add_contact_prepare_page_2): Don't set
	NULL list as popdown strings, fixes runtime warning.

	* src/gossip-app.c (app_message_handler): Don't crash on unhandled
	messages, print out a warning.

	* src/gossip-roster.c (roster_iq_handler): Plug leak.

	* src/gossip-roster.c: Reorder popup menu and use stock items.

	* src/gossip-app.c (gossip_app_connect): Use the server
	and port from the specified account. Fixes -n usage.

	* src/gossip-roster.c (roster_menu_remove_cb): Unsubscribe is
	presence, not message. Ask for confirmation before removing.

	* src/gossip-main.c (main): Add -l, --list-accounts option that
	lists the available accounts and exist.
	(main): Bail out if the specified account doesn't exist.

	* ui/main.glade: Add disconnect menu item.
	* src/gossip-app.c (app_disconnect_cb): Add.
	Patch from Kevin Dougherty <gossip@kdough.net>.

	* src/gossip-app.c (app_finalize)
	(app_setup_connection_dependent_menu_items, app_init):
	(app_update_connection_dependent_menu_items): Update sensitivity
	of menu items depending on connected/disconnected state.

	* src/gossip-roster.c (roster_finalize): Use
	roster_reset_connection.

	* src/gossip-app.c (gossip_app_get_roster): Add missing void.
	(gossip_app_connect_default): Likewise.

	* src/gossip-chat.c (gossip_chat_new): Put the name of the other
	part in the title. Based on patch from Kevin Dougherty
	<gossip@kdough.net>.

	* ui/connect.glade: Hm, why was the response ID changed? Change
	back to make connect work again.

	* src/gossip-app.c (app_init): Make it possible to test the druid
	by setting the environment variable GOSSIP_FORCE_DRUID.
	(gossip_app_connect): Add warning.

	* src/gossip-roster.c (roster_disconnected_cb): Disconnect
	handlers.

2003-07-03  Richard Hult  <richard@imendio.com>

	* src/gossip-connect-dialog.c: Remove unsed ACCOUNTS_PATH macro.

	* gossip.spec.in: Update.

	* src/gossip-utils.c: Add a few smiley patterns.

	* src/gossip-accounts-dialog.c:
	(accounts_dialog_remove_account_cb): Fix comment.

	* src/gossip-app.c: (app_init): Remove debug message, and only
	create connection if we have an account.

	* src/gossip-roster.c: (roster_menu_remove_cb): Add comment about
	agents.

	* src/gossip-startup-druid.c: (startup_druid_get_account_info),
	(startup_druid_last_page_finished), (gossip_startup_druid_run),
	(startup_druid_progress_dialog_destroy_cb),
	(startup_druid_register_handler),
	(startup_druid_connection_open_cb),
	(startup_druid_register_account):
	* src/gossip-startup-druid.h: Implement the remaining bits of the
	startup druid and hook it up.

	* ui/connect.glade: Remove spurios '5' in the port entry.

	* src/gossip-jid.c (gossip_jid_get_part_name): Don't return an
	allocated string for some cases and a static one for some. Always
	return a copy.

	* ui/*.glade: Add missing mnemonics, patch from Jordi Mallach
	<jordi@sindominio.net>.

2003-07-03  Richard Hult  <richard@imendio.com>

	* ui/chat.glade: Remove send button from single line entry box.
	* ui/group-chat.glade: Likewise.

	* src/gossip-chat.c: (chat_create), (chat_input_activate_cb), 
	(chat_input_key_press_event_cb)
	* src/gossip-group-chat.c: (group_chat_key_press_event_cb), 
	(gossip_group_chat_new): Remove send button when in single line
	mode. Ctrl-Enter sends message for multiple line mode.

2003-07-01  Richard Hult  <richard@imendio.com>

	* src/gossip-contact-info.c (contact_info_vcard_reply_cb): Don't
	try to set NULL text in the text buffer.

	* src/gossip-roster.c (roster_menu_rename_cb): Fix comment. 
	(roster_menu_info_cb): Remove debug output.

	* src/gossip-contact-info.c (contact_info_dialog_destroy_cb)
	(gossip_contact_info_new): Free data when the dialog is destroyed.
	Make debugging output optional.
	(contact_info_dialog_close_cb): Hide the dialog (we should destroy
	it when there's a way to cancel a pending reply).

2003-06-30  Richard Hult  <richard@imendio.com>

	* ui/chat.glade: 
	* ui/group-chat.glade: Set vscroll policy of the text view to
	always. Fixes a weird scrolling problem and some jerkyness when
	the scrollbar appears.

2003-06-29  Jordi Mallach  <jordi@sindominio.net>

	* gossip.desktop.in: Add translation markers and StartupNotify entry.

2003-06-28  Richard Hult  <richard@imendio.com>

	* gossip.spec.in: 
	* Makefile.am: 
	* gossip.desktop.in: 
	* configure.in: Prepare for a release some time in the future.

	* src/gossip-main.c (main): Add option for which account to
	connect to, fixes bug #495. Also change the short option for no
	autoconnect to -n.

	* src/Makefile.am: Make it pass distcheck..

	* Makefile.am: Dist intltool. Patch from Ross Burton
	<ross@burtonini.com> to fix #590.

	* src/gossip-app.c (app_iq_handler): Don't hard code OS. Fixes
	#469.

	* src/gossip-chat.c (chat_dialog_send): Detect /clear.
	* src/gossip-group-chat.c (group_chat_send): Add some case
	insensitivy-foo for /nick detection. Also detect /clear. Fixes
	#359.

2003-06-23  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-add-contact.c: (add_contact_prepare_page_3):
	- Removed markup from translatable string and added question mark.
	  Reported by Christian Rose.

	* src/gossip-contact-info.c: (gossip_contact_info_new): 
	- Removed markup from translatable string. Reported by Christian Rose.

2003-06-18  Jordi Mallach  <jordi@sindominio.net>

	* configure.in (ALL_LINGUAS): Added "ca" (Catalan).

2003-06-18  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-account.c:
	(gossip_account_get_default):
	(gossip_account_store): if there are no default account set, 
	  set the one currently storing as default.
	* src/gossip-app.c: (app_init)
	- show the druid if you don't have a default account set.
	(app_tray_icon_button_press_cb): Store and restore position.
	* src/gossip-startup-druid.c:
	* src/gossip-startup-druid.h:
	(startup_druid_destroyed),
	(gossip_startup_druid_run): Rename gossip_startup_druid_new to _run 
	  and make it run the application and save the account when user 
	  entered all information.

2003-06-15  Richard Hult  <richard@imendio.com>

	Fix #345:
	
	* src/gossip-roster.c (roster_str_equal, roster_str_hash): Case
	insensitive versions for the JID hash.

	* src/gossip-roster.c (roster_create_store): Use them here.

2003-06-15  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-account.c:
	* src/gossip-account.h:
	(gossip_account_store): Moved from gossip-accounts-dialog.
	* src/gossip-accounts-dialog.c: 
	(accounts_dialog_add_account_cb),
	(accounts_dialog_update_account_cb): 
	- updated to the move of gossip_account_store.
	* src/gossip-startup-druid.c:
	(startup_druid_get_account_info),
	(startup_druid_prepare_page_last),
	(startup_druid_last_page_finished): store the created account.

2003-06-14  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-add-contact.c: (add_contact_page_2_vcard_handler):
	- fixed bug introduced when make loudmouth case-sensitive.

2003-06-13  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-add-contact.c:
	(add_contact_prepare_page_2): Don't use hardcoded strings
	* src/gossip-app.c: 
	* src/gossip-app.h:
	(gossip_app_connect),
	(gossip_app_connect_default), 
	(gossip_app_create),
	(app_set_status),
	(gossip_app_get_roster): Use a static GossipApp, only one anyway.
	* src/gossip-chat.c: 
	(chat_create), (chat_message_handler): updated to change in gossip-app.
	* src/gossip-connect-dialog.c: 
	(connect_dialog_response_cb): updated to change in gossip-app.
	* src/gossip-main.c: (main): same
	* src/gossip-message.c: (message_new): same
	* src/gossip-roster.c: 
	* src/gossip-roster.h:
	(roster_free_string_list): added
	(roster_finalize), 
	(roster_create_store),
	(roster_presence_handler), 
	(roster_update_user): fixed internal list of groups.
	(gossip_roster_get_groups): added

2003-06-13  Mikael Hallendal  <micke@imendio.com>

	* src/gossip-jid.c: (gossip_jid_get_resource): 
	- return NULL if resource not set, fix annoying bug in group chats.

2003-06-13  Mikael Hallendal  <micke@imendio.com>

        * *: Updated mine and Richards contact information
	
2003-04-26  Mikael Hallendal  <micke@codefactory.se>

        * Updated for latest loudmouth.
	
2003-04-15  Richard Hult  <rhult@codefactory.se>

	* src/gossip-chat.c: (chat_message_handler): Remove debug output.

2003-04-15  Richard Hult  <rhult@codefactory.se>

	* src/gossip-app.c (app_tray_icon_destroy_cb): Show the main window
	* when the tray icon is destroyed.

	* src/gossip-app.c (app_tray_icon_button_press_cb): Fix coding style
	and don't use g_object_get_property, fixes a GValue leak.

2003-04-14  Mikael Hallendal  <micke@codefactory.se>

        * src/gossip-app.c: Fixes #626
	(app_get_chat_for_jid): ref the jid
	(app_chat_dialog_destroy_cb): unref the jid
	
2003-04-11  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c: (app_message_handler): Use 
	  LM_MESSAGE_SUB_TYPE_AVAILABLE instead of LM_MESSAGE_SUB_TYPE_NOT_SET.

2003-04-09  Ross Burton  <ross@burtonini.com>
       
        * src/gossip-app.c: Connect to click events on the tray icon and
          show/hide the main window.

2003-04-09  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-contact-info.c:
	(contact_info_request_information): 
	- use resource when requesting version.
	(gossip_contact_info_new): use GossipJID
	* src/gossip-roster.c:
	(roster_presence_handler): Update JID
	(roster_item_update): unref correct jid.

2003-04-09  Mikael Hallendal  <micke@codefactory.se>

	* src/Makefile.am: added gossip-contact-info.[ch]
	
	* src/gossip-roster.c: (roster_menu_remove_cb),
	(roster_menu_info_cb), (roster_menu_rename_cb),
	(roster_get_selected_item), (roster_presence_handler),
	(roster_update_user), (roster_item_new): 
	- worked on the contact info
	* src/gossip-utils.h:
	* ui/main.glade:

2003-04-09  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c: (app_get_group_chat): 
	- use without resource here, I think that is what we want...
	
	* src/gossip-group-chat.c:
	(group_chat_presence_handler): reference the jid we put in the model.

2003-04-08  Mikael Hallendal  <micke@codefactory.se>

	* src/Makefile.am:
	* src/gossip-account.c: (gossip_account_get_jid):
	* src/gossip-account.h:
	* src/gossip-add-contact.c: (add_contact_prepare_page_1),
	(add_contact_prepare_page_2), (add_contact_1_id_entry_changed),
	(gossip_add_contact_new):
	* src/gossip-add-contact.h:
	* src/gossip-app.c: (app_init),
	(app_subscription_request_dialog_response_cb),
	(app_handle_subscription_request), (app_chat_dialog_destroy_cb),
	(app_get_chat_for_jid), (app_group_chat_destroy_cb),
	(app_get_group_chat), (app_message_handler),
	(app_connection_open_cb), (app_user_activated_cb):
	* src/gossip-app.h:
	* src/gossip-chat.c: (chat_create), (chat_dialog_destroy_cb),
	(chat_dialog_send), (chat_dialog_send_single_clicked_cb),
	(chat_dialog_send_multi_clicked_cb), (chat_message_handler),
	(chat_presence_handler), (gossip_chat_new),
	(gossip_chat_new_from_group_chat):
	* src/gossip-chat.h:
	* src/gossip-group-chat.c: (group_chat_send),
	(group_chat_activate_cb), (group_chat_row_activated_cb),
	(group_chat_destroy_cb), (group_chat_setup_tree),
	(group_chat_find_user_foreach), (group_chat_find_user),
	(group_chat_message_handler), (group_chat_presence_handler),
	(group_chat_topic_entry_activate_cb), (group_chat_priv_chat_new),
	(group_chat_priv_chat_incoming), (gossip_group_chat_new):
	* src/gossip-group-chat.h:
	* src/gossip-jid.c: (jid_free), (gossip_jid_new),
	(gossip_jid_get_full), (gossip_jid_get_without_resource),
	(gossip_jid_get_resource), (gossip_jid_get_part_name),
	(gossip_jid_ref), (gossip_jid_unref), (gossip_jid_equals),
	(gossip_jid_equals_without_resource),
	(gossip_jid_string_is_valid_jid):
	* src/gossip-jid.h:
	* src/gossip-message.c: (message_dialog_destroy_cb),
	(message_send_dialog_response_cb),
	(gossip_message_send_dialog_new),
	(message_recv_dialog_response_cb), (message_new):
	* src/gossip-message.h:
	* src/gossip-roster.c: (roster_menu_remove_cb),
	(roster_find_user_foreach), (roster_create_store),
	(roster_presence_handler), (roster_iq_handler),
	(roster_update_user), (roster_item_new), (roster_item_update),
	(roster_item_free), (gossip_roster_get_nick_from_jid),
	(gossip_roster_get_status_pixbuf_for_jid),
	(gossip_roster_have_jid):
	* src/gossip-roster.h:
	* src/gossip-utils.c:
	* src/gossip-utils.h: 
	- Added GossipJID and use it everywhere :)

2003-04-05  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-roster.c:
	(roster_presence_handler): 
	- remove old group from hash table, not just the tree model.

2003-03-29  Richard Hult  <rhult@codefactory.se>

	* src/gossip-sound.c (gossip_sound_play): Disable sounds for
	online/offline for now. We need preferences for this later.

2003-03-26  Richard Hult  <rhult@codefactory.se>

	* src/gossip-roster.c (roster_menu_remove_cb): Implemented.

2003-03-26  Richard Hult  <rhult@localhost.localdomain>

	* src/gossip-utils.c:
	(gossip_text_view_append_chat_message):
	(gossip_text_view_append_normal_message): Turn off scrolling
	protection (tm).

2003-04-03  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c: 
	(app_connection_open_cb): 
	- Removed some old cruft with gotos and horror.
	(app_client_disconnected_cb): 
	- Don't show dialog if the disconnect was done by the user.
	(app_disconnect): 
	- Don't emit CONNECTED-signal, *doh*
	- Only disconnect if we are actually connected.
	(app_block_until_connected_timeout), 
	(app_block_until_connected): Removed, unused and 
	  lm_connection_open_and_block should be used instead
	* src/gossip-roster.c:
	(roster_init): Don't create the hashes here.
	(roster_create_store):
	- Do it here instead, and destroy them if they exists. 

2003-04-02  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-startup-druid.c:
	- Work to get it working. Now collects almost all information.
	- Still needs to actually register and store account information.

	* ui/main.glade: Work on the startup druid.

2003-04-01  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-roster.c (roster_presence_handler):
	- notify that the tree changed. Patch by Dirk Dierckx.

2003-03-25  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c:
	- Removed block_until_disconnect stuff
	- Use app_disconnect instead of lm_connection_close
	directly. It also signals "disconnected" signal on app. 
	(app_client_disconnected_cb): removed the ifdef around this
	function and instead use it.
	(app_disconnect): added

2003-03-14  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c (app_create_connection): 
	- updated for API change in Loudmouth

	* src/gossip-roster.c: use gossip_marshal_*

	* src/Makefile.am: generate marshals

	* src/gossip-app.c (app_class_init): use gossip_marshal_*

	* src/gossip-marshal-main.c: added

	* src/gossip-marshal.list: added

2003-03-13  Mikael Hallendal  <micke@codefactory.se>

	* configure.in: updated loudmouth deps. to make sure we have a
	  late enough.

2003-03-09  Richard Hult  <rhult@codefactory.se>

	* src/gossip-add-contact.c (add_contact_prepare_page_2): Use
	gossip_jid_get_name.

	* src/gossip-app.c (app_get_group_chat): Remove gpointer hack.
	(app_get_chat_for_user): Likewise.

	* src/gossip-chat.c (chat_message_handler): Put nick matching here
	instead of in gossip_text_view_append_chat_message.

	* src/gossip-group-chat.c (gossip_group_chat_new): Change to take
	room, server and nick arguments.
	(group_chat_presence_handler): Use gossip_jid_ functions.
	(group_chat_message_handler): Likewise.
	(group_chat_set_title): Don't mark Gossip for translation.
	(group_chat_destroy_cb): Free a bit more stuff. Use gossip_jid_
	functions.
	(group_chat_send): Add support for /nick, mostly for making
	testing easier. Dunno if we want to keep it.

	* src/gossip-app.c (gossip_app_join_group_chat): Change to take
	room, server and nick arguments.
	* src/gossip-join-dialog.c (join_dialog_response_cb): Update for
	the above change.

	* src/gossip-utils.c (gossip_jid_get_name): Rename from
	gossip_username_from_jid.
	(gossip_jid_get_server): Implement.
	(gossip_jid_create): Implement.
	(gossip_text_view_append_chat_message): Don't pass roster, handle
	that from the outside. Fix the to/from matching so that nick
	highlighting works for both chat and group chat, and when nick !=
	username. Try to fix the scroll problem.
	(gossip_text_view_append_normal_message): Try to fix the scroll
	problem.
	Remove old unused include.

2003-02-26  Richard Hult  <rhult@codefactory.se>

	* ui/main.glade: Remove file menu and put quit in actions.

	* src/gossip-roster.c (roster_connected_cb): Don't play roster
	sounds within the first 5 seconds, instead of 2.

2003-02-25  Richard Hult  <rhult@codefactory.se>

	* src/gossip-utils.c (gossip_text_view_append_chat_message): Don't
	scroll down if we're not at the bottom before the message is
	inserted.
	(gossip_text_view_append_normal_message): Likewise.
	(gossip_text_view_setup_tags): Don't use bold for nicks.
	Add a few variants of smileys.
	(utils_insert_with_emoticons): Strip out the total length of the
	smiley characters when we get a match.
	(gossip_text_view_append_chat_message): Use <nick> style instead
	of nick:.

2003-02-11  Mikael Hallendal  <micke@codefactory.se>

	* src/*.c: Use the new GError API in loudmouth.
	
2003-02-04  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c (app_create_connection): moved code  here so
	  that we connect if we make a new connection after the inital
	  one.

2003-02-03  Richard Hult  <rhult@codefactory.se>

	* src/gossip-utils.c (utils_insert_with_emoticons): Loop so we can
	have more than one smiley in a string.
	
2003-02-03  Richard Hult  <rhult@codefactory.se>

	* src/gossip-utils.c (utils_insert_with_emoticons): Rewrite from
	scratch to work properly with utf-8 and to make it stop mangling
	word and numbers. Also add a cool smiley and make adding smileys a
	lot easier.

2003-02-02  Richard Hult  <rhult@codefactory.se>

	* src/gossip-utils.c (utils_insert_with_emoticons): Don't insert a
	smile if it would end up inside a word.

	* src/gossip-roster.c: Remove extern GossipApp.
	(roster_item_factory_trans, roster_init): Setup right-click menu.
	(roster_button_press_event_cb): Handle right-click and bring up
	context menu. 
	(roster_menu_remove_cb): Add stub, needs implementing.

	* ui/main.glade: Add startup druid. Needs more work.

	* src/gossip-startup-druid.c: Add, needs more work.

	* src/gossip-app.c (app_about_cb): Don't mark copyright for
	translation and update year.
	(app_init): Test the startup druid (GOSSIP_DRUID=1 gossip).

2003-02-02  Mikael Hallendal  <micke@codefactory.se>

	* src/*.c: Updated for sending "to" argument with lm_message_new*.
	
	* src/*.c: LmConnection is no longer an object.
	
2003-02-02  Richard Hult  <rhult@codefactory.se>

	* src/gossip-chat.c (chat_message_handler): Fix sounds on gtk 2.0.

2003-02-02  Mikael hallendal  <micke@codefactory.se>

	* src/gossip-app.c: Updated to latest changes in loudmouth.
	
2003-02-01  Richard Hult  <rhult@codefactory.se>

	* src/gossip-app.c (app_set_status): Set silent mode for busy,
	away, extended away, offline.

	* src/gossip-sound.c (gossip_sound_set_silent): Add.

2003-01-30  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-add-contact.c:
	(add_contact_prepare_page_2): send a vcard request.
	(add_contact_page_2_vcard_handler): set the values if they are
	  included in the vcard. requested in prepare_page_2.

	* src/gossip-chat.c (chat_message_handler): print if we have a
	  thread, would be nice to know if clients actually set the thread 
	  field in there clients.

	* src/gossip-add-contact.c:
	(add_contact_prepare_page_3):
	- added, set the label to no hardcode micke. Fixes #492
	(add_contact_last_page_finished): 
	- added, called when you click finish.
	- Sends the request/roster update and closes the dialog.
	- Fixes #479

2003-01-29  Richard Hult  <rhult@codefactory.se>

	* src/gossip-chat.c (chat_message_handler): Don't play sound if
	we're focused.

2003-01-29  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c (app_init): only set data on connection if we
	  have an account. Fixes crash reported by marcus.

	* src/gossip-add-contact.c:
	(add_contact_complete_group_idle): fix warning reported by marcus.
	(add_contact_prepare_page_last): 
	- don't set group child if group is not set.

	* src/gossip-roster.c (roster_iq_handler): 
	- Don't just check if group node exists, also check that the value
	  exists. Fixes #494

	* src/gossip-accounts-dialog.c:
	(accounts_dialog_set_account_information): 
	- store passwd in private.

	* src/gossip-account.c:
	(account_get_value): use get_string_with_default to always get
	  something (never NULL).  
	(gossip_account_get): read password from private

2003-01-29  Richard Hult  <rhult@codefactory.se>

	* src/Makefile.am:
	* configure.in: Build the sounds directory.

	* src/sounds: Add sounds from PSI.

	* src/gossip-chat.c (chat_message_handler): Play sound.

	* src/gossip-roster.c (roster_presence_handler): Play sound.
	(roster_disconnected_cb): Disable sounds.
	(roster_connected_cb): Run 2 second timeout to enable sounds.
	(roster_enable_sound_cb): Enable sounds here.
	(roster_finalize): Remove the timeout if it's running when we
	finalize.

2003-01-29  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c (app_message_handler): don't assert on messages
	  with sub type "error"

	* src/gossip-roster.c (roster_iq_handler): 
	- add user in group Others if no group is set on them.

	* src/*.c:
	- Updated to use the new LmMessageSubType in loudmouth 0.2

	* src/gossip-roster.c:
	- Fixes #481
	- Fixes #468
	- Store GossipRosterItem's in an hashtable for quick access.
	- Use set_data_func to set information in the roster
	- Lots of changes that had to do with this...

	* src/gossip-app.c:
	- Fixes #478
	(app_subscription_request_dialog_response_cb): 
	- Check to see if the jid already is in the roster and if it is
	  not popup the add user dialog.
	(app_handle_subscription_request):
	- Set add to contact list check button insensitive and uncheck it
	  if user already in your contact list.

	* configure.in:
	- require loudmouth 0.2
	- updated to 0.2 (for fun, so that we can point fingers at Marcus
	  for only running 0.1 :)
	

2003-01-28  Richard Hult  <rhult@codefactory.se>

	* src/gossip-app.c: Remove duplicate includes.
	(gossip_app_init): Remove unused gconf favorites code.

	* ui/group-chat.glade: Add disclosure widget here too.

	* src/gossip-group-chat.c: Handle single/multi line input.

	* src/gossip-chat.c: Rework to use a window instead of dialog and
	also add a disclosure widget so we can switch between single and
	multiline entry.

	* src/Makefile.am: Add -export-dynamic to get custom widgets
	working with libglade.

	* src/gossip-group-chat.c (group_chat_message_handler): Remove
	debug output.
	(group_chat_priv_chat_new): Likewise.

	* ui/group-chat.glade: Add group chat editing dialog.

	* src/gossip-join-dialog.c: Update to use the new config UI and
	data for group chat favorites.

	* src/gossip-favorites-dialog.[ch}: New, dialog for configuring
	the group chat favorites.

	* src/gossip-favorite.[ch]: New, handle group chat favorites
	config data.

	* ui/connect.glade: Move the edit button, next to the option menu.

	* src/gossip-connect-dialog.c: Connect to the edit button instead
	of handling it in the response callback.

2003-01-27  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-accounts-dialog.c: 
	- Fixes #364
	- Added support for ports entry.
	(accounts_dialog_passwd_entry_insert_text_cb): 
	- added to check the input in the port entry.
	(accounts_dialog_update_account_cb): set port if port entry
	  changed.

	* src/gossip-account.c:
	(gossip_account_get): read port from config.

	* ui/connect.glade: added port entry to accounts-dialog.

	* src/gossip-utils.c (gossip_text_view_append_chat_message):
	- removed rhult-warning.
	
	* src/gossip-chat.c (chat_presence_handler): 
	- show is a child, not an attribute. Fixes #476

	* src/gossip-app.c (app_set_status): 
	- Fixes #454
	- send status to all group chats user is currently in.
	(app_set_status_group_chat_foreach): added.

	* src/gossip-group-chat.c:
	- Fixes #449
	(group_chat_priv_chat_new): added
	(group_chat_priv_chat_incoming): added
	(group_chat_priv_chat_destroyed): added
	(group_chat_row_activated_cb): call priv_chat_new ...
	(group_chat_message_handler): 
	- return if message isn't groupchat or chat.
	- handle chat messages (private messages to a person in the group
	  chat).

	* src/gossip-chat.c:
	(chat_create): added. code from gossip_chat_new.
	(gossip_chat_new): Code moved to chat_create.
	(gossip_chat_new_from_group_chat): added, used when you are
	  creating a private chat from a group chat. This one doesn't
	  cause the chat to listen to messages but instead requires
	  messages being added with the append_message call.
	(chat_message_handler): added support to have a nick set instead
	  of using the jid. (Needed in priv chatting in group chats).

	* src/gossip-message.c:
	(message_send_dialog_response_cb): 
	- don't free the string before using it!
	(message_recv_dialog_response_cb):
	- the body of a message is a subnode, not an attribute.

	* src/gossip-utils.c (gossip_text_view_append_chat_message): 
	- Set the name to be nick from roster if it's available and roster
	  is passed to the function. 

	* src/gossip-message.c (message_new): 
	- sets the from labe to "Nick <jid>". Fixes #224
	- moved set_margin to after gtk_widget_show 

	* src/gossip-chat.c:
	(chat_message_handler): send the roster to
	  gossip_text_view_append_chat_message.
	(gossip_chat_new): Sets the from to "Nick <jid>". Fixes #224

	* src/gossip-group-chat.c:
	- Use a list store for users in a group chat.
        (group_chat_setup_tree): 
	- Set default sort function and set sort column to default sort
	  column. Fixes #387
        (group_chat_iter_compare_func): added.
	(gossip_group_chat_new): moved gossip_text_view_set_margin call to
	  after gtk_widget_show.

	* src/gossip-chat.c:
	(gossip_chat_new): changed order in which things were done on the
	  window. It tried to set background before the window was
	  realized.
	(chat_message_handler): return
	  LM_HANDLER_RESULT_REMOVE_MESSAGE if it's handled by this
	  handler. Fixes #473.

	* src/*:
	- Updated for major changes in loudmouth.
	- Roster handling entirely in gossip-roster now
	- Added connected and disconnected signals on GossipApp used by
	  the roster. 

2003-01-25  Mikael Hallendal  <micke@codefactory.se>

	* src/*.c: Updated to changes in loudmouth.

	* src/gossip-add-contact.c: sends some stuff to actually start
	  subscribing ...

2003-01-24  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-add-contact.c:
	(add_contact_complete_group_idle): added, couldn't get the
	  selection-thingy working without doing it in an idle.

	* src/gossip-utils.c (gossip_utils_is_valid_jid): added

	* src/app.c: Use the new Add user dialog (not finished)

	* src/gossip-add-contact.[ch]: Added

	* src/Makefile.am (gossip_SOURCES): added gossip-add-contact.[ch]

2003-01-23  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c:
	(app_subscription_request_dialog_response_cb): 
	- handle defer and delete event.
	
	* src/*.c:
	- Use gossip_glade_get_file_simple where appropriate
	- Pass parent widget to all glade_get_file* calls
	- Unref glade object where gossip_glade_get_file is used.

	* data/*: Images moved to ui/pixmaps

	* ui/pixmaps/*: Install in $datadir/gossip

        * src/*: UI work.
	
	* ui/*: Merged UI files
	* ui/connect-dialog.glade: tweaked a bit
	* src/gossip-account.c:
	* src/gossip-accounts-dialog.c:
	* src/gossip-connect-dialog.c:
	- Use gnome-config instead of GConf for storing account
	  information.
	
2002-12-13  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-connect-dialog.c: 
	- Start using GossipAccount
	- Update the entries when they get updated in the account editing
	  dialog
	- Moved in stuff from gossip-accounts-dialog which was only used
	  here after the move to the new accounts dialog.

	* src/gossip-app.c: Use GossipAccount

	* src/gossip-accounts-dialog.c: 
	- Use a list view to the left and edit the entries to the right
	  instead of the old style way. Much more intiutive. 
	- Start using the GossipAccount struct all over. 

	* src/gossip-account.[ch]: Added

	* src/gossip-account-utils.[ch]: Removed, most of the stuff moved
	  into gossip-connect-dialog.c since it wasn't used in the new
	  account editor dialog.

2002-12-11  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-message.c (message_new): don't use g_object_ref on a
	  LmElement. Should fix a crash.

2002-12-10  Mikael Hallendal <micke@codefactory.se>

	* Fixed #345, use timestamp when showing messages if
	  jabber:x:delay is included in the message.
	
2002-12-04  Richard Hult  <rhult@codefactory.se>

	* src/gossip-roster.c (gossip_roster_init): Set cell ypadding to 1
	to get the roster list to be slightly more compact.

2002-12-03  Richard Hult  <rhult@codefactory.se>

	* src/gossip-roster.c: Apply modified patch from Anders Carlsson
	to not show the empty pixbufs for groups.

2002-12-01  Anders Carlsson  <andersca@codefactory.se>

	* src/gossip-app.c: Fix build.
	
2002-12-01  Richard Hult  <rhult@codefactory.se>

	* src/gossip-utils.c (gossip_status_menu_setup)
	(gossip_status_menu_set_status, gossip_status_menu_get_status):
	Rename from gossip_image_....
	(gossip_status_menu_setup): Revert part of the change and add a
	more elaborate comment on why the hack is needed.

	* src/gossip-app.c (app_tray_icon_set_status)
	(app_create_tray_icon, app_tray_icon_destroy_cb): Refactor a bit
	and recreate the tray icon when it's destroyed.

	* src/Makefile.am (gossip_SOURCES): Add eggtrayicon.

	* src/gossip-app.c (app_set_status_indicator): Update tray icon.
	(gossip_app_init): Create tray icon.

2002-11-30  Richard Hult  <rhult@codefactory.se>

	* src/gossip-chat.c (chat_presence_handler): Don't do anything
	with presence messages from any other than the person we're
	chatting with (the fix is only a workaround, we need to handle
	chatting with different resources I think).

	* src/gossip-roster.c (roster_find_user_foreach): Fix leak.
	(roster_find_group_foreach): Fix leak.

2002-11-29  Richard Hult  <rhult@codefactory.se>

	* src/gossip-roster.c: Make the group names translatable.

	* src/gossip-main.c (main): Setup gconf things here.

	* src/gossip-app.c (gossip_app_init): Add a separator above the
	offline item.
	(gossip_app_init): Setup server/username/password/resource from
	the default account.

	* src/gossip-utils.c (gossip_image_option_menu_setup): Add support
	for separator menu items.

	* src/gossip-app.c (app_set_status_indicator): New function to
	update the option menu and set the window icon, without changing
	the status itself. Also block so we don't get signal recursion.
	(gossip_app_init): Use utility function to get status icon
	filenames.
	(app_block_until_disconnected): New function that let's us block
	using a main loop until we get disconnected. This is needed for
	when we reconnect.
	(app_block_until_connected): Like above but for connecting, not
	sure if it's needed yet.
	(gossip_app_new): Don't handle connecting here.
	(gossip_app_connect): Add precondition checks on server, username,
	resource. Only do connecting, nothing else.
	(app_client_disconnected): Handle the block-until-disconnected
	flag here. Reset the roster and status option menu directly on
	disconnect.
	
	* src/gossip-roster.c (roster_presence_handler): Use utility
	function to get the status icon filenames.

2002-11-29  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c (app_subscription_request_dialog_response_cb): 
	- don't use g_object_(set|get|ref|unref) on LmElements.

2002-11-29  Mikael Hallendal <micke@codefactory.se>

	* src/gossip-app.c: Updated for new API in loudmouth.
	
2002-11-28  Richard Hult  <rhult@codefactory.se>

	* src/gossip-main.c: Set a default icon.

	* src/gossip-app.c (app_set_status): Set the window icon too.

2002-11-27  Richard Hult  <rhult@codefactory.se>

	* src/gossip-app.c (app_client_connected): Make sure we always
	have a resource.

	* po/sv.po: Update.

	* src/*.c: Mark more strings for translation.
	
	* src/gossip-app.c (app_client_disconnected): Bring up a dialog
	and ask if the user wants to reconnect.

	* ui/chat-dialog.glade: 
	* ui/group-chat-window.glade: Wrap lines at words instead of chars.

2002-11-26  Mikael Hallendal <micke@codefactory.se>

	* src/*.c: Updated to the new loudmouth (where LmElements are no
	  longer objects).

2002-11-26  Richard Hult  <rhult@codefactory.se>

	* src/gossip-group-chat.c (group_chat_topic_entry_activate_cb):
	Remove extra newline from the topic string.
	(group_chat_set_title): Set the name of the group chat room in the title.

	* src/gossip-roster.c (gossip_roster_get_status_pixbuf_for_jid):
	Impl.

	* src/gossip-chat.c (gossip_chat_new): Get the status pixbuf from
	the roster.

2002-11-25  Richard Hult  <rhult@codefactory.se>

	* src/gossip-accounts-dialog.c
	(accounts_dialog_remove_account_cb): Remove duplicate unset on
	server key.
	(accounts_dialog_update_account_cb): Add, update changes.
	(accounts_dialog_set_account_information): Refactor out from
	add_account and use for updating as well.
	(accounts_dialog_entries_changed_cb): Update the sensitivity of
	the update button too.

	* src/gossip-app.c (app_get_default_account): Don't use NULL as
	resource, send "" in that case.
	(app_client_connected): Don't use the resource if it's empty.

	* src/gossip-utils.c (gossip_text_view_append_chat_message):
	Remove the g_error on NULL msgs, it's annoying and I couldn't
	figure out where the NULL msg came from...

2002-11-25  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c (app_subscription_request_dialog_response_cb): 
	- reply to the requester
	(app_default_subscription_request_handler): 
	- don't show dialog if request is unsubscribe
	- set from-name in bold.
	- send app as user_data and set presence as data on dialog.
	
2002-11-24  Richard Hult  <rhult@codefactory.se>

	* src/gossip-app.c (app_subscription_request_dialog_response_cb)
	(app_default_subscription_request_handler): First cut at
	subscription request handler.

	* po/sv.po: Translate to Swedish.

	* src/gossip-chat.c: Implement presence handler and clean up code.

	* src/gossip-app.c: Change loudmouth callbacks to not use *.

2002-11-23  Richard Hult  <rhult@codefactory.se>

	* configure.in: Enable compile warnings.

	* src/*.c: Fix lots of warnings.

	* src/gossip-utils.c (url_regex_match): Advance to the position
	after the match. Fixes a few weird url detection bugs.

	* src/gossip-connect-dialog.c: Remove unused account entry stuff.

	* src/gossip-group-chat.c (group_chat_topic_entry_activate_cb):
	Grab focus on the input entry.

2002-11-23  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-group-chat.c:
	(group_chat_topic_entry_activate_cb): added, sets topic when user
	  changes it.
	(group_chat_message_handler): set topic

2002-11-23  Richard Hult  <rhult@codefactory.se>

	* src/gossip-group-chat.c (group_chat_row_activated_cb): Add
	comment about gossip_app_show_chat. Needs to be fixed to use that.

	* src/gossip-app.c (gossip_app_show_chat): Add, shows a chat
	window for a particular user.

2002-11-23  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c (app_get_default_account): get resource too

2002-11-23  Richard Hult  <rhult@codefactory.se>

	* src/gossip-app.c: (app_subscription_request_response_cb)
	(app_add_contact_dialog_response_cb, app_add_contact_cb): Add very
	simple subscription add dialog, needs reworking.

	* src/Makefile.am:
	* src/gossip-app.c:
	* src/gossip-account-utils.[ch]: 
	* src/gossip-accounts-dialog.[ch]: 
	* src/gossip-connect-dialog.[ch]: 
	* ui/connect-dialog.glade:
	* ui/accounts-dialog.glade: Break out accounts editing into its
	own dialog and clean up a lot. Removing and adding accounts should
	work properly now. Also add "resource" to the account editing so
	the user can set the resource.

2002-11-22  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c:
	(app_default_iq_handler): added, handle version

	* src/*: Use the new API in loudmouth.

	* Makefile.am (SUBDIRS): changed order on data and src.

2002-11-22  Richard Hult  <rhult@codefactory.se>

	* data/images/Makefile.am (inline-emoticons.h): Emoticons.

	* src/gossip-utils.c: Add emoticon support stolen from
	gnomemeeting.

2002-11-22  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c: 
	- changes default handlers to use the new API.
	- Set name, version and os on LmClient, will later be used to
	  answer VERSION requests.

2002-11-21  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-group-chat.c: 
	* src/gossip-chat.c: 
	* src/gossip-app.c: GossipApp now inherits LmClient
	- removed gossip_app_get_client
	- Don't call lm_client_add_default_*

2002-11-21  Richard Hult  <rhult@codefactory.se>

	* src/gossip-roster.c (roster_presence_handler): Missed one icon.

	* src/gossip-group-chat.c (group_chat_presence_handler): Change
	icons here too.

	* data/images/gossip-*.png:
	* src/gossip-roster.c (gossip_roster_add_user): 
	* src/gossip-app.c (gossip_app_init): Try a new set of icons.
	(gossip_app_init): Put busy before away·

	* src/gossip-utils.c (gossip_text_view_setup_tags): Tweak colors
	again.

2002-11-20  Richard Hult  <rhult@codefactory.se>

	* src/gossip-utils.c (utils_text_view_event_cb): Use a hand mouse
	cursor over links.

2002-11-19  Richard Hult  <rhult@codefactory.se>

	* src/gossip-chat.c: 
	* src/gossip-group-chat.c: 
	* src/gossip-utils.c: Clean up by breaking out common code from the
	group chats and chat and put it here.
	(group_chat_row_activated_cb): Start to implement double-click in
	the group chat "roster" to start a one-to-one chat with someone,
	needs more work to get the jid from the conference jid.

	* src/gossip-chat.c (gossip_chat_new): Tweak colors.

	* src/gossip-group-chat.c (gossip_group_chat_new): Tweak colors.

	* src/gossip-group-chat.c:
	* src/gossip-utils.c: Add dingus clicking, aka url clicking
	feature.

	* src/gossip-group-chat.c (gossip_group_chat_new): Use sea green
	for highlighting.
	(group_chat_key_press_event_cb): Don't insert a space after the
	nick when completing inside sentence.
	
	* src/gossip-chat.c (gossip_chat_new): Use sea green for
	highlighting.

	* src/gossip-group-chat.c (group_chat_key_press_event_cb): Fix
	nick completion to complete just to the length that matches all
	nicks with the same prefix, and also support completing nicks
	inside sentences.

2002-11-16  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-roster.c:
	(roster_presence_handler): expand groups if they aren't and the
	  group is not the Offline group.
	* src/gossip-roster.c:
	(roster_iter_compare_func): added. sorts the roster (puts Offline
	  last and Others just before it). 
	(roster_create_store): set the default sort func and set the
	  default sort function to be used.

2002-11-16  Richard Hult  <rhult@codefactory.se>

	* configure.in: Add libgnomeui dependency.

	* src/gossip-app.c: Use GnomeApp for the UI. Add About box, add
	offline to status option menu, handle disconnect/connect through
	option menu somewhat.

2002-11-16  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-roster.c:
	(gossip_roster_add_user): Add all users to the Offline group
	(roster_presence_handler):
	- Create group if it doesn't exist
	- Remove group if it's empty
	- DO FUNKY STUFF!!!
	
	* src/gossip-app.c:
	(app_default_message_handler): renamed from message_received.
	(app_default_presence_handler): renamed from presence_received.
	(app_presence_received): don't handle presence to roster.
	(gossip_app_init): create the LmClient here instead of in _new

	* src/gossip-group-chat.c:
	(group_chat_destroy_cb): unregister  presence handler.
	(gossip_group_chat_new): register presence handler.
	(group_chat_presence_handler): renamed from handle_presence and
	  made into a static function.
	(group_chat_message_handler): renamed from handle_message.

	* src/gossip-app.c (app_presence_received): don't handle group
	  chat presence events

	* src/gossip-chat.c:
	(gossip_chat_handle_message): now a LmMessageHandler.
	(chat_dialog_destroy_cb): unregister message handler.
	(gossip_chat_new): register message handler.

2002-11-16  Richard Hult  <rhult@codefactory.se>

	* src/gossip-roster.c (gossip_roster_add_user): Expand the online
	groups when adding the first user to them (so we don't mess with
	groups the user has collapsed).

2002-11-16  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-group-chat.c (group_chat_destroy_cb): unregister
	  message handler and send a LmPresence about leaving.

	* src/gossip-app.c (app_message_received): don't take care of
	  group chat messages any more.

	* src/gossip-group-chat.c:
	(gossip_group_chat_new): register message handler
	(group_chat_handle_message): now a LmMessageHandler, returns FALSE
	  if this message didn't belong to this chat room.

2002-11-16  Richard Hult  <rhult@codefactory.se>

	* src/gossip-roster.c: More tweaking.

2002-11-15  Richard Hult  <rhult@codefactory.se>

	* src/gossip-roster.c (gossip_roster_add_user): Handle contacts
	with no group.
	(roster_row_activated_cb): Don't emit activated signal on groups.

	* src/gossip-utils.c (gossip_text_view_append_chat_message): Tweak
	the style of chat messages.

	* src/gossip-roster.c (gossip_roster_add_user): Start implementing
	group handling.

2002-11-15  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c: Use callbacks for message and presence.

	* src/gossip-app.c: Use callbacks for connected and disconnected
	  instead of signals.

2002-11-15  Richard Hult  <rhult@codefactory.se>

	* src/gossip-app.c (gossip_app_init): Use gnomeicu-dnd.png for
	Busy.

	* src/gossip-utils.c (gossip_option_menu_set_history): Add, match
	on the user_data set per menu item and select it if found.

	* src/gossip-app.c (app_set_status): Remove dead code. Use
	gossip_option_menu_set_history to make setting the status work
	properly.

2002-11-14  Mikael Hallendal  <micke@codefactory.se>

	* src/gossip-app.c (app_status_item_activated_cb): added.
	(app_set_status): set presence show/type corresponding to gossip
	  status.

	* configure.in: require loudmouth 0.1.1

	* src/gossip-roster.c:
	(gossip_roster_handle_presence): cleaned up a little.
	
	* src/gossip-group-chat.c (gossip_group_chat_handle_presence): 
	- use icons from gnomeicu.

	* src/gossip-roster.c (gossip_roster_handle_presence): 
	- Use different icons depending on type of show
	- Set user as offline when presence type == ERROR or UNAVAILABLE.
	(gossip_roster_list_received_cb): moved from gossip-app. Handles
	  incoming roster list.

	* src/gossip-app.h: match the GossipStatuses with LmPresenceShows

	* src/gossip-app.c (gossip_app_init): use icons from gnomeicu
	(app_set_status): also send the presence.
	(app_presence_received): don't let the roster handle the presence
	  if it's not of type AVAILABLE or UNAVAILABLE.

	* data/images/gnomeicu-*: Added from GnomeICU

	* data/images/Makefile.am (image_DATA): Added gnomeicu-*

	* src/gossip-app.c (app_auth_cb): added
	(app_client_connected): don't request roster and set status to
	  available until we have actually authenticated.

2002-10-28  Richard Hult  <rhult@codefactory.se>

	* src/gossip-app.c (app_presence_received): Don't do anything if
	we get a presence message with type == error.

2002-10-23  Richard Hult  <rhult@codefactory.se>

	* src/gossip-group-chat.c (group_chat_key_press_event_cb):
	Implement tab completion for nick.
	(group_chat_key_press_event_cb): Don't complete if control or
	shift is pressed.

	* src/gossip-chat.c (gossip_chat_new, chat_focus_in_event_cb):
	Don't give focus to the text view, only the input entry.

	* src/gossip-app.c (gossip_app_new): Only connect if the caller
	told us to.

	* src/gossip-main.c (main): Add -a option (don't connect on
	startup).

2002-10-21  Richard Hult  <rhult@codefactory.se>

	* src/gossip-group-chat.c (group_chat_focus_in_event_cb): Grab
	focus in entry when the text view gets focus, restore cursor
	position and deselect the text. A bit of a kludge but works ok.
	(gossip_group_chat_new): Set focus chain.

	* src/gossip-connect-dialog.c (connect_dialog_update_optionmenu):
	Refactor.
	(connect_dialog_add_account_cb): Update the option menu when
	server is added.

	* src/gossip-join-dialog.c (join_dialog_response_cb): Plug leak.
	(join_dialog_update_optionmenu): Refactor so we can use this when
	a new favorite is added.
	(join_dialog_add_favorite_cb): Update option menu when favorite is
	added.

	* src/gossip-app.c (app_get_default_account): Don't try to use the
	default account if it's an empty string.

2002-10-02  Richard Hult  <rhult@codefactory.se>

	* src/gossip-app.c (app_get_default_account): Handle the case
	where no accounts exist.
	(gossip_app_connect): Only disconnect if we're connected.
	(gossip_app_init): Work around the lack of a schema for now.
	(app_get_group_chat_for_room): Casefold so we get matches for
	CodeFactory etc even if the name is codefactory.
	(app_get_chat_for_user): Likewise. 

	Add g_return_if... in lots of places.

	* src/gossip-main.c (main): Run gtk_init before checking cmdline
	arguments since gtk_init might strip off some.

	* src/gossip-connect-dialog.c (connect_dialog_entries_changed_cb):
	Don't set add button insensitive when no password is entered.

